# エッジコンピューティング（Edge Computing）

概要  
エッジコンピューティングとは、データが生成される場所（装置・センサ・ユーザ）に近いところに計算資源と保存を配置し、クラウドへ送る前に処理・判断を行う分散計算の考え方である。材料科学では、計測・製造・解析の時間スケールを揃え、通信制約やデータ主権に対応しつつ、その場で意思決定するための基盤技術である。


## 参考ドキュメント
- AWS（日本語）エッジコンピューティングとは？
  https://aws.amazon.com/jp/what-is/edge-computing/
- ETSI Multi-access Edge Computing（MEC）
  https://www.etsi.org/technologies/multi-access-edge-computing
- NIST SP 800-191（Fog/Mistとクラウド・エッジの関係整理）
  https://csrc.nist.gov/pubs/sp/800/191/ipd


## 1. 用語の整理（クラウド、エッジ、フォグ、MEC）
- クラウド：データセンタ側で集中処理する形態である
- エッジ：センサや装置の近傍（端末、ゲートウェイ、ローカルサーバ）で処理する形態である
- フォグ：クラウドとエッジの間に階層的に分散する形態として語られることが多い
- MEC（Multi-access Edge Computing）：通信ネットワークのエッジ（基地局近傍など）に、クラウド相当の実行環境を置く標準化された枠組みである


## 2. 材料科学でエッジが効く理由
1) 低遅延（リアルタイム性）  
その場計測で「次の測定条件を変える」「異常を止める」などのフィードバックが必要な場合、クラウド往復の遅延がボトルネックになり得る。

2) 帯域とコスト  
顕微鏡動画、検出器画像、波形の生データは巨大であり、全量をクラウドへ送ると帯域・費用・保存の負担が増える。エッジで要約（特徴抽出）して送ると現実的になる。

3) データ主権・機密性  
未公開材料、共同研究データ、装置ログなどは外部送信を制限したいことがある。エッジ（研究室内・工場内）で処理を閉じる設計が有効である。

4) 可用性（ネットワーク断への耐性）  
放射光ビームタイムや工場ラインでは、ネットワーク断でも最低限の判断が必要である。エッジ側で動くモデルは運用上強い。


## 3. 典型アーキテクチャ
構成要素の例
- デバイス：検出器、カメラ、温度計、磁気センサ、PLCなど
- エッジノード：小型PC、GPU搭載ワークステーション、エッジボックス
- エッジゲートウェイ：プロトコル変換、バッファ、時刻同期
- ローカル基盤：NAS、オンプレGPUサーバ、マイクロデータセンタ
- クラウド/HPC：大規模学習、長期保存、共同解析、再現用パイプライン

比較（どこで何をやるか）
| 層 | 主目的 | 典型処理 | 材料系の例 |
|---|---|---|---|
| デバイス内（Tiny/On-device） | 最低限の判断 | 閾値判定、簡易特徴 | 異常検知の一次アラート |
| エッジノード | リアルタイム解析 | 前処理、推論、要約 | その場スペクトルのピーク抽出・相候補提示 |
| ローカル基盤 | 研究室内統合 | バッチ解析、キャッシュ | 1日分の計測を夜間に自動解析 |
| クラウド/HPC | 重い計算・共有 | 大規模学習、探索 | 逆設計、生成モデル、網羅DFTの学習 |


## 4. レイテンシの見積り（最小の式）
総遅延を分解すると
$$
L_{\mathrm{total}} \approx L_{\mathrm{sense}} + L_{\mathrm{edge}} + L_{\mathrm{net}} + L_{\mathrm{cloud}}
$$
エッジ化の狙いは、$L_{\mathrm{net}} + L_{\mathrm{cloud}}$ を削るか、クラウド処理を「後追い」に回すことにある。

帯域の観点では、エッジ要約率を $r \in (0,1]$（送るデータ量の比）とすると、送信量は概ね
$$
B_{\mathrm{tx}} \propto r \cdot B_{\mathrm{raw}}
$$
で減らせる。材料計測ではしばしば r を小さくできる（例：生画像→欠陥マップ、全波形→統計量）。


## 5. 材料科学のユースケース例
その場・オンライン意思決定
- その場XRD/XAFS/XMCDの逐次解析により、測定点の追加・スキャン幅変更・異常停止を支援する
- 高速カメラ／顕微鏡動画から、その場で粒界追跡・欠陥セグメンテーションを行い、撮像条件を適応的に変更する
- 磁気計測（波形、MBN、透磁率周波数応答）をその場で特徴抽出し、試料状態（応力、欠陥、熱履歴）を推定する

製造・プロセス（スマートファクトリー）
- ライン上のセンサ融合（振動・温度・電流・画像）で異常前兆を検知し、停止や条件変更を即時に判断する
- 品質検査の一次判定をエッジで行い、要精査のみを上位へ送る

データ駆動研究（実験×計算×データ）
- エッジで推論 → 結果を蓄積 → 夜間にクラウド/HPCで再学習、というループでアクティブラーニングを回す
- 複数実験拠点のデータを、プライバシ保護や機密を保ったまま学習する（連合学習など）の前段として用いる


## 6. エッジAI実装の要点
モデルの軽量化
- 量子化：重みや演算を低ビット化し、速度と省メモリを得る
- 蒸留：大モデル（クラウド）から小モデル（エッジ）へ知識を移す
- プルーニング：不要結合を削って推論を軽くする

データ整備
- 時刻同期：装置ログ、環境ログ、画像・波形のタイムスタンプ整合が再現性の肝である
- 物理単位・正規化：学習時と推論時の前処理差分を防ぐ（リーク防止）
- 分割：装置日・ロット・試料IDでの分割を優先し、過大評価を避ける

運用（MLOps）
- ローカルでログを残し、モデル更新で精度が変わったか追跡する
- ドリフト（環境変化、装置劣化、試料系の変化）を監視し、再学習のトリガを設ける


## 7. セキュリティとガバナンス
- データ主権：未公開データを外部へ出さない設計（ローカル閉域、匿名化、要約送信）
- 供給網：モデル・コンテナ・依存ライブラリの真正性（署名、SBOM、バージョン固定）
- 監査性：推論の入力・出力・モデル版を保存し、後から再現できる状態にしておく


## 8. 導入チェックリスト
- タスク：何をリアルタイムに決めたいか（停止、条件変更、分類、予測）を先に決める
- レイテンシ要求：許容遅延とサンプリング周期を決める（$\tau \sim \Delta t$ の発想が重要である）
- データ量：生データを送るのか、要約を送るのか（r を設計する）
- 配置：デバイス内／装置PC／研究室サーバ／クラウドの役割分担を表にする
- 保守：モデル更新の頻度、ログ保存、ドリフト検知を最初から決める


## まとめ
エッジコンピューティングは、装置やセンサ近傍で解析・推論を行い、低遅延・帯域削減・機密性を同時に満たす分散計算の枠組みである。材料科学では、その場計測やプロセス制御と特に相性が良く、エッジでの推論とクラウド/HPCでの大規模学習を役割分担する設計が実務上の基本となる。
