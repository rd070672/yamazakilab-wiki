# 第一原理計算に基づくフェーズフィールド計算

フェーズフィールド（PF）法は、界面を連続場（秩序変数）で表現し、自由エネルギー汎関数の減少則に従って組織形成を時間発展として解く枠組みである。第一原理計算で得られるエネルギー・弾性・拡散障壁などを用い、PFの自由エネルギーと速度論パラメータを系統的に与えることで、経験パラメータ依存を小さくする設計が可能になる。

## 参考ドキュメント
- I. Steinbach, Phase-field models in materials science, Modelling Simul. Mater. Sci. Eng. 17, 073001 (2009)
  https://www.itm.kit.edu/msmse9_7_073001_PF_review_2009.pdf
- S. Bhattacharyya et al., A first-principles phase field method for quantitatively accurate multiscale modeling of alloys, Nat. Commun. 10, 4830 (2019)
  https://www.nature.com/articles/s41467-019-11248-z
- （日本語）小山敏幸, フェーズフィールド法, 応用物理 94, 10– (2025)
  https://www.jstage.jst.go.jp/article/oubutsu/94/1/94_10/_article/-char/ja/
- （日本語）大野宗一, 凝固・結晶成長のためのフェーズフィールド法, まてりあ系解説 (2013)
  https://www.jstage.jst.go.jp/article/ijmsa/30/1/30_24/_pdf
- （日本語/英語）山中晃徳, Phase-field Modeling and Simulation of Solid-state Transformations, ISIJ Int. 63 (2023)
  https://www.jstage.jst.go.jp/article/isijinternational/63/3/63_ISIJINT-2022-343/_html/-char/en

## 1. 自由エネルギー汎関数と発展方程式
PFでは、秩序変数（相や規則度）$η$、保存量（濃度）$c$ などの場を導入し、全自由エネルギーを汎関数として定義する。

代表形（単一秩序変数と濃度）：
$$
F[c,\eta]=\int_\Omega \left(
f_\mathrm{bulk}(c,\eta,T)
+\frac{\kappa_c}{2}|\nabla c|^2
+\frac{\kappa_\eta}{2}|\nabla \eta|^2
+f_\mathrm{el}(\varepsilon,\eta,c)
\right)\,dV
$$

発展方程式は、保存量と非保存量で異なる。

非保存秩序変数（Allen–Cahn型）：
$$
\frac{\partial \eta}{\partial t}=-L_\eta\frac{\delta F}{\delta \eta}+\xi_\eta
$$

保存量（Cahn–Hilliard型）：
$$
\frac{\partial c}{\partial t}=\nabla\cdot\left(M_c\nabla \mu\right),\quad
\mu=\frac{\delta F}{\delta c}
$$

ここで $L_\eta$ は緩和係数、$M_c$ はモビリティである。$\xi$ は熱ゆらぎ等を入れる場合の雑音項である。

## 2. 第一原理に基づくか
PFの不確かさは主に次に集約される。
- バルク自由エネルギー密度 $f_\mathrm{bulk}(c,\eta,T)$ の形と温度依存
- 界面を規定する勾配エネルギー係数（$\kappa_c,\kappa_\eta$）や界面エネルギー・界面厚み
- 弾性項 $f_\mathrm{el}$（弾性定数、固有ひずみ、異方性）
- 速度論（$M_c, L_\eta$）とその温度依存
- 多相・多成分化したときの整合（化学ポテンシャルの一貫性、サブ格子モデルなど）

第一原理に基づくPFでは、これらのうち少なくとも「エネルギー汎関数の主要部分」を、電子状態計算・統計力学・格子モデルから導出または拘束する。

## 3. DFT → クラスター展開 → Monte Carlo → $G(c,T)$ → PF
合金の相分離・規則化（B2/L1_2 等）では、有限温度の自由エネルギーが鍵である。
1) DFTで多数の原子配置のエネルギー $E(\sigma)$ を計算する  
2) クラスター展開で格子上の有効ハミルトニアン $H_\mathrm{CE}(\sigma)$ を構成する  
3) Monte Carloで熱平均・相境界・自由エネルギーを評価し、$G(c,T)$ を得る  
4) PFで扱いやすい形（多項式、対数項、サブ格子形式など）へフィットして $f_\mathrm{bulk}$ として用いる  

自由エネルギーの分解例：
$$
f_\mathrm{bulk}(c,\eta,T)=f_\mathrm{chem}(c,T)+f_\mathrm{ord}(c,\eta,T)
$$

規則化変態では、秩序変数 ηを「規則度」や「サブラティス占有差」として定義し、二重井戸ポテンシャルやLandau型展開で表すことが多い。

## 4. DFT → 振動自由エネルギー（フォノン） → 温度依存相安定
相安定性を温度で議論する場合、0 Kの全エネルギーだけでなく振動寄与が支配的になることがある。
- 準調和近似（quasi-harmonic approximation）などで
$$
F(T,V)=E_0(V)+F_\mathrm{vib}(T,V)
$$
を評価し、相ごとの $G(T)$ を得る  
- 得られた相安定（あるいは混合自由エネルギー）をPFの $f_\mathrm{bulk}$ に反映する  

この系統は、相転移温度の再現性や、析出の駆動力の温度依存に効く。

## 5. 第一原理＋CALPHAD → PF（熱力学DB連成）
多成分系では、全組成・全温度域を第一原理のみで埋めるのは困難である。そこで
- DFTで形成エンタルピー、規則相の安定性、欠陥の寄与などを評価し
- CALPHADのパラメタ最適化や相の拘束条件として組み込み
- PFではCALPHAD由来の $g(c,T)$（多成分）と化学ポテンシャルをそのまま利用する
という連成が広く用いられる。

サブ格子相（規則相）を扱う場合、CALPHADのサブ格子モデルとPFを整合させる拡張もある。

## 6. 勾配エネルギー係数と界面エネルギー
PFの界面特性は、$f_\mathrm{bulk}$ と $\kappa$ により決まる。
単純化した1次元界面で、界面エネルギーは概略
$$
\gamma \sim \int_{-\infty}^{\infty}\left(\frac{\kappa}{2}\left|\frac{d\eta}{dx}\right|^2+\Delta f(\eta)\right)dx
$$
のように評価され、$\kappa$ は界面厚みとともに $\gamma$ を規定する。

第一原理側からの与え方としては次がある。
- 代表界面（整合/半整合/不整合）を原子レベルで作り、界面エネルギーを評価してPFの $\kappa$ と整合させる
- 界面近傍の組成依存や異方性（界面方位依存）を、異方的勾配項や方位依存モビリティへ落とし込む
- 粗視化（自由エネルギーの勾配展開）により、秩序変数の勾配項を導出する考え方もある

## 7. 弾性・固有ひずみ連成
弾性連成は、微細組織の形状選択・配向・相互作用を決定する。
- 弾性定数 $C_{ijkl}$ をDFTで評価し、異方弾性として $f_\mathrm{el}$ に入れる
- Vegard則や格子不整合に基づく固有ひずみ $\varepsilon^0(c,\eta)$ を与える
- 機械的平衡
$$
\nabla\cdot \sigma = 0,\quad \sigma=C:(\varepsilon-\varepsilon^0)
$$
を同時に解き、弾性場を介した長距離相互作用を再現する  

強い弾性異方性・格子整合の制約がある系ほど、第一原理入力（$C_{ijkl}$、$\varepsilon^0$）の効果が大きい。

## 8. 速度論パラメータ
PFの時間スケールは $M_c, L_\eta$ に強く依存する。これらは実験フィットで与えられることが多いが、第一原理から次の形で束縛できる。
- 拡散：空孔機構などの移動障壁 $E_m$ をNEB等で求め、Arrhenius型で
$$
D(T)=D_0\exp\left(-\frac{E_m}{k_\mathrm{B}T}\right)
$$
を与え、$M_c$ と関係づける（熱力学因子との組合せが必要である）
- 界面移動：界面エネルギーと界面構造、律速機構（拡散律速/界面律速）から、速度論をモデル化する  
- 高温・粗視化では、相対的な時間比較（条件間の相対速度）に重点を置く設計もある  

## 9. 数値解法
PFは典型的に非線形PDE（しばしば4階偏微分を含む）であり、数値設計が結果を左右する。

空間離散：
- 有限差分法：実装が単純で規則格子に強い
- スペクトル法（FFT）：周期境界条件とCahn–Hilliardの高階微分に適性が高い
- 有限要素法：複雑形状、適応メッシュ、弾性連成や多物理場連成に強い

時間積分：
- 陽解法：条件付き安定で刻み制約が厳しい
- 半陰解法・陰解法：大きい刻みが可能だが、非線形ソルバが必要になる
- Cahn–Hilliardでは4階項のため、分割して2つの2階方程式として解く手法（混合形式）が使われることが多い

安定化の典型：
- 化学ポテンシャル $\mu$ を導入して次数を下げる
- 非線形項を凸分解（convex splitting）して無条件安定化を狙う
- 異方性界面エネルギーでは勾配項が硬くなり、半陰解法の効果が大きい

## 10. ソフトウェア
- マルチフェーズPF（鋼、凝固、析出など）：マルチフェーズPFの枠組みを実装した商用・研究コードが多い
- 熱力学DB連成：PF中で熱力学DBを呼び出して化学ポテンシャルを得る方式がある
- 汎用フレームワーク：有限要素ベースのPF/PDEフレームワークが整備されており、弾性・拡散・相変態の連成を組み上げやすい
- 教育・検証用途：Cahn–Hilliardや結晶成長などの例題実装が公開されている

## 11. 検証の考え方
第一原理PFでは、数値の流れが複数段に渡るため、段階的な検証が有効である。
- $f_\mathrm{bulk}$：MCやCALPHADと同じ相境界・化学ポテンシャルが再現できるか
- 界面：界面エネルギー、界面厚み、方位依存が期待通りか
- 弾性：析出物形状の選択、相互作用、配列が弾性異方性と整合するか
- 時間：拡散係数・界面速度の温度依存が矛盾していないか（絶対値より傾向確認が重要な場合もある）

## まとめ
第一原理計算に基づくフェーズフィールド計算は、自由エネルギー汎関数の主要項（化学・勾配・弾性）と速度論パラメータを、電子状態計算と統計力学で拘束しながら、μmスケールの組織形成を連続体PDEとして追跡する枠組みである。DFT→（クラスター展開/フォノン/CALPHAD）→自由エネルギー→PFという連結を明確に設計し、界面・相境界・弾性場で段階的に検証することが、予測性を高める要点である。

