# JuKKRによる局所電子状態計算

JuKKRは、KKR（Korringa–Kohn–Rostoker）グリーン関数法に基づく全電子DFTコード群である。周期系から不純物埋め込み、散乱・輸送までを、同一の多重散乱形式で一貫して扱える点が特徴である。

## 参考ドキュメント
- JuKKR公式サイト（コード構成の俯瞰、各プログラムの説明）
  https://jukkr.fz-juelich.de/
- JuKKRの公開・引用情報（Zenodo。永続IDとDOI）
  https://doi.org/10.5281/zenodo.7284738
- MateriApps（日本語）：KKR系コードの概説（関連概念の整理に有用）
  https://ma.issp.u-tokyo.ac.jp/app-category/algorithm6


## 1. JuKKRで何ができるか
JuKKRは「Jülich KKR codes」として、複数のプログラムからなるコードファミリーとして提供されている。中心となる対象は以下である。

- バルク結晶・多層膜・界面の電子状態（スピン分極、SOCを含む相対論計算を含む）
- 不純物・欠陥・クラスターの埋め込み（ホスト系のグリーン関数を用いる）
- 不規則性や散乱の取り扱い（合金モデル、欠陥散乱、応答・輸送への接続）
- フェルミ面、ボルツマン輸送、応答テンソル（コードにより分担）
- 動的磁化応答（時間依存DFTに相当する枠組みを扱う派生コードがある）
- 超大規模系（線形スケーリングを指向した派生コードがある）

公開形態はオープンソース（MITライセンス）であり、研究コミュニティ主導で継続的に更新されている。

## 2. KKRグリーン関数と多重散乱
平面波基底の「波動関数を対角化する」見方と異なり、KKR法は原子中心の散乱体として系を捉え、エネルギーごとのグリーン関数からスペクトル量を構成する立場をとる。

### 2.1 基本式
単一サイト散乱を $t$（散乱行列）、幾何学（サイト間）情報を $G^0$（構造定数）とすると、散乱経路演算子（scattering path operator）$\tau$ は典型的に

$$
\tau(E) = \left[t(E)^{-1} - G^0(E)\right]^{-1}
$$

の形で与えられる。これにより、局所DOSや電荷密度、磁化密度などがグリーン関数から計算される。

### 2.2 不純物埋め込み（Dyson方程式）
不純物やクラスターは、ホストのグリーン関数（あるいは $\tau^{host}$）を基準に摂動として導入される。概念的には

$$
G^{imp} = G^{host} + G^{host}\,\Delta V\,G^{imp}
$$

のDyson方程式を解くことで、有限サイズの欠陥を周期系ホストへ埋め込むことができる。この形式は、欠陥が引き起こす局所的な電子状態変化や散乱を、ホストの計算結果と接続しやすい。

## 3. コード群の役割分担
JuKKRは用途別に実行ファイルが分かれている。典型的な位置づけを表にまとめる。

| コンポーネント | 役割 | 主な入出力（例） | 典型ユースケース |
|---|---|---|---|
| voronoi | 原子中心セル（ボロノイ分割）と初期ポテンシャル生成 | 構造情報 → 立ち上げ用ポテンシャル | 新規系の初期化、層状系の準備 |
| KKRhost | 周期系（バルク・界面・多層膜）の自己無撞着DFT | ポテンシャル ↔ 電荷密度（SCF） | バンド/DOS、界面磁性、SOC込み電子状態 |
| KKRimp | 不純物・クラスターの埋め込み（Dyson） | ホストGF + 不純物定義 → 局所電子状態 | 欠陥準位、局所磁気モーメント、散乱源の導入 |
| PKKprime | 散乱・フェルミ面・ボルツマン輸送の評価 | host/imp情報 → 伝導度等のテンソル | AHE/SHE、torkance、平均自由行程など |
| KKRsusc | 動的磁化応答（時間依存DFT相当）の計算 | 電子状態 → 応答関数 | スピン感受率、励起スペクトル |
| KKRnano | 線形スケーリングを狙う超大規模系向け | 大規模系の近似GF計算 | 巨大系・多欠陥系のスケール拡張 |

## 4. 代表的ワークフロー
### 4.1 周期系（バルク・界面）の電子状態
1. 構造（格子・原子座標）を用意する  
2. voronoiでセル分割と初期ポテンシャルを作る  
3. KKRhostでSCFを回し、収束したポテンシャルとフェルミ準位を得る  
4. DOS・バンド（必要ならスピン分解、SOC込み）や局所磁気モーメントを評価する  

### 4.2 不純物・欠陥
1. 4.1で得たホストの情報から、埋め込み領域のホストGFを用意する  
2. 不純物（置換、空孔、クラスター、局所スピンテクスチャなど）を定義する  
3. KKRimpでDyson方程式を解き、局所DOSや電荷・磁化の変化、散乱情報を得る  

### 4.3 輸送・散乱（PKKprime）
KKRimp/KKRhostの結果を入力として、線形化ボルツマン方程式に基づく応答テンソル（伝導度、スピン流、スピン軌道トルク応答など）を評価する流れとなる。

## 5. JuKKRの問題設定
- 欠陥・不純物・界面の局所電子状態と、その散乱が支配的な物性を同じ枠組みで見たいとき
- SOC起源の応答（AHE/SHE、トルクなど）を、電子構造と散乱を接続して議論したいとき
- 合金・乱れ・有限温度効果を、平均化近似や散乱として取り込みたいとき
- 大規模系や「欠陥をたくさん含む系」を、周期超胞の巨大化以外の方針で扱いたいとき

国内ではKKR系コードとしてAkaiKKRなども流通しており、同じグリーン関数・多重散乱の発想を共有するため、概念整理や用語統一に役立つ。

## 6. 設定で効いてくるポイント
- 角運動量カットオフ $l_{max}$：遷移金属・重元素では収束が遅くなり、物性量（特にSOC起源）が敏感になり得る
- エネルギー積分とメッシュ：グリーン関数法では複素エネルギー積分やサンプリング設計が安定性に効く
- 層状系・界面：原子層の定義、真空/バリア層の扱い、ポテンシャルの継ぎ目に注意が要る
- 不純物埋め込み：ホストと不純物領域の整合（参照フェルミ準位、クラスタ半径、自己無撞着の範囲）が結果解釈を左右する
- 並列：PKKprimeなどはMPI/OpenMP並列を前提にスケールさせる設計になっている

## 7. 平面波DFT（例：VASP）との比較
- VASP等：周期境界＋超胞で欠陥を表現し、波動関数の対角化で進める構図になりやすい
- JuKKR：周期系ホストのGFを基準に、欠陥をDyson方程式で埋め込み、散乱・輸送へ自然に接続しやすい

両者は競合というより補完であり、例えば「VASPで構造緩和、JuKKRで散乱・輸送評価」といった役割分担も考えられる。

## まとめ
- JuKKRはKKRグリーン関数法に基づくオールエレクトロンDFTコード群であり、周期系・不純物埋め込み・散乱/輸送までを同一形式で接続できるのが強みである。  
- voronoi → KKRhost →（必要なら）KKRimp →（必要なら）PKKprime、という最小の道筋を押さえると全体像が掴みやすい。  
- 設定の要点は $l_{max}$、エネルギー積分/メッシュ、ホストと埋め込み領域の整合であり、SOC起源の量ほど収束と整合性が効く。

