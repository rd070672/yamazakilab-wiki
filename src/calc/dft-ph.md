# 第一原理計算に基づくフェーズフィールド計算
作成日：2025年11月23日

## 概要
- 第一原理フェーズフィールド計算とは、**DFT などの第一原理計算で得られた情報を用いて、フェーズフィールドモデルの自由エネルギーや物性パラメータを構築し、組織・相変態の時間発展をシミュレーションする枠組み**である。
- 典型的には、次の二つのレベルで「第一原理」と結びつく。
  - アプローチ1：DFT から得たエネルギー・弾性定数・界面エネルギー・拡散係数などを **パラメータとしてフェーズフィールドに渡す**。
  - アプローチ2：より直接的に、第一原理に基づく自由エネルギー汎関数（クラスター展開、PFC など）をフェーズフィールド形式に埋め込む。

## アプローチ1：DFT → フェーズフィールドへのパラメータ連結
- もっとも実務的・汎用的な方法は、
  - DFT（あるいは第一原理 MD）で「点ごとの物性」を計算し、
  - それを連続場の自由エネルギー汎関数にフィットして、
  - Allen–Cahn / Cahn–Hilliard 方程式として時間発展を解く、という流れである。
- 第一原理から供給される代表的な量：
  - 各相の基底状態エネルギー・混合エネルギー（→ 化学自由エネルギー）
  - 弾性定数テンソル $C_{ijkl}$ と変態ひずみ（→ 弾性エネルギー項）
  - 界面エネルギー・界面厚さ（→ 勾配エネルギー係数 $\kappa$）
  - 拡散係数・モビリティ $M(c,T)$（→ Cahn–Hilliard の移動度）
  - 必要に応じて磁気モーメント・磁気秩序パラメータに対するエネルギー依存性

## 自由エネルギー汎関数の構築（化学自由エネルギー）
- 2 成分系合金 A–B の濃度場 $c(\mathbf{r})$ を例にとる。
- DFT で行うこと：
  - いくつかの組成・構造（規則相／不規則相、ひずみ状態など）について
    $$
      E_\text{DFT}(c, \varepsilon, \{\eta\})
    $$
    を計算する。
  - ここで $\varepsilon$ はひずみ、$\eta$ は秩序パラメータ（例えば B2, L1$_2$ などの規則度）を表す。
- これらの点データを用いて、連続場の自由エネルギー密度
  $$
    f_\text{chem}(c, \varepsilon, \{\eta\}, T)
  $$
  を多項式や Landau 型展開、あるいは CALPHAD とのハイブリッドなどでフィットする。
- フェーズフィールドではこの $f_\text{chem}$ を体積積分して
  $$
    F_\text{chem}[c,\eta] = \int_\Omega f_\text{chem}(c,\eta,\varepsilon,T) \, dV
  $$
  として扱う。

## 界面エネルギーと勾配エネルギー係数の決定
- フェーズフィールドの勾配エネルギー項：
  $$
    F_\text{grad} = \int_\Omega \frac{\kappa}{2}|\nabla \phi|^2 \, dV
  $$
  の係数 $\kappa$ は、界面エネルギー $\gamma$ と界面幅 $\delta$ によって決まる。
- 第一原理レベルでの評価例：
  - 相 A / 相 B の界面を含むスーパーセルを作成し、界面を含む系の DFT エネルギーから界面エネルギー $\gamma$ を抽出。
  - MD あるいは第一原理 MD を併用して、界面幅・界面構造を評価。
- 得られた $\gamma$ と想定する界面幅から $\kappa$ を逆算し、フェーズフィールドの勾配項に反映する。

## 弾性エネルギーと変態ひずみの導入
- DFT による弾性定数テンソル：
  - 各相について体積・ひずみを振ってエネルギーを計算し、弾性エネルギー
    $$
      f_\text{elas} = \frac{1}{2} C_{ijkl}(\eta,c)\,\varepsilon_{ij}\varepsilon_{kl}
    $$
    の形でフィットする。
- 変態ひずみ（eigenstrain）の導入：
  - 例えば、マルテンサイト変態や析出による格子ミスマッチについて、
    $$
      \varepsilon_{ij} = \varepsilon_{ij}^\text{elastic} + \varepsilon_{ij}^\text{trans}(c,\eta)
    $$
    と分解し、$\varepsilon_{ij}^\text{trans}$ を DFT の格子パラメータの差から決める。
- フェーズフィールドでは、Khachaturyan 型のマイクロエラスティシティ理論と組み合わせて、
  - 相分布（$\eta$）とひずみ場の連成
  - 弾性エネルギーによる析出物形状・配向の制御
  を記述することができる。

## 拡散係数・モビリティの第一原理評価
- 濃度場を扱う Cahn–Hilliard 型モデルでは、モビリティ $M(c,T)$ が時間スケールを決める。
- 第一原理からの評価手順の例：
  - 欠陥（空孔・間隙原子）を含むセルの DFT エネルギーを計算し、欠陥形成エネルギーを求める。
  - NEB（Nudged Elastic Band）法などで拡散遷移状態のエネルギー障壁を計算。
  - これらから Arrhenius 型
    $$
      D(c,T) \sim D_0(c)\,\exp\left(-\frac{Q(c)}{k_B T}\right)
    $$
    を構成し、Cahn–Hilliard の $M(c,T) \propto D(c,T)$ にマッピングする。

## 第一原理フェーズフィールド計算の典型的ワークフロー
1. 対象系・物理現象の決定
   - 例：析出物形成、スピノーダル分解、変態強化鋼、磁気相変態など。
2. DFT/第一原理計算による「素材データ」の取得
   - 代表的組成・相・ひずみ状態の全エネルギー
   - 弾性定数、格子定数、磁気状態依存エネルギー
   - 界面・欠陥のエネルギー、拡散障壁など。
3. 自由エネルギー汎関数の構築
   - $f_\text{chem}(c,\eta,\varepsilon,T)$、$f_\text{elas}$、$f_\text{grad}$ を Landau 展開・多項式フィット・CALPHAD 連携などで定式化。
4. フェーズフィールド方程式の定義
   - 非保存量（秩序パラメータ） → Allen–Cahn
   - 保存量（濃度） → Cahn–Hilliard
   - 必要に応じて弾性場・温度場との連成。
5. 数値実装（FDM / FEM / スペクトル法など）
   - 実際には COMSOL, MOOSE, FiPy, 自作コード (Python/C++ + FFT) などを利用。
6. 時間発展計算
   - 初期組織・初期濃度・負荷条件（冷却過程、応力、磁場など）を与え、組織進化をシミュレーション。
7. 実験・他のシミュレーションとの比較
   - 析出物サイズ分布、界面形状、相分率の時間変化などを実験と比較し、パラメータ・モデルの妥当性を検証。

## アプローチ2：より「第一原理的」なフェーズフィールド（クラスター展開・PFC など）
- クラスター展開 (Cluster Expansion, CE) + フェーズフィールド
  - DFT から CE を構築し、組成・秩序度依存の自由エネルギーを高精度に記述。
  - その CE エネルギーを Landau 形式やフェーズフィールド自由エネルギーに変換することで、「第一原理に整合した」フェーズフィールドを実現する。
- フェーズフィールドクリスタル (Phase-Field Crystal, PFC) モデル
  - 原子レベルの周期構造を持つ密度場 $\psi(\mathbf{r})$ の自由エネルギー汎関数を使う。
  - 古典密度汎関数理論や第一原理に基づく有効ポテンシャルから PFC のパラメータを導出する試みもある。
  - 通常のフェーズフィールドより「原子レベルに近い」スケールを扱えるが、計算コストやパラメータ化の難しさも大きい。

## 利点と限界
- 利点：
  - 実験に頼らず、**電子構造レベルの情報を反映した組織進化シミュレーション**が可能。
  - 新規合金系や未探索組成領域でも、第一原理に基づく予測ができる。
  - 弾性・磁性・化学・界面エネルギーなど、複数の物理要因を一貫したフレームワークに統合できる。
- 限界・注意点：
  - DFT データ準備にコストがかかる（多数の構造・組成・ひずみ状態の計算が必要）。
  - 交換–相関汎関数の近似、有限温度効果（振動・電子励起・磁気揺らぎなど）の扱いにモデル依存性が残る。
  - フェーズフィールド側でも、界面幅・時間スケールのマッピングに不確かさがある。
- 実務的には、  
  - DFT＋CALPHAD＋フェーズフィールド  
  - DFT＋CE＋MC＋フェーズフィールド  
  といったハイブリッドなマルチスケール連成が現実的な選択肢となる。

