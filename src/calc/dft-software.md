# 第一原理計算ソフトウェアと特徴

第一原理計算ソフトウェアは、同じ密度汎関数理論（DFT）を基礎にしつつ、基底関数・全電子/擬ポテンシャル・実装思想（性能最適化、拡張手法、対象スケール）の違いにより多数に分かれる。研究テーマに対して「何が得意で、何が苦手か」を最初に整理して選ぶことが再計算コストを下げる鍵である。

## 参考ドキュメント
- Quantum ESPRESSO User Guide (PDF)
  https://www.quantum-espresso.org/Doc/user_guide_PDF/user_guide.pdf
- CP2K Project (official)
  https://www.cp2k.org/
- CMSI Torrent 006: 10^16が創り出す新マテリアル（国内の公開ソフト紹介を含む、日本語PDF）
  https://cmsi.issp.u-tokyo.ac.jp/torrent/torrent006/torrent6j.pdf

## 1. ソフトが分かれる理由
第一原理計算の中心は、電子密度からポテンシャルを決め、Kohn–Sham方程式を自己無撞着に解く枠組みである。

$$
\left[-\frac{1}{2}\nabla^2 + V_{\mathrm{eff}}[n(\mathbf r)]\right]\psi_i(\mathbf r)=\varepsilon_i\psi_i(\mathbf r),\quad
n(\mathbf r)=\sum_{i}^{\mathrm{occ}}|\psi_i(\mathbf r)|^2
$$

ここで「波動関数や密度をどう表現するか」が実装の分岐点であり、主に次で分類される。
- 平面波 + 擬ポテンシャル/PAW：周期固体に強く、収束が体系的である
- 局在軌道（LCAO/NAO/LCPAO）：大規模系・欠陥・界面で計算量を抑えやすい
- 実空間格子：局所性や多重解像度で柔軟に扱える場合がある
- 全電子（FP-LAPW, NAO all-electron, KKR等）：内殻も含めて精密だが計算が重くなりやすい

## 2. チェックリスト
- 対象：周期固体/表面・界面/分子・クラスター/液体・アモルファス
- 必要物性：構造最適化、バンド、磁性（SOC含む）、フォノン（DFPT/有限差分）、GW/BSE、輸送、スペクトル
- スケール：原子数（10–100、10^2–10^3、10^4級）、サンプル数（ハイスループットか）
- 品質要件：全電子が要るか、擬ポテンシャルで十分か、相対比較か絶対値が要るか
- 運用：ライセンス、HPC環境、周辺ツール連携（ASE等）、既存コミュニティ資産

## 3. 代表ソフトウェアの分類一覧
表中の「得意」は実務での傾向であり、最終的な優劣は対象系・入力設定・擬ポテンシャル/基底セット・収束条件に強く依存する。

| 系統 | ソフト例 | 表現/基底の要点 | 得意な場面 | 注意点 |
|---|---|---|---|---|
| 平面波（PW） | VASP | PW + 擬ポテンシャル/PAW | 周期固体の標準的ワークホース、参照計算の統一 | 有償ライセンス、計算コストは大きくなりやすい |
| 平面波（PW） | Quantum ESPRESSO | PW + 擬ポテンシャル、統合スイート | オープンソースで広範囲、教育・共有がしやすい | 擬ポテンシャル選定の作法が品質を左右する |
| 平面波（PW） | ABINIT | PW + 擬ポテンシャル、DFPT等の拡張 | オープンソース、線形応答（フォノン等）と相性がよい | 入力流儀に慣れが要ることがある |
| 平面波（PW） | CASTEP | PW + 擬ポテンシャル（商用系で流通） | GUI/商用環境と組み合わせたい場合 | ライセンス形態・環境依存に留意 |
| 局在軌道（LCAO/NAO） | SIESTA | 原子軌道（有限範囲NAO）+ 擬ポテンシャル | 大規模系、欠陥・界面、計算資源が限られる場合 | 基底の作法が収束と精度に効きやすい |
| 局在軌道（LCPAO） | OpenMX | 擬原子軌道の線形結合（LCPAO） | 日本語資源が充実、材料・磁性・大規模に強い場面がある | 完全基底でないため「収束の見切り方」が重要 |
| 混成（Gaussian+PW補助） | CP2K | Gaussian and Plane Waves（GPW/GAPW） | 分子/固体/液体をまたぐAIMD、比較的大規模 | 基底セットと設定の習熟が効率に直結する |
| 実空間・マルチ表現 | GPAW | PAW、実空間格子/平面波/局在基底 | Python主導の解析・ワークフロー、柔軟な表現 | HPC運用・依存関係の整備が必要な場合がある |
| 全電子（FP-LAPW） | WIEN2k | 全電子・フルポテンシャルLAPW | 精密参照、内殻も含めた厳密性が欲しい場合 | 計算が重く、入力・運用に専門性が要る |
| 全電子（FP-LAPW） | FLEUR / Elk | 全電子・フルポテンシャルLAPW | 全電子系の研究用途、手法開発寄り | 学習コスト、系のサイズに限界が出やすい |
| 全電子（NAO all-electron） | FHI-aims | 数値原子中心軌道の全電子 | 高精度とスケールの両立を狙う場合 | 利用条件や環境整備の確認が必要 |
| Green関数・KKR | SPR-KKR / JuKKR等 | KKR Green関数、相対論等 | 磁性・輸送・分光など特定物性に強い | 一般DFTとは流儀が異なり学習が必要 |

## 4. 分子・クラスター寄り（量子化学系）
固体でもクラスター近似や分子吸着の局所モデルで役立つ。分散力、励起状態、開殻分子の分光などで選ばれることが多い。
- ORCA：DFTから多体法まで幅広く、学術利用が容易な形態で提供されることがある
- NWChem：大規模並列を意識したオープンソース
- Psi4：オープンソース、教育・自動化にも向く
- Gaussian：商用の定番枠として参照されることが多い

## 5. 目的別
- 周期固体の標準計算（構造・バンド・磁性の基礎）：PW系（VASP/QE/ABINIT）を軸に統一しやすい
- 欠陥・界面・巨大セル、反復サンプルが多い：局在軌道（SIESTA/OpenMX）やCP2Kの優位が出やすい
- AIMD（液体・アモルファス・界面の統計）：CP2K、PW系、状況によりGPAW
- 参照精度（全電子、比較検証、内殻の厳密性）：WIEN2k/FLEUR/Elk/FHI-aims
- 輸送・分光・磁性の特定物性（Green関数/相対論が効く）：SPR-KKR系

## 6. 注意点
- 擬ポテンシャル/PAWデータセットと基底セットが、コード差より結果差を生むことがある
- 収束指標（カットオフ、k点、スメアリング、セル/原子緩和条件）を「比較軸」として固定する設計が重要である
- 同一テーマ内では、参照コード（高精度）と探索コード（高速）を役割分担して運用すると強い
- ワークフロー化（自動化）で再現性が上がる。ASEのような共通インターフェースで複数コードを統合する設計も有効である

## まとめ
第一原理計算ソフトウェアは、平面波・局在軌道・実空間・全電子・Green関数といった表現の違いにより強みが分かれる。対象スケールと必要物性、そして運用制約（ライセンス・HPC・自動化）を先に固定し、参照計算と探索計算を役割分担するのが実務的である。

