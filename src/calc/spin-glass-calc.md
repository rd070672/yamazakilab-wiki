# 計算科学で読み解くスピングラス

スピングラスは、無秩序とフラストレーションにより、平衡化が困難で準安定状態が無数に現れる磁性系である。計算科学は、相図・基底状態・自由エネルギー地形・非平衡ダイナミクスを同一の枠組みで扱い、観測量とミクロ機構を往復させるための中核手段である。

## 参考ドキュメント
- 大関真之, スピングラス模型の臨界点と双対変換1 – 厳密解を求めて –（解説, 2010）  
  https://www-adsys.sys.i.kyoto-u.ac.jp/mohzeki/bk2010.pdf
- Fan, C. et al., Searching for spin glass ground states through deep reinforcement learning, Nat. Commun. 14, 725 (2023).  
  https://www.nature.com/articles/s41467-023-36363-w
- 日本電信電話株式会社, 100000スピン コヒーレントイジングマシンを実現（プレスリリース, 2021/09/30）  
  https://group.ntt/jp/newsrelease/2021/09/30/210930a.html

## 1. 何を知りたいのか

スピングラスを扱うとき、計算で答える問いは概ね次の形に落ちる。

- 相転移は存在するか、凍結温度 $T_g$ はどこか
- 秩序は何で特徴付けられるか（磁化ではなくオーバーラップ、相関長など）
- 自由エネルギー地形はどれほど rugged か（障壁、谷の数と階層性）
- 緩和はどれほど遅いか（エイジング、記憶、若返り、周波数依存）
- 無秩序の起源（乱れた交換結合、乱れた異方性、ランダム場など）を同定できるか
- 物質パラメータ（交換 $J_{ij}$、異方性 $K$、DMI $\mathbf{D}_{ij}$、減衰 $\alpha$ など）が観測量にどう写るか

この「問い」を、以下の 4 層に分けて設計する

1) 物質から有効スピン模型を作る  
2) 平衡量（熱力学）をサンプリングする  
3) 非平衡量（時間応答）を計算する  
4) 観測量から模型パラメータを推定する（逆問題）

## 2. モデル化：電子・原子の情報をスピングラス模型へ落とす

### 2.1 有効ハミルトニアン

実系を抽象化すると、多くは次の形に整理できる。

$$
H = -\sum_{i\neq j} J_{ij}\,\mathbf{e}_i\cdot\mathbf{e}_j
-\sum_i K_i(\mathbf{e}_i\cdot\hat{\mathbf{n}}_i)^2
-\sum_{i<j}\mathbf{D}_{ij}\cdot(\mathbf{e}_i\times\mathbf{e}_j)
-\sum_i \mu_i \mathbf{H}\cdot\mathbf{e}_i
$$

- $\mathbf{e}_i$ はサイト $i$ の単位スピン（Ising なら $e_i=\pm 1$）
- $J_{ij}$ が正負混在し、かつ幾何学的制約で全結合を同時に満たせないとき、フラストレーションが生じる
- $K_i$ や $\hat{\mathbf{n}}_i$ の乱れ（ランダム異方性）もガラス化の駆動になり得る
- 実材料では、化学的不規則（サイト混合、欠陥、粒界）により $J_{ij}$ が空間的に揺らぎ、ガラス性が現れる場合が多い

### 2.2 無秩序の表現：SQS、CPA、クラスタ近似

無秩序を計算に載せるには、次の二系統が有用である。

- SQS（special quasirandom structures）
  小さな周期超胞で、近接相関を“無秩序に近く”再現する構造を設計し、第一原理計算で $J_{ij}$ や $K$ を評価する。無秩序を明示的に含むため解釈が直感的である一方、サンプル数（異なるSQS）とサイズ依存が課題になる。
- CPA（coherent potential approximation）系（特に KKR-CPA）
  無秩序平均を自己無撞着に行い、平均的な電子状態と交換相互作用を扱いやすい。組成依存の平均挙動を連続的に追える一方、局所揺らぎやクラスター性は別途評価が必要になる。

### 2.3 交換結合の抽出：$J_{ij}$ の第一原理評価

第一原理から Heisenberg 模型の $J_{ij}$ を得る標準的枠組みとして、グリーン関数・局所スピン密度に基づく方法（いわゆる Liechtenstein の式）が広く用いられる。$J_{ij}$ が得られれば、以後は統計力学（MC）やスピンダイナミクス（LLG）で温度・時間依存を扱える。

得られる解析例：
- どの距離の $J_{ij}$ が正負反転しているか（RKKY 的振動の有無）
- 乱れが入ると“強い結合と弱い結合”がどの程度分布を持つか
- 異方性やDMIを含めたとき、凍結の性質がどう変わるか

## 3. 平衡計算：凍結温度と相図を出すためのサンプリング戦略

スピングラスで最も支配的なボトルネックは、平衡化（エルゴード性）の破れである。よって「どのサンプラーを設計するか」自体が研究の中心になる。

### 3.1 代表的サンプリング法の比較

| 手法 | 何をするか | メリット | 得意な解析 | 注意点 |
|---|---|---|---|---|
| 単温度MC（Metropolis/heat-bath） | 固定 $T$ で局所更新 | 実装が簡単 | 高温の熱平均、基礎量のテスト | 低温で凍りやすい |
| 交換MC（レプリカ交換、parallel tempering） | 複数温度のレプリカを交換 | rugged地形で強い | $T_g$ 推定、臨界解析、低温平衡量 | 温度格子設計が重要 |
| 人口アニーリング（population annealing） | 多数レプリカを冷却＋再重み付け | 並列性が高い、自由エネルギー評価と相性が良い | 自由エネルギー差、広域の平衡量 | 人口サイズ・再標本化誤差 |
| マルチカノニカル | DOSを平坦化するよう重み更新 | 障壁越えを促進 | DOS、エントロピー、低温量 | 重み学習が難しい |
| Wang–Landau | DOS推定を逐次更新 | DOS推定の王道 | DOS、熱力学量の再構成 | サンプル間のばらつきが大きい場合がある |
| 再重み付け（ヒストグラム法等） | 近傍温度へ統計を写像 | 追加計算を減らせる | $T_g$ 近傍の高精度化 | 有効サンプルが足りないと破綻 |

計算の出力としては、単なるエネルギーや磁化ではなく、スピングラス特有の量を直接評価することが重要である。

### 3.2 スピングラス相の指標：オーバーラップと相関長

独立に熱平衡化した 2 つのレプリカ $a,b$ のオーバーラップを

$$
q_{ab}=\frac{1}{N}\sum_{i=1}^{N} s_i^{(a)} s_i^{(b)}
$$

と定義し、分布 $P(q)$ やモーメント $\langle q^2\rangle,\langle q^4\rangle$ を観測する。凍結温度近傍の有限サイズ解析には Binder 比が有効である。

$$
U_4 = 1-\frac{\langle q^4\rangle}{3\langle q^2\rangle^2}
$$

さらに、波数依存のスピングラス感受率 $\chi_{\mathrm{SG}}(\mathbf{k})$ から相関長 $\xi_L$ を見積もることが多い。

$$
\xi_L=\frac{1}{2\sin(k_{\min}/2)}
\left(\frac{\chi_{\mathrm{SG}}(0)}{\chi_{\mathrm{SG}}(\mathbf{k}_{\min})}-1\right)^{1/2}
$$

得られる解析例：
- $U_4$ や $\xi_L/L$ の交点から $T_g$ を推定する
- 臨界指数（$\nu,\eta$ など）を有限サイズスケーリングで評価する
- $P(q)$ の形から、低温相の状態構造（単純か階層的か）を議論する

## 4. 基底状態と準安定状態：最適化としてのスピングラス

低温物性や障壁議論では、基底状態（ground state）と低励起（domain wall、droplet）を精密に知りたい場面がある。このとき「統計力学」より「組合せ最適化」に寄せた計算が強力になる。

### 4.1 厳密解・高速解が可能な場合

2次元平面（特定の境界条件、外場なし等）では、Ising スピングラスの基底状態が最小重み完全マッチング（MWPM）へ写像でき、非常に大規模な格子でも厳密基底状態が計算可能である。その結果、剛性指数、ドメインウォールエネルギー、droplet 描像の検証などが進む。

### 4.2 一般次元での戦略

3次元以上や外場ありでは一般に困難になり、次の戦略を組み合わせる。

- 分枝限定・カット平面（整数計画としての厳密化）
- 遺伝的アルゴリズム＋局所厳密化（cluster-exact 近似など）
- 焼きなまし／交換MCを“基底探索”に特化して使う
- 強化学習や学習ベース探索で、探索方策自体を最適化する

得られる解析例：
- 基底状態の多重度、基底間オーバーラップ
- 低励起の空間構造とエネルギースケール
- エネルギー地形の ruggedness を、探索困難性として定量化する

## 5. 非平衡ダイナミクス：エイジング、記憶、周波数依存を計算する

### 5.1 二時間相関と応答

非平衡の代表量として、待ち時間 $t_w$ を含む二時間自己相関を用いる。

$$
C(t,t_w)=\frac{1}{N}\sum_{i=1}^N \langle s_i(t_w)\,s_i(t_w+t)\rangle
$$

$C(t,t_w)$ が $t_w$ に依存することがエイジングの指標である。さらに、摂動磁場に対する応答（線形応答・統合応答）を組み合わせ、揺動散逸関係（FDT）の破れとして非平衡性を議論することもある。

### 5.2 原子論的スピンダイナミクス（確率 LLG）

時間スケールを明示的に扱うには、熱雑音を含む確率 LLG（stochastic LLG）が基本となる。

$$
\frac{d\mathbf{S}_i}{dt}
=
-\frac{\gamma}{1+\alpha^2}
\left[
\mathbf{S}_i\times\mathbf{H}_i^{\mathrm{eff}}
+\alpha\,\mathbf{S}_i\times(\mathbf{S}_i\times\mathbf{H}_i^{\mathrm{eff}})
\right]
+\text{(thermal noise)}
$$

- $\mathbf{H}_i^{\mathrm{eff}}=-\partial H/\partial \mathbf{S}_i$ であり、$J_{ij},K,\mathbf{D}_{ij}$ がそのまま効く
- 温度を入れた緩和、磁場パルス応答、AC 応答などが直接計算できる
- 凍結が“静的”か“動的”か（観測時間に依存するか）を整理しやすい

得られる解析例：
- AC 帯磁率 $\chi(\omega)$ の周波数依存と緩和時間分布
- 記憶・若返りプロトコルの再現（温度ステップ操作の数値実験）
- 実空間でどこが先に凍るか（局所異方性・結合の強弱との対応）

## 6. 量子スピングラス：横磁場、量子揺らぎ、量子アニーリング

量子揺らぎを入れる最小形は横磁場 Ising 型である。

$$
H = -\sum_{i<j} J_{ij}\sigma_i^z\sigma_j^z - \Gamma\sum_i \sigma_i^x
$$

- 平衡問題は量子モンテカルロ（QMC）やその派生で扱える
- ただしフラストレーションや符号問題が計算を難しくする場合がある
- 計算困難性は、そのまま量子アニーリングやイジングマシンのベンチマーク物理へ接続する

国内では、イジングモデルを計算基盤として最適化を行うコヒーレントイジングマシン（CIM）の研究開発が継続しており、スピングラス型問題が標準的な参照課題になっている。

## 7. 逆問題：観測量から $J_{ij}$ や無秩序を推定する（inverse Ising）

スピングラスでは「モデルを与えて計算する」だけでなく、「観測量からモデルを推定する」問題が重要である。典型的には、サイト磁化や相関、感受率から $J_{ij}$ と局所場 $h_i$ を推定する inverse Ising が該当する。

$$
P(\{s\}) \propto \exp\left(\sum_{i<j}J_{ij}s_is_j + \sum_i h_i s_i\right)
$$

推定手法の例：
- 擬似尤度（pseudo-likelihood）に基づく推定
- 平均場近似、TAP 近似、ベリーフリーエネルギーに基づく推定
- メッセージパッシング（susceptibility propagation など）
- ベイズ推定（事前分布を入れて不確かさも含める）

得られる解析例：
- “乱れの強さ”や“有効結合の距離依存”を実験データから推定する
- 観測ノイズに対する頑健性や、推定不能領域（限界）を定量化する
- 推定した模型で温度・周波数応答を再現し、モデル同定の妥当性を検証する

## 8. 機械学習との融合：加速と解釈の両面

機械学習は大きく 2 つの役割を持つ。

### 8.1 計算の加速

- 強化学習で基底状態探索の方策を学習し、既存の焼きなまし等に組み込む
- 量子モンテカルロでガイド波動関数を学習的に与え、バイアスや分散を低減する
- 重要度サンプリングの提案分布を学習し、希な遷移（障壁越え）を引き出す

### 8.2 解釈の補助

- スピン配置集合を埋め込み（PCA/UMAP等）し、温度・履歴によるクラスタ構造を可視化する
- 学習した識別器により、従来の秩序パラメータだけでは区別しづらい相境界の指標を提案する
- 配置から局所特徴量（フラストレーション度、局所結合強度など）を抽出し、凍結核の空間分布を議論する

注意点として、機械学習は正解を保証しないため、必ず物理量（$U_4$、$\xi_L/L$、$P(q)$、相関関数、応答関数）への還元で検証する設計が必要である。

## 9. 典型ワークフロー

1. 無秩序の起源を仮説化する  
   乱れた $J_{ij}$ か、乱れた $K_i$ か、クラスター凍結か、などを仕分ける。

2. 無秩序を表現する  
   SQS や CPA のいずれか（または併用）で、組成・欠陥・サイト混合をモデル化する。

3. 第一原理から有効パラメータを抽出する  
   $J_{ij}$、$K$、必要なら $\mathbf{D}_{ij}$ を得て、分布や距離依存を確認する。

4. 平衡サンプリングで $T_g$ を決める  
   交換MCや人口アニーリングで $U_4$ と $\xi_L/L$ を評価し、有限サイズ解析を行う。

5. 非平衡計算で時間応答を再現する  
   二時間相関、AC応答、温度プロトコル（記憶・若返り）を計算し、観測時間依存を整理する。

6. 逆問題でモデル同定を補強する  
   観測量から推定した $J_{ij}$ と、第一原理由来の $J_{ij}$ を突き合わせ、整合する仮説を残す。

## 10. 注意点と検証項目

- 平衡化チェック不足：交換MCでも低温で平衡化できていない場合がある  
  対策として、往復ヒストグラム、レプリカ交換率、自己相関の長時間尾、独立ランの一致を確認する。
- サンプル間揺らぎ：無秩序平均が支配的で、平均値だけでは議論が崩れる  
  対策として、分布（中央値、分位点）や自己平均性の評価を併記する。
- モデルの過剰単純化：Ising で良いのか、ベクトルスピンが必要か、異方性の乱れが本質か  
  対策として、観測量（特に周波数依存）に最も効く自由度を優先して導入する。
- クラスターガラスとの混同：スーパースピン集合体などは別スケールの凍結を起こし得る  
  対策として、空間相関長と緩和時間分布を同時に評価し、単一粒子緩和との分離を行う。

## まとめ

スピングラスを計算科学で読み解く要点は、無秩序の表現（SQS/CPAなど）と、rugged 地形に耐えるサンプリング（交換MC、人口アニーリング、平坦化法）を核に、平衡量（$U_4,\xi_L/L,P(q)$）と非平衡量（二時間相関、AC応答）を往復させることである。さらに逆問題や機械学習を組み合わせることで、観測量から乱れの起源へ遡る同定能力が上がり、スピングラスを「難しい現象」から「設計可能な物理」へ近づけることができる。

## 関連研究
1. Hukushima, K. and Nemoto, K., Exchange Monte Carlo method and application to spin glass simulations, J. Phys. Soc. Jpn. 65, 1604 (1996).  
   https://www.jstage.jst.go.jp/article/jpsj/65/6/65_6_1604/_article
3. Liechtenstein, A. I. et al., Local spin density functional approach to the theory of exchange interactions in ferromagnetic metals and alloys, JMMM 67, 65 (1987).  
   https://www.sciencedirect.com/science/article/abs/pii/0304885387907219
4. Machta, J., A Monte Carlo method for rough free energy landscapes, Phys. Rev. E 82, 026704 (2010).  
   https://link.aps.org/doi/10.1103/PhysRevE.82.026704
5. Fan, C. et al., Searching for spin glass ground states through deep reinforcement learning, Nat. Commun. 14, 725 (2023).  
   https://www.nature.com/articles/s41467-023-36363-w
