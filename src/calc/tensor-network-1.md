# テンソルネットワーク入門

## 参考にしたドキュメント
- R. Orús, “A practical introduction to tensor networks: Matrix Product States and Projected Entangled Pair States,” Ann. Phys. 349, 117–158 (2014).  
  https://arxiv.org/pdf/1306.2164  
- テンソルネットワーク入門 (ＫＳ情報科学専門書)  
- TensorNetwork.org  
  https://tensornetwork.org/  
- H. Rieser et al., “Tensor networks for quantum machine learning,” Proc. R. Soc. A 479, 20230218 (2023).  
  https://arxiv.org/pdf/2303.11735


## 1. テンソルネットワークとは

- テンソルネットワーク（Tensor Network, TN）は、
  - 高次元テンソル（例：多数の量子ビット／スピンの波動関数）を
  - いくつかの「小さなテンソル」のネットワークとして分解・表現する枠組み。
- 典型例：
  - 量子多体系の波動関数  
    $\psi_{i_1 i_2 \dots i_N}$（指数的に大きいテンソル）を、
    低ランクのテンソルの積と縮約（contraction）で表す。
- 目的：
  - 物理的に「エンタングルメントが制限された」状態空間に変分的に制限することで、
    低エネルギー状態や時間発展を効率よく近似する。
  - 要するに「物理的に重要な部分だけを残し、指数的自由度をうまく圧縮する」ための表現。


## 2. 基本アイデアと図式表現

- テンソル：
  - スカラー：ランク 0 テンソル  
  - ベクトル：ランク 1 テンソル  
  - 行列：ランク 2 テンソル  
  - それ以上：ランク 3, 4, … の多次元配列。
- テンソルネットワークでは、
  - 各テンソルを「点（ノード）」、
  - 指標（インデックス）を「線（エッジ）」で表す図式表現（Penrose 図、tensor diagram）を多用する。
- 線が「つながっている」＝その指標で和を取る（縮約）ことを意味する。
  - 例：行列積 $C_{ik} = \sum_j A_{ij} B_{jk}$ は、
    2 つのノードを 1 本の線でつないだ図で表せる。
- 高次元テンソルを、
  - 物理自由度に対応する「開いた脚（leg）」
  - 内部自由度（ボンド）に対応する「結合脚」
  に分割することで、エンタングルメント構造を制御できる。


## 3. 主なテンソルネットワークの種類

### 3.1 MPS（Matrix Product State, 行列積状態）

- 1 次元量子多体系の基礎的な TN 形式。
- 波動関数を
  $$
    \psi_{i_1 i_2 \dots i_N} = \sum_{\{\alpha\}} A^{[1]}_{i_1 \alpha_1}
    A^{[2]}_{\alpha_1 i_2 \alpha_2} \dots A^{[N]}_{\alpha_{N-1} i_N}
  $$
  のような行列・三次元テンソルの積で表現する。
- 特徴：
  - ボンド次元 $D$ が有限の MPS は、エンタングルメントエントロピーが「面積法則（Area law）」に従う状態を効率よく表現できる。
  - DMRG（Density Matrix Renormalization Group）は「基底状態を MPS として最適化するアルゴリズム」として再解釈される。

### 3.2 PEPS（Projected Entangled Pair States）

- 2 次元以上に拡張したテンソルネットワーク。
- 各格子点に高ランクテンソルを置き、隣接サイト間を仮想ボンドでつなぐ。
- 強い相関と 2D の面積法則を自然に記述できるが、
  - 一般に TN の縮約コストが高く、近似的手法（Corner Transfer Matrix, Tensor Renormalization Group など）が必要。

### 3.3 MERA（Multiscale Entanglement Renormalization Ansatz）

- 多層の「ユニタリゲート＋ disentangler」からなる階層構造のネットワーク。
- 特徴：
  - スケール変換（renormalization）を幾何的に表現。
  - 臨界系のような長距離エンタングルメントを効率よく表現できる。

### 3.4 その他の代表的形式

- TTN（Tree Tensor Network）：
  - 木構造のネットワーク。MERA のようなループを持たない。
- Tensor Train（TT）：
  - MPS と同等だが、数値線形代数・多次元近似の文脈で使われる呼称。
- MPO / PEPO（Matrix Product Operator / Projected Entangled Pair Operator）：
  - ハミルトニアンや密度行列など「演算子」を TN で表現する拡張。


## 4. テンソルネットワークと DMRG・量子多体系

- DMRG は「1D 強相関電子系」の標準手法であり、
  - その本質が MPS の変分最適化アルゴリズムであることが明らかになっている。
- 代表的な用途：
  - 1D ハバード模型、スピン鎖の基底状態と励起状態
  - 時間発展（TEBD、Time-dependent DMRG）
  - 量子化学（分子系の強相関電子状態）
- 「テンソルネットワーク＝エンタングルメント構造に基づく変分基底」という見方により、
  - これまで DMRG として知られていた手法が、
  - 「TN の一つの実装」として統一的に理解されるようになった。


## 5. 物理以外への応用と最近の展開

- もともとは凝縮系物理・量子情報で発展したが、現在は
  - 大規模最適化・数値解析（テンソル列車分解、QTT など）
  - 機械学習（TN による分類器・生成モデル・量子機械学習との橋渡し）
  - ビッグデータ解析・信号処理
  にも応用が広がっている。
- テンソルネットワークとディープラーニングの対応：
  - 畳み込みネットワークや RNN の一部構造が、TN で解釈できるという研究もあり、
  - ディープネットを TN に変換する試み、あるいは TN でニューラルネットを近似する研究も進んでいる。


## 6. テンソルネットワークのメリットと限界

### 6.1 メリット

- エンタングルメントに基づく「物理的な次元削減」
  - 面積法則に従う基底状態を効率的に表現できる。
- 構造が明示的で解釈しやすい
  - ノードやボンドが物理的自由度・エンタングルメントのチャネルに対応。
- 多くのアルゴリズムが「安定」であり、物理量の精度が良い
  - SVD に基づく逐次最適化（DMRG、TEBDなど）が確立している。

### 6.2 限界

- 高次元・強く絡み合った状態（Volume law entanglement）には不向き
  - ボンド次元が指数的に増え、表現が破綻する。
- 2D 以上では縮約コストが急増
  - PEPS や高次元 TN の縮約は一般に P-hard であり、近似手法に依存。
- ネットワーク構造選びが難しい場合も
  - どの TN 形式（MPS/PEPS/MERA/TTN…）が対象系に適しているかは事前知識を要する。


## 7. 学び始めるための道筋（物理系学生向け）

1. MPS と DMRG から始める
   - 1D スピン鎖（Heisenberg, Ising）を題材に、  
     MPS の表現と DMRG アルゴリズムを理解する。

2. Orús のレビューを読む
   - 「A practical introduction to tensor networks」で  
     MPS, PEPS, MERA の概念と数値手法を俯瞰する。

3. Bridgeman & Chubb の lecture notes
   - 図式表現や、より丁寧な基礎解説を通して  
     「テンソルネットワークの言語」に慣れる。

4. 興味に応じて分岐
   - 2D 格子モデル → PEPS / iPEPS
   - 臨界現象・スケーリング → MERA
   - 量子化学 → MPS/DMRG の量子化学応用
   - 機械学習 → TN による分類器・量子機械学習（TN for QML）


## 8. まとめ

  - 「テンソルネットワークとは何か」
  - 「どのような種類があり、何がうれしいのか」
  を俯瞰的に整理した「入口」として位置づける。
- 個別の詳細（MPS/DMRG の数式展開、PEPS の具体的アルゴリズム、MERA の構成など）は、
  - 別ページ（例：`MPSとDMRG`, `PEPSと2次元格子`, `MERAと臨界系` など）で掘り下げていく想定。
- 物理インフォマティクスの観点からは、
  - DFT/MD/FEM のような「連続場の PDE 解法」と
  - テンソルネットワークのような「エンタングルメントベースの状態表現」
  を組み合わせることで、
  - 強相関電子系・量子スピン系を含む「量子多体系のデータ駆動解析」に展開していくことが一つの方向性になる。
