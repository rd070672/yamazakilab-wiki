# MD計算における原子間ポテンシャル選定

原子間ポテンシャルの選定は、MDで再現できる物理（相・欠陥・拡散・破壊・反応など）と、得られる精度限界をほぼ決める。古典力場は高速で堅牢、機械学習ポテンシャル（MLIP）は高精度化と適用範囲拡張を狙えるが、適用領域の管理が核心となる。

## 参考ドキュメント
1. OpenKIM Getting Started（モデルのテスト情報と選定支援）
   https://openkim.org/doc/overview/getting-started/
2. NIST Interatomic Potentials Repository（ポテンシャル配布と評価の枠組み）
   https://www.ctcms.nist.gov/potentials/
3. J-STAGE：特集「機械学習ポテンシャル」にあたって（日本語PDF）
   https://www.jstage.jst.go.jp/article/mssj/26/1/26_10/_pdf/-char/en


## 1. MDにおけるポテンシャルの役割
MDでは原子 $i$ に働く力を
$$
\mathf F_i(\mathbf r)=-\nabla_{\mathbf r_i} U(\mathbf r_1,\ldots,\mathbf r_N)
$$
として与える。したがって選定対象は、ポテンシャルエネルギー面 $U$ の近似モデルである。

選定で本質となる情報
- 対象系：元素種、相（固相/液相/界面）、結晶構造、欠陥、組成幅
- 対象現象：弾性・格子振動、転位、拡散、相変態、破壊、化学反応、電荷移動
- 対象条件：T, P, ひずみ、外場、照射損傷、高圧、極端な化学ポテンシャル
- 評価量：エネルギー差（meV/atom）、障壁（eV）、応力（GPa）、輸送係数など

## 2. 選定の考え方
### 2.1 要求仕様
例
- 欠陥・拡散を議論したい
  - 空孔形成エネルギー、格子間原子形成エネルギー
  - 拡散障壁（NEB等の参照込み）
  - 拡散係数の温度依存（Arrhenius）
- 転位を議論したい
  - 弾性定数、γ面（積層欠陥エネルギー）、Peierls障壁
- アモルファス・液体を議論したい
  - RDF、配位数、密度（NPT）、融点近傍の熱力学量
- 反応を議論したい
  - 結合生成・切断、電荷再配分、反応経路上のエネルギー

### 2.2 候補モデル
入口
- 公開リポジトリ（テストや系統評価が紐づくものを優先）
- 論文における対象現象の一致（元素と現象が一致していることを最優先）
- モデルの想定する化学（電荷、結合、金属多体性など）が一致していること

### 2.3 推奨条件
推奨（例）
- 0 K：格子定数、弾性定数、熱力学的安定性（相の順序）
- 欠陥：形成エネルギーの符号とオーダー、過度な短距離反発の破綻がないか
- 有限T：NVTで温度が安定するか、NPTで密度が破綻しないか
- 規格外領域：高圧圧縮・引張で非物理的な崩壊が出ないか

## 3. 古典ポテンシャルの系統と選び分け
古典ポテンシャルは、速度・スケールを優先しつつ「特定の化学に対する近似」を採用する。

### 3.1 代表的な形式
|系統|代表例|得意|不得意|典型対象|
|---|---|---|---|---|
|2体（pair）|Lennard-Jones, Buckingham|単純凝集、教育用途|金属結合の多体性、共有結合角度|単純液体、希ガス、モデル系|
|金属多体|EAM/MEAM/ADP|金属、合金、欠陥・転位|結合方向性が本質の共有結合、電荷移動|Fe, Ni, Cu, Al などの金属系|
|結合次数（bond-order）|Tersoff, Brenner/AIREBO|共有結合ネットワーク|金属混合、反応全般の汎用性|C, Si, SiC, BN など|
|反応型（reactive）|ReaxFF, COMB|結合生成/切断、化学反応|相互作用の適用領域管理が難しい|酸化・分解・界面反応|
|電荷・分極を含む|Core-shell, QEq派生|イオン結晶、誘電応答|パラメータ依存が強い|酸化物、ハロゲン化物等|

選定の要点
- 金属の塑性・欠陥なら、まずEAM/MEAM系の候補から入るのが自然である
- 共有結合の角度依存や$sp2/sp3$混在が重要なら、bond-order系の適合が重要である
- 反応を扱うなら、反応型（ReaxFF等）またはドメイン特化MLIPが主要候補となる

### 3.2 古典力場で起きやすい注意点
- 交差相互作用（A-B）を持たない力場を無理に混合すると、界面・合金で破綻しやすい
- カットオフ近傍で力が不連続だと、エネルギー保存や温度が乱れる
- 「融点・蒸発・高圧」など参照データ外条件では、非物理的な相が安定化しうる

## 4. 機械学習ポテンシャル（MLIP）の系統
MLIPは、参照計算（通常DFT）で得たエネルギー $E$、力 $F$、応力 $σ$ などを学習し、$U(r)$を近似する。

### 4.1 MLIPの代表的ファミリー
|系統|代表例|特徴|向く状況|留意点|
|---|---|---|---|---|
|局所記述子＋回帰|GAP(SOAP), SNAP, MTP|比較的解釈しやすい、学習戦略が確立|単一材料・限られた化学空間|参照データ外で外挿しやすい|
|NN（対称性考慮）|Behler–Parrinello型など|古典より高精度で高速|分子・結晶の中規模系|記述子設計とデータが支配的|
|GNN（回転同変）|NequIP, MACE|データ効率が高い傾向|精度要求が高い固体・界面|計算コストと学習難度が上がる場合|
|汎用モデル（事前学習）|M3GNet, CHGNet|広い元素・構造をカバーする設計|初期探索、近似的な構造緩和|目的現象に対し追加検証が必須|

### 4.2 選定の要点：3つの分岐
1) 事前学習モデルを使うか、専用学習するか
- 広い探索：事前学習モデル → 重要候補だけ専用学習へ
- 反応・欠陥障壁・高圧：専用学習（または強い追加検証）を基本とする

2) 学習データが「現象空間」を含むか
- 拡散を見たいなら、拡散途中の局所環境が学習に入っている必要がある
- 相変態を見たいなら、両相と遷移領域（ひずみ・欠陥・核生成近傍）を含める必要がある

3) 外挿を検知できる仕組みがあるか
- 委員会学習（複数モデル）で予測分散を見る
- 記述子空間距離・不確かさ推定を用いて、危険領域を検出する
- 必要に応じてアクティブラーニング（on-the-fly追加DFT）で補強する

### 4.3 速度と精度の見積もり
MLIPは古典より高価であるが、AIMDよりは桁違いに安いことが多い。
- 古典：10^6〜10^9 atom・ns級が狙える領域
- MLIP：10^4〜10^7 atom・ns級（モデル次第）
- AIMD：10^2〜10^3 atom・ps級

このギャップをどこで埋めるかが、ポテンシャル選定の戦略になる。

## 5. 古典 vs MLIP
|目的|まず検討する候補|MLIPを優先する条件|
|---|---|---|
|金属の欠陥・転位|EAM/MEAM|障壁や界面で誤差が支配的、合金化学が複雑|
|共有結合固体の格子欠陥|Tersoff系など|配位変化が多い、欠陥準安定が多様|
|酸化物・イオン伝導|電荷・分極を含む力場|局所電荷・配位の多様性が大きい|
|アモルファス生成|既存力場（妥当性確認）|配位統計・化学短距離秩序の再現が不足|
|界面反応・酸化・分解|ReaxFF/COMB または専用MLIP|反応経路と中間体の再現が最重要|
|高圧相・極限条件|EOSに強い力場|参照データ外に出やすく、外挿管理が必要|

## 6. 検証の設計
古典/MLIPどちらでも、少数の検証で破綻を早期に見つけることが重要である。

### 6.1 構造・弾性（0 K）
- 格子定数 $a$、体積 $V$
- 弾性定数 $C_{ij}$、体積弾性率 $B$
- 代表相の相対安定性（エネルギー順位）

### 6.2 欠陥・界面
- 空孔/格子間/置換欠陥形成エネルギー
- 表面エネルギー、積層欠陥エネルギー（該当する場合）
- 短距離圧縮での過度な崩壊の有無

### 6.3 有限温度
- NPTでの密度と熱膨張の挙動
- RDF $g(r)$、配位数
- MSDからの拡散係数（必要なら）

## 7. 公開リソースの使い方
- モデルの出自（フィット対象、参照データ、適用範囲、既知の破綻モード）を必ず確認する
- リポジトリ付属のテスト結果や物性評価を、選定の入口に使う
- 異なるポテンシャルを比較する場合、同じ評価スイートで比較された情報を優先する

## まとめ
古典力場の選定は「化学（結合様式）と現象（欠陥・反応・相変態）の整合」を最優先するべきであり、MLIPの選定は「学習データが現象空間を含むこと」と「外挿を検知・抑制できること」が核心である。公開リポジトリのテスト情報を起点に候補を絞り、構造・欠陥・有限温度の少数の検証セットで合否を判定する設計が、信頼できるMD解析へ直接つながる。
 
