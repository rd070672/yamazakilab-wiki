# MD 計算における古典的・機械学習ポテンシャルの選定
作成日：2025年11月23日

## 概要
- 分子動力学（MD）計算では、原子間相互作用を記述する**ポテンシャル（力場）**の選び方が、結果の信頼性と計算コストを大きく左右する。
- 大きく分けて
  - 経験的・古典的ポテンシャル（LJ, EAM, MEAM, Tersoff, ReaxFF など）
  - 機械学習（ML）ポテンシャル（GAP, SNAP, MTP, NNP, M3GNet など）
  があり、系・目的・計算資源に応じて適切に選定する必要がある。
- 本メモでは、**「どのような観点で古典的／ML ポテンシャルを選ぶか」**を整理する。

## 古典的ポテンシャルの特徴と代表例
- 特徴
  - パラメータが**物理的・化学的なモデルに基づいて決まっている**（経験的フィットも含む）。
  - 計算コストが低く、大規模・長時間の MD に向く。
  - 一方で、**適用範囲（元素組成・構造・温度・圧力など）が限定的**になりやすい。
- 代表的なタイプ
  - 二体・多体ポテンシャル
    - Lennard-Jones（LJ）：希ガス、単純液体のモデルなど。
    - Morse ポテンシャル：結合の引張など、簡易モデル。
  - 金属系ポテンシャル
    - EAM（Embedded Atom Method）：fcc/bcc 金属、多くの金属合金。
    - MEAM / ADP など：角度依存性や多体性を強化。
  - 共有結合系
    - Tersoff / Stillinger–Weber：Si, Ge, C 系半導体・共有結合物質。
    - COMB, ReaxFF：電荷・反応を含むより汎用的な反応ポテンシャル。
  - 高分子・有機・バイオ
    - CHARMM, AMBER, OPLS, GROMOS などのタンパク質・有機分子用力場。

## 機械学習ポテンシャルの特徴と代表例
- 特徴
  - DFT などの**高精度第一原理データを教師データとして学習**し、  
    同等レベルの精度を、古典ポテンシャルに近いコストで再現することを目指す。
  - 汎化性・転移性は、**訓練データの範囲と質**に大きく依存する。
- 代表的な枠組み
  - カーネル系
    - GAP（Gaussian Approximation Potential）
    - SOAP 記述子＋ガウス過程回帰など。
  - 線形モデル＋特徴量
    - SNAP（Spectral Neighbor Analysis Potential）
    - MTP（Moment Tensor Potential）など。
  - ニューラルネットワーク系
    - Behler–Parrinello 型 NNP
    - DeepMD / DeePMD, NequIP, MACE などのグラフニューラルネットワーク系。
    - M3GNet のような結晶・材料特化 GNN。
- 利点・欠点のイメージ
  - 利点：  
    - 適切に訓練すれば、DFT に近い精度で大規模 MD が可能。
    - 多成分系・複雑な結合・相変態などにも柔軟に対応しやすい。
  - 欠点：
    - 訓練データの作成・学習が必要（第一原理計算のコスト）。
    - 訓練範囲外（未知の状態・組成）での振る舞いが読みにくい。

## ポテンシャル選定の基本的な観点
- 研究目的・対象物質
  - 構造材料（金属、合金、セラミックス）か、有機・高分子か、電極・固体電解質系か、など。
  - 何を再現したいか：格子定数・弾性定数・相安定性・融点・拡散係数・欠陥エネルギー・表面エネルギーなど。
- 精度 vs 計算コスト
  - 粗視化的傾向把握（大きい系・長時間）→ 古典的ポテンシャルが有利。
  - 相変態・欠陥構造・局所化した化学反応など → ML ポテンシャルが有利になる場合が多い。
- 利用可能な既存ポテンシャル
  - LAMMPS や OpenKIM、各ポテンシャルリポジトリに登録された  
    「系に合った既存パラメータ」があるかを確認する。
  - 既存ポテンシャルの**適用範囲・検証済みプロパティ**（文献）をよく読む。
- データ・開発コスト
  - ML ポテンシャルを新規に作る場合、
    - DFT での学習データ作成
    - ハイパーパラメータチューニング
    - 検証・ベンチマーク
    に相応の工数が必要。
- 実装・ソフトウェア互換性
  - 使用する MD コード（LAMMPS, Gromacs, CP2K, ASE＋バックエンド など）で、
    - 力場形式に対応しているか
    - ML ポテンシャル対応インターフェースがあるか
  を確認する。

## 古典的ポテンシャル選定の実務的な流れ
- 1. 対象系・物性の整理
  - 例：Fe–Co–B アモルファスの構造緩和・拡散 → 金属系＋短距離多体 + 温度依存。
- 2. 候補ポテンシャルのリストアップ
  - 文献調査＋ポテンシャルデータベース（OpenKIM, LAMMPS 公式ドキュメントなど）。
- 3. ベンチマーク
  - 小さなセルで、基本物性（格子定数、弾性定数、融点、拡散など）を計算し、  
    実験・DFT と比較して妥当かを確認。
- 4. 適用範囲の確認
  - 相変態・欠陥濃度・高温状態など、想定する条件が「パラメータ化された範囲内」にあるか。
- 5. 必要ならパラメータフィット
  - どうしても既存ポテンシャルが合わない場合、  
    一部パラメータを再フィットすることもあるが、**安易な再調整は危険**なので注意。

## 機械学習ポテンシャル選定・開発の流れ
- 1. 用途と必要精度の定義
  - 例：アモルファス Fe–B のメルトクエンチ＋短時間の構造緩和（局所構造・配位数を DFT 並みに再現したい）。
- 2. モデル枠組みの選択
  - 対象・手持ちツールに応じて、GAP, SNAP, MTP, DeepMD, NequIP, M3GNet などから選ぶ。
  - 既に「同系・近縁物質」で成功例がある枠組みを優先すると良い。
- 3. 訓練データの設計
  - DFT で計算する構造サンプルの設計：
    - 結晶・アモルファス・欠陥・高温構造・歪み・体積変化など。
  - ポテンシャルが再現すべき状態空間を十分にカバーするようにする。
- 4. 学習と検証
  - データを訓練・検証・テストに分け、
    - エネルギー・力・応力の誤差
    - 物性値（格子定数・弾性定数・拡散係数など）の誤差
    を評価。
- 5. 実運用前のテスト MD
  - 小さいセルでメルト／クエンチ・欠陥形成などを試し、
    - 不安定な発散や非物理的挙動（相崩壊・エネルギー暴走など）がないか確認。
- 6. 本番計算へ展開
  - 問題なければ、より大きいセル・長時間スケールへ展開。

## 典型的なケースごとの選び方の目安
- 金属バルク・粒界拡散・転位運動
  - 既存 EAM/MEAM が豊富 → まずは既存ポテンシャルから。
  - 特殊合金・アモルファスで既存が不十分 → ML ポテンシャルの検討。
- イオン伝導・電極–電解質界面
  - 古典力場（Buckingham + Coulomb 等）＋電荷モデル
  - 反応・分解・還元まで扱う → ReaxFF や ML ポテンシャル。
- 有機・ポリマー・バイオ
  - 既存高分子力場（OPLS, AMBER, CHARMM 等）が整備されている場合が多い。
  - 特殊反応・分解を扱う際には ReaxFF, ML-PES を検討。
- 相変態・複雑な局所構造
  - 古典ポテンシャルで相図が大きくズレる場合、ML ポテンシャルの優位性が高い。

## まとめ
- 古典的ポテンシャルと ML ポテンシャルは、「どちらが常に優れている」というものではなく、
  - 系・目的・必要精度・計算資源・開発コスト
  を総合的に見て選ぶ必要がある。
- まずは
  - 「既存の古典ポテンシャルで十分か？」
  - 「どの物性・状態がボトルネックか？」
  を整理し、それでも不足する部分が明確なら ML ポテンシャルの導入を検討する、という段階的アプローチが現実的である。

