# グリーン関数とKKR法

グリーン関数は、ハミルトニアンの逆演算子として状態密度や応答関数を直接与える“観測量に近い表現”である。KKR法はこのグリーン関数を多重散乱の言葉で構成し、周期系に加えて不純物・表面・合金のような並進対称性が崩れる問題を同一の枠組みで扱う方法である。

## 参考ドキュメント
- H. Ebert, D. Ködderitzsch, J. Minár, Calculating condensed matter properties using the KKR-Green's function method: recent developments and applications, Reports on Progress in Physics (2011)
  https://ui.adsabs.harvard.edu/abs/2011RPPh...74i6501E/abstract
- P. Mavropoulos, N. Papanikolaou, The Korringa-Kohn-Rostoker (KKR) Green Function Method I: Electronic Structure of Periodic Systems (Forschungszentrum Jülich lecture notes, 2014)
  https://juser.fz-juelich.de/record/50027/files/FZJ-2014-02214.pdf
- KKR-Green関数法によるバンド計算（AkaiKKR関連資料，日本語）
  https://kkr.issp.u-tokyo.ac.jp/jp/document/akaikkr_j.pdf

## 1. グリーン関数
### 1.1 定義
1粒子（有効1電子）ハミルトニアン $H$ に対し、複素エネルギー $z$ を用いて
$$
G(z)=(z-H)^{-1}
$$
をグリーン関数（レゾルベント）と呼ぶ。実空間表示では
$$
G(\mathbf{r},\mathbf{r}';z)=\langle \mathbf{r}|(z-H)^{-1}|\mathbf{r}'\rangle
$$
である。

固体電子構造では、実軸上の極限
$$
G^{\mathrm{R}}(E)=\lim_{\eta\to 0^+}(E+i\eta-H)^{-1}
$$
（retarded）を用いることが多い。

### 1.2 状態密度（DOS）との関係
グリーン関数の虚部はスペクトル密度を与える。全状態密度は
$$
n(E)=-\frac{1}{\pi}\,\mathrm{Im}\,\mathrm{Tr}\,G^{\mathrm{R}}(E)
$$
局所状態密度（LDOS）は
$$
n(\mathbf{r},E)=-\frac{1}{\pi}\,\mathrm{Im}\,G^{\mathrm{R}}(\mathbf{r},\mathbf{r};E)
$$
である。すなわち、波動関数を明示的に並べなくても、$G$ が得られればDOSや電子密度に直結する。

### 1.3 Dyson方程式
$H=H_0+V$ と分けると
$$
G = G_0 + G_0 V G
$$
が成り立つ（Dyson方程式）。この形は、不純物・界面・クラスターを“母体（$G_0$）+ 摂動（$V$）”として扱う際の基本構文である。

## 2. 多重散乱としての電子構造
KKR（Korringa–Kohn–Rostoker）法は、結晶中の電子を「原子（サイト）での散乱」と「サイト間の伝播」に分け、全散乱を幾何級数として足し上げる多重散乱理論（multiple scattering theory, MST）に基づく方法である。

### 2.1 1サイト散乱：t行列
まず各サイト $i$ の近傍で、（しばしば球面調和関数展開した）局所ポテンシャルのもとで単一サイト問題を解き、部分波ごとの散乱情報を t行列 $t_i(E)$（または位相シフト $\delta_\ell(E)$）として得る。

直感：
- その原子が電子をどう散乱させるかを、角運動量 $\ell,m$ 空間の小さな自由度に押し込める
- その代わり、サイト間の“伝播”を別に正確に足す

### 2.2 サイト間伝播：構造定数
サイト $i\to j$ への伝播は、自由空間グリーン関数 $G^0$ を基にした“幾何学だけで決まる”量（構造定数、structure constants）として現れる。周期系では $\mathbf{k}$ を持つ $G^0(\mathbf{k},E)$（Ewald和などで評価）になる。

### 2.3 散乱経路演算子
多重散乱の足し上げは、典型的に
$$
\tau(E)=\left[t^{-1}(E)-G^0(E)\right]^{-1}
$$
または周期系で
$$
\tau(\mathbf{k},E)=\left[t^{-1}(E)-G^0(\mathbf{k},E)\right]^{-1}
$$
の形に集約される。$\tau$ は「サイト間で何回散乱して戻ってくるか」を全て含んだ量である。

### 2.4 KKR方程式
周期系のバンドは、同次方程式の非自明解条件として
$$
\det\!\left[t^{-1}(E)-G^0(\mathbf{k},E)\right]=0
$$
で与えられる。波動関数ベースのバンド法と同様の情報（$E(\mathbf{k})$）が、散乱の行列式として現れるのがKKRの特徴である。

## 3. KKRグリーン関数法（KKR-GF）
KKRはもともとバンド方程式として導かれたが、グリーン関数法として書き直すと用途が大きく広がる。1粒子グリーン関数は、概略として
- 1サイトの局所解（原子球内）
- サイト間の多重散乱（$\tau$）
を組み合わせて構成できる。

この“Gが主役”の形式が強い理由：
- 不純物・空孔・局所構造変化：並進対称性が壊れてもDyson方程式で扱える
- 表面・界面・埋め込みクラスター：母体Gの上に局所領域を“貼り付ける”実装が自然
- 合金・不規則系：配置平均をG（やT行列）で組むCPAと相性が良い
- 応答関数：交換相互作用、磁化率、輸送（久保式）などがGの積で表れる

## 4. 合金・不規則系：KKR-CPA
置換合金 $A_{1-c}B_c$ のように、サイトごとにポテンシャルが揺らぐ問題では、コヒーレントポテンシャル近似（CPA）がよく用いられる。考え方は
- 実際の不規則系を、“有効媒質（coherent medium）”で置き換える
- その媒質中にA原子やB原子を埋め込んだときの追加散乱が、配置平均で消えるように媒質を自己無撞着に決める
というものである。

散乱の言葉で書けるため、KKR（MST）と結合すると KKR-CPA となり、合金の平均DOS、フェルミ面のぼけ、寿命効果などを扱いやすい。

拡張として、磁気モーメントの向きの乱れを平均化するDLM（disordered local moment）近似を組み合わせると、常磁性状態の記述にも繋がる。

## 5. DFT（Kohn–Sham）と自己無撞着ループ
KKRは電子密度から有効ポテンシャルを作り直す自己無撞着計算（SCF）に組み込める。概念的には
1. 初期ポテンシャル $V_{\mathrm{eff}}(\mathbf{r})$ を与える
2. そのもとで $G(E)$（またはDOS）を計算する
3. 電子密度 $n(\mathbf{r})$ を $G$ から得る
4. $V_{\mathrm{eff}}[n]$ を更新する
を収束まで繰り返す。

相対論効果（スピン軌道相互作用）をDirac方程式ベースで扱うSPR-KKRのような実装も確立している。

## 6. 何が得意か・何が難しいか
| 項目 | KKR-GFでの取り扱い | 典型的に出る量 |
|---|---|---|
| 周期結晶 | 標準（バンド条件、複素エネルギー積分） | DOS、バンド、電荷・スピン密度 |
| 不純物・欠陥 | Dyson方程式・埋め込みで自然 | 形成された共鳴、局在準位、周辺の電荷再分配 |
| 表面・界面・クラスター | 半無限母体G + 局所領域 | 表面状態、界面磁性、埋め込み準位 |
| 置換合金・組成ゆらぎ | CPAと親和性が高い | 平均DOS、寿命（線幅）、抵抗など |
| 応答・輸送・分光 | Gの積で表せる量が多い | 久保応答、磁気相互作用、吸収・磁気光学など |

難しさ（代表例）：
- 構造定数の評価（Ewald和など）やエネルギー積分の数値安定性
- 角運動量カットオフ $\ell_{\max}$ の収束（特に遷移金属・重元素）
- ポテンシャル近似（muffin-tin/ASA、full-potential）の選択と計算コスト

## 7. 国内外の実装例
- AkaiKKR：KKR-CPAを中核に、不規則系・合金・磁性の実用計算に強い系譜を持つ
- SPR-KKR（Munich）：相対論的KKR-GFに基づき、多様な磁性・分光・輸送に展開されている
- JuKKR（Jülich）：full-potentialを含むKKR-GF系として拡張が進み、大規模系（ナノ・欠陥）にも展開がある

## まとめ
- グリーン関数は $G=(z-H)^{-1}$ として定義され、虚部がDOSを与えるため、観測量へ直結する表現である。
- KKR法は電子の運動を多重散乱として分解し、1サイト散乱（t行列）とサイト間伝播（構造定数）から全系を組み上げる方法である。
- KKRをグリーン関数形式で用いると、不純物・表面・合金（CPA）・応答関数など、並進対称性が崩れる問題に特に強い枠組みとなる。

