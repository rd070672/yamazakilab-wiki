# 量子電子動力学（QED）法の原理と活用

量子電子動力学法とは、外場（電場・光・磁場など）で駆動される電子状態の時間発展を、第一原理に基づいて直接追跡する計算枠組みである。線形応答から強励起・超短パルス下の非線形応答まで、非平衡電子ダイナミクスを同一の方程式系で扱える点が特徴である。

## 10. 参考ドキュメント
1) SALMON: Scalable Ab-initio Light-Matter simulator for Optics and Nanoscience（公式サイト・概要）  
https://salmon-tddft.jp/about.html
2) 先端の光科学に役立つ第一原理計算ソフトウェアSALMONの開発（国内記事）  
https://www.qst.go.jp/site/kansai-topics/20469.html
3) N. Watanabe, M. Tsukada, Fast and stable method for simulating quantum electron dynamics（手法論の基礎）  
https://arxiv.org/abs/physics/0011068

## 1. 用語と射程
量子電子動力学（Quantum Electron Dynamics; QED と略されることがある）は、量子電磁力学（Quantum Electrodynamics）とは別概念として使われる場合がある。ここでは、時間依存Kohn–Sham方程式（実時間TDDFT）を中核として電子の時間発展を数値計算する手法群を指す。

対象は大きく2系統に分かれる。
1) 孤立系（分子・ナノクラスター・欠陥を含む有限系）：境界反射を抑える工夫が重要である。  
2) 周期系（結晶・表面・界面）：ゲージ選択、電場印加法、ブリルアンゾーン積分が重要である。

## 2. 基礎方程式：時間依存Kohn–Sham（TDKS）
多電子系の時間発展を電子密度で表すTDDFTに基づき、単一粒子軌道の時間発展を解く。

### 2.1 時間依存Kohn–Sham方程式
代表的には次式である。
$$
i\hbar \frac{\partial}{\partial t}\psi_{n}(\mathbf{r},t)
=
\hat{H}_{\mathrm{KS}}[n](t)\,\psi_{n}(\mathbf{r},t)
$$

Kohn–Shamハミルトニアンは
$$
\hat{H}_{\mathrm{KS}}[n](t)=
\frac{1}{2m}\left(-i\hbar\nabla + \frac{e}{c}\mathbf{A}(t)\right)^2
+ V_{\mathrm{ion}}(\mathbf{r})
+ V_{\mathrm{H}}[n](\mathbf{r},t)
+ V_{\mathrm{xc}}[n](\mathbf{r},t)
$$
で与えることが多い（周期系ではベクトルポテンシャル $\mathbf{A}(t)$ を用いる速度ゲージが扱いやすい）。

電子密度は
$$
n(\mathbf{r},t)=\sum_{n}^{\mathrm{occ}} |\psi_{n}(\mathbf{r},t)|^2
$$
で与え、$V_{\mathrm{H}}$ と $V_{\mathrm{xc}}$ はこの密度に依存して時間的に自己無撞着に変化する。

### 2.2 外場の入れ方
外場は、目的に応じて次のように定義することが多い。

- 弱い衝撃場（デルタキック）：線形応答を実時間で得るための典型手段である。  
- パルス電場（超短パルス、強励起）：非線形光学応答、キャリア励起、光損傷過程などを記述する。  
- 直流／交流電場：電流応答や分極応答、分子回路・ナノ接合の高速スイッチング挙動などのモデル化に用いる。

## 3. 数値表現：実空間・実時間の思想
量子電子動力学法は「時間発展演算子のユニタリ性（ノルム保存）」を保つ設計が要となる。典型的には、以下のいずれかで空間離散化を行う。

- 実空間グリッド（有限差分）：局在した密度や電流の可視化、ナノ構造・界面に直観的である。  
- 平面波基底：周期系に相性がよい。実時間伝播でも使えるが、強励起ではカットオフや時間刻みとコストの関係が効いてくる。  
- 混合型：実空間に平面波的展開を併用する、あるいは領域分割する実装もある。

境界条件は、孤立境界・1D周期・2D周期・3D周期などを系に合わせて選ぶ。

## 4. 時間発展アルゴリズム：安定性とユニタリ性
形式解は時間順序積 $\mathcal{T}$ を含む。
$$
\psi(t+\Delta t)=\hat{U}(t+\Delta t,t)\psi(t),\quad
\hat{U}=\mathcal{T}\exp\left[-\frac{i}{\hbar}\int_{t}^{t+\Delta t}\hat{H}(t')dt'\right]
$$

数値計算では、$\Delta t$ がアト秒〜数アト秒相当になるため、安定性・誤差制御・並列化が本質的となる。

### 4.1 Cayley形（Crank–Nicolson型）によるユニタリ時間発展
時間依存が弱い微小区間で $\hat{H}$ を近似すると、
$$
\left(1+\frac{i\Delta t}{2\hbar}\hat{H}\right)\psi^{t+\Delta t}
=
\left(1-\frac{i\Delta t}{2\hbar}\hat{H}\right)\psi^{t}
$$
となり、解のノルム保存に優れる。

### 4.2 分割演算子（Suzuki–Trotter）と実空間実時間法
運動項とポテンシャル項を分割し、
$$
e^{-i\hat{H}\Delta t/\hbar}\approx
e^{-i\hat{T}\Delta t/2\hbar}\,e^{-i\hat{V}\Delta t/\hbar}\,e^{-i\hat{T}\Delta t/2\hbar}
$$
のように近似する手法がある。実空間格子と組み合わせると、大規模並列に適合しやすい。

## 5. 物理量の取り出し
時間発展から得られる代表的な観測量は以下である。

### 5.1 密度・電流・エネルギー
- 電子密度 $n(\mathbf{r},t)$：局所的な電荷移動や励起分布の追跡に使う。  
- 電流密度 $\mathbf{j}(\mathbf{r},t)$：導電応答、光電流、局所電流経路の解析に使う。  
- 励起エネルギー：外場から電子へ移ったエネルギー、光吸収や損傷閾値の議論に使う。

### 5.2 線形応答（誘電関数・吸収スペクトル）
デルタキック等の弱摂動で分極 $P(t)$ や電流 $J(t)$ を得てフーリエ変換すれば、周波数依存応答が得られる。
例として導電率は
$$
\sigma(\omega)=\frac{J(\omega)}{E(\omega)}
$$
誘電関数は単純化すれば
$$
\varepsilon(\omega)=1+\frac{4\pi i}{\omega}\sigma(\omega)
$$
の形で評価できる（実装により定義は異なる）。

### 5.3 非線形応答（強レーザー場）
- 高次高調波発生（HHG）に関係する電流の高周波成分  
- 励起キャリア密度・電子温度に相当する量（定義に注意が必要）  
- ナノ光学（近接場）における局所応答の強い非線形性

## 6. Maxwell方程式との結合：光の伝搬を同時に扱う
単一の有限系・周期系の電子応答だけでなく、空間伝搬する電磁場と電子系を同時に解く枠組みもある。電磁場をFDTDで解き、電子系をTDKSで解くことで、メタ表面や薄膜での光伝搬・エネルギー移送を自己無撞着に扱う。

概念的には、Maxwell方程式の電流源として電子系の $\mathbf{j}(\mathbf{r},t)$ が入り、電子系は $\mathbf{E}(\mathbf{r},t),\mathbf{A}(\mathbf{r},t)$ により駆動される相互作用系となる。

## 7. 関連手法との位置づけ
電子の時間発展を扱う手法は複数ある。使い分けの軸を表に整理する。

| 枠組み | 主方程式 | 得意領域 | 代表的な注意点 |
| --- | --- | --- | --- |
| 量子電子動力学法（実時間TDDFT） | TDKS | 光励起・非平衡電子・電流・局所応答 | 交換相関汎関数の近似、時間刻み、励起の表現限界 |
| 線形応答TDDFT（Casida等） | 固有値問題 | 励起スペクトル（分子）、弱場応答 | 大規模周期系・強励起には不向きな場合が多い |
| BSE（GW+BSE） | 2体方程式 | 励起子・光学ギャップ | 計算コストが高い、前処理が重い |
| 第一原理AIMD | Born–Oppenheimer + 古典核運動 | 構造・熱・拡散 | 電子の非断熱励起は原理的に含まれない（拡張が必要） |
| Ehrenfest（電子＋核の同時時間発展） | TDKS + 古典核 | 非断熱の粗い記述 | デコヒーレンスや分岐の扱いが難しい |

## 8. 近似と限界
1) 交換相関汎関数の時間依存性  
多くの実装は断熱近似（過去履歴を無視）を用いる。電荷移動励起、強い励起子効果、二重励起などは苦手になりやすい。

2) コア準位・強相関  
擬ポテンシャルでは内殻の直接記述は行わないことが多い。コア励起や強相関は別手法（全電子・多体補正など）との役割分担が必要となる。

3) スケールと時間刻み  
電子運動の時間スケールは極めて短く、必要ステップ数が膨大になりやすい。並列化の設計（空間分割、軌道分割、k点分割）が性能を支配する。

## 9. 計算フロー
1) 初期構造（原子配置）を与える  
2) 基底状態DFTで初期Kohn–Sham軌道を得る  
3) 外場（デルタキックまたはパルス場）を設定する  
4) TDKSを $\Delta t$ 刻みで時間発展させる（自己無撞着に $V_{\mathrm{H}},V_{\mathrm{xc}}$ を更新する）  
5) $n(\mathbf{r},t), \mathbf{j}(\mathbf{r},t), P(t), E(t)$ 等を保存・解析する  
6) 必要ならフーリエ変換し、$\varepsilon(\omega)$ や吸収スペクトル、非線形指標を得る

## まとめ
量子電子動力学法は、時間依存Kohn–Sham方程式を実時間で解くことにより、電子密度・電流・分極の非平衡時間発展を第一原理で追跡する計算枠組みである。線形応答から強励起非線形領域まで連続的に扱える一方、交換相関近似・時間刻み・スケールの制約が支配的であり、目的物性に応じた近似と手法選択が重要となる。
