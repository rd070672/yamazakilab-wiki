---
title: About
---

# 第一原理分子動力学 (AIMD) の原理
作成日：2025年11月23日

## 概要
- 第一原理分子動力学（Ab Initio Molecular Dynamics, AIMD）は、  
  「**電子状態を第一原理（主に DFT）で毎ステップ解きながら、原子核の運動を追跡する MD**」。
- 古典 MD との違い：
  - 古典 MD：経験ポテンシャル（EAM, LJ, MEAM, ReaxFF など）から力を計算。
  - AIMD：電子構造計算（DFT など）からポテンシャルエネルギーと力を直接計算。
- 結晶・液体・アモルファス・溶融状態・界面など、多様な系の構造・ダイナミクスを高精度に扱えるが、計算コストが非常に高い。

## 基本方程式
- 扱う自由度：
  - 原子核（イオン）の座標 $\{\mathbf{R}_I\}$ と速度 $\{\mathbf{V}_I\}$。
  - 電子は量子力学的に扱い、波動関数 $\{\psi_n\}$ を DFT などで求める。
- 原子核の運動方程式（古典力学）：
  - $ M_I \dfrac{d^2\mathbf{R}_I}{dt^2} = \mathbf{F}_I = -\dfrac{\partial E_{\text{BO}}(\{\mathbf{R}_J\})}{\partial \mathbf{R}_I} $
  - $E_{\text{BO}}$：与えられた原子配置での電子の基底状態エネルギー（Born–Oppenheimer エネルギー面）。
- 電子部分：
  - 各ステップで DFT の Kohn–Sham 方程式を解き、基底状態エネルギーと力を得る。
  - 力は Hellmann–Feynman 力（＋必要なら Pulay 力）として計算される。

## Born–Oppenheimer MD (BOMD)
- 最もよく使われる第一原理 MD の枠組み。
- 前提：**Born–Oppenheimer 近似**
  - 電子質量 ≪ 原子核質量のため、電子は「瞬時に」基底状態に追従するとみなす。
- 1 ステップの流れ：
  - (1) 原子配置 $\{\mathbf{R}_I\}$ を固定して DFT SCF を収束させ、基底状態エネルギー $E_{\text{BO}}$ と力 $\{\mathbf{F}_I\}$ を得る。
  - (2) その力を用いて、時間積分（Verlet など）により原子核の位置と速度を更新。
  - (3) 更新された配置で再び電子構造を解く。
- 特徴：
  - 各ステップで電子構造が十分収束していれば、ポテンシャルエネルギー面に正確に沿った運動が得られる。
  - 1 ステップごとに SCF 収束が必要なため、**計算コストが高い**。

## Car–Parrinello MD（補足）
- もう一つの代表的 AIMD 手法（Car–Parrinello 法）。
- 電子の波動関数にも「擬似的な質量」を与え、原子核と電子を同時に時間積分する枠組み。
- 特徴：
  - 逐一「完全収束 SCF」を行わずに擬似的なダイナミクスで電子を基底状態近傍に保つ。
  - 実装があるコード（CPMD, Quantum ESPRESSO の一部など）では BOMD より効率的な場合もある。
- ただし、電子の擬似質量やタイムステップの選び方が難しく、近年は「高速な SCF ＋ BOMD」が主流になりつつある。

## ポテンシャルエネルギー面と DFT
- AIMD の「ポテンシャル」は、ほぼ常に DFT によって評価される：
  - 交換相関汎関数（LDA, GGA, meta-GGA, ハイブリッドなど）に依存。
  - PAW/擬ポテンシャル or 全電子(APW＋lo) の選択で精度・コストが変化。
- 長所：
  - 経験パラメータに依存せず、未知材料・高圧・非平衡状態でも「ある程度信頼できる」ポテンシャルを提供。
- 短所：
  - DFT の近似（バンドギャップ問題、vdW 相互作用など）の限界はそのまま AIMD に反映される。

## 温度・アンサンブル制御
- NVE（エネルギー一定）：
  - 熱浴や圧力制御なしの「純粋なハミルトンダイナミクス」。
  - BOMD では、SCF 収束が悪いと「偽の加熱／冷却」が起こるため注意。
- NVT（温度一定）：
  - Nosé–Hoover 連鎖や Langevin 熱浴などを導入して温度を制御。
  - メルト・クエンチや液体状態の平衡化に多用される。
- NPT（圧力一定）：
  - パラメータ付きのバーソスタ（Parrinello–Rahman など）を用いて格子体積を変化させ、目標圧力に合わせる。
  - VASP など一部コードでは “NPT 風” の制御が実装されているが、DFT+NPT は数値的に不安定になることもあり、設定に注意が必要。

## 時間ステップとシミュレーション時間
- タイムステップ（時間刻み）：
  - 典型値：0.5–2.0 fs 程度。  
  - 水素を含む系や高温では、振動周期が短いため小さめ（~0.5–1.0 fs）が無難。
- シミュレーション全時間：
  - DFT ベースでは **数十 ps 程度**が現実的な上限になることが多い。
  - そのため、ガラス形成・拡散・相変態など「長時間現象」は十分に再現できないこともあり、解釈に注意が必要。

## アモルファス・液体系への応用（原理的な見方）
- メルト＝クエンチ法：
  - 高温の液体状態で原子拡散が十分に進むと、「初期構造の記憶」が失われる → 乱れた配置が得られる。
  - そこから急冷すると、原子はエネルギー的に局所安定な「非晶質（アモルファス）」配置にトラップされる。
- AIMD での意味付け：
  - DFT によるポテンシャルエネルギー面上で、原子核が「高温で広く探索 → 急冷で局所谷に落ちる」プロセスを直接追跡している。
  - その結果として得られるアモルファス構造は、**ポテンシャルエネルギー面の局所最小の一つ**として理解できる。
- 注意：
  - 実験に比べて冷却速度が極端に速い（10¹²–10¹⁴ K/s 相当など）ため、「得られた構造が実験アモルファスとどこまで一致しているか」は、RDF・配位数・密度などで慎重にチェックが必要。

## 第一原理 MD の利点と限界
- 利点：
  - 電子構造・化学結合の変化（電荷移動・配位変化・スピン状態など）を自然に含んだダイナミクス。
  - 反応・相変態・アモルファス化・拡散・融解など、「ポテンシャルがよく分からない系」の挙動を直接追える。
- 限界：
  - 系のサイズ（〜10² 原子）と時間スケール（〜10¹–10² ps）が厳しく制限される。
  - DFT の近似・スピン状態・U パラメータ（DFT+U）などに依存し、結果が汎関数選択に左右される。
  - 統計的なサンプリングが十分でないことが多く、「代表性」の評価が重要。

