# CALPHAD法（計算熱力学）による状態図・相平衡予測

CALPHAD法は、各相のギブスエネルギーを温度・圧力・組成の関数としてモデル化し、全ギブスエネルギー最小化によって相平衡を計算する枠組みである。実験データと第一原理計算を統合し、多元系の状態図・化学ポテンシャル・駆動力を一貫して扱えることが強みである。

## 参考ドキュメント
1. Thermo-Calc, CALPHAD Methodology
   https://thermocalc.com/about-us/methodology/the-calphad-methodology/
2. R. Otis and others, CALPHAD-based Computational Thermodynamics in Python (pycalphad), Journal of Open Research Software 5, 2017
   https://openresearchsoftware.metajnl.com/articles/jors.140
3. 小野寺秀博, 計算材料科学の進展と展望, 鉄と鋼 100(10), 1207-1214 (2014)
   https://www.jstage.jst.go.jp/article/tetsutohagane/100/10/100_1207/_html/-char/ja

## 1. 相平衡はギブスエネルギー最小化で決まる
相集合 $Φ$ の下で、全系のギブスエネルギーを
$$
G_\mathrm{tot}(T,P,\{n\})=\sum_{\phi\in\Phi} n^\phi\, G_m^\phi(T,P,\mathbf x^\phi)
$$
と書く（$n^\phi$は相$\phi$のモル数、$G_m^\phi$は相$\phi$のモルギブスエネルギー、$\mathbf x^\phi$は相内組成ベクトル）。

制約条件は物質収支である。
$$
\sum_{\phi} n^\phi x_i^\phi = N_i \quad (i=1,\dots,C)
$$
ここで$C$は成分数、$N_i$は系全体の成分$i$の総モル数である。

平衡状態とは、これら制約の下で$G_\mathrm{tot}$を最小にする相分率と相内組成の組である。化学ポテンシャルは
$$
\mu_i = \left(\frac{\partial G_\mathrm{tot}}{\partial N_i}\right)_{T,P,N_{j\neq i}}
$$
で定義され、相境界やタイライン、反応の駆動力計算に直結する。

## 2. 「相の自由エネルギー」モデルの作り方

### 2.1 一般形：基準項＋理想混合＋過剰項
置換型固溶体での典型的な分解は次である。
$$
G_m^\phi(T,P,\mathbf x)=\sum_i x_i G_i^{\phi,0}(T,P) + RT\sum_i x_i\ln x_i + G_\mathrm{ex}^\phi(T,\mathbf x) + G_\mathrm{add}^\phi
$$
- 第1項：純物質（あるいは基準状態）からの寄与
- 第2項：理想混合エントロピー
- 第3項：非理想性（相互作用）を表す過剰ギブスエネルギー
- 第4項：磁気、秩序化、体積（圧力）などの追加寄与

過剰項はRedlich–Kister多項式で表すことが多い（二元系）：
$$
G_\mathrm{ex}=x_A x_B \sum_{k=0}^{K} L_{AB}^{(k)}(T)\,(x_A-x_B)^k
$$
$L_{AB}^{(k)}(T)$は評価（assessment）で決める温度依存パラメータである。

### 2.2 構造を明示する：副格子モデルとCEF
金属間化合物、秩序相、侵入型固溶体（C, N, Hなど）を扱うには、副格子（sublattice）表現が有効である。例えば二副格子相$\phi=(A,B)_p(C,D)_q$のようにサイトを分け、サイト分率$y$で記述する。

Compound Energy Formalism（CEF）では、エンドメンバー（仮想化学種の組）に基づいて自由エネルギーを組み立て、秩序・欠陥・侵入原子を一つの形式で扱うことができる。多元系の拡張性を優先するのがCALPHADの設計思想である。

### 2.3 磁性寄与
Fe基などでは磁気転移が相安定や比熱に効くため、磁気自由エネルギー項$G_\mathrm{mag}$を導入することがある。実務上はCurie温度や磁気エントロピーのパラメータ化を通じて評価される。

## 3. データベース（TDB）
CALPHADは「相」を基本単位として、純物質→二元→三元…の情報を整備し、外挿則（モデルの一貫性）で高次系へ拡張する。

- 熱力学データベース：各相の$G_m^\phi$のパラメータ群
- 付随データベース：原子移動度（拡散）、熱伝導、弾性などに拡張される場合がある

多元系での予測精度は、(i) 参照する二元・三元の評価品質、(ii) 目的相がデータベースに含まれているか、(iii) 相モデル（副格子設定）が物理実体を外していないか、に強く依存する。

## 4. 熱力学評価
CALPHADの品質は熱力学評価に依存する。その手順は次である。

1) 対象系の相リスト確定（安定相・準安定相を含む）
2) 入力データ収集（熱分析、活量、溶解度限、相境界、比熱、エンタルピー等）
3) 相モデル選択（置換型、侵入型、副格子、秩序相など）
4) パラメータ最適化（全データを同時に説明するよう同定）
5) 検証（未使用データ、別経路の実験、他系への整合性）
6) 公開・運用（計算条件の標準化、更新履歴の管理）

第一原理計算は、実験が不足する領域（高温準安定相、希薄溶解、三元相の形成エンタルピーなど）の補助データとして導入されることが多い。

## 5. アウトプットと読み方

### 5.1 状態図（平衡計算）
- 二元T–x、三元等温断面、多元等温断面、液相面投影など
- タイライン、三相平衡（不変反応）を計算で探索できる

### 5.2 化学ポテンシャルと駆動力
任意の相$\alpha$から相$\beta$への変態駆動力は、同一$(T,P,\mu_i)$下でのグランドポテンシャル差や化学ポテンシャル整合で評価する。相場の移動（熱処理条件変更）に対する感度解析にも使える。

### ს.3 Scheil–Gulliverなどの非平衡凝固近似
- 固相内拡散なし、液相完全混合などの仮定で凝固偏析を予測する
- 実プロセスの方向性を掴む用途に強いが、拡散・核生成は別途モデル化が必要である

### 5.4 拡散・時効（CALPHAD + mobility）
熱力学（駆動力）と移動度（拡散係数）を組み合わせると、濃度プロファイル、成長速度、析出の時間発展を扱える。工学的には熱処理設計や偏析評価に直結する。

## 6. フェーズフィールド・組織予測への接続
フェーズフィールド法では、局所自由エネルギー密度$f(c,T)$や化学ポテンシャル$\mu(c,T)$が必要になる。CALPHADデータベースからこれらを供給し、多相・多元の組織形成（凝固、相分解、再結晶の一部）を熱力学整合に扱う流れが定着している。

一例として、グランドポテンシャル形式では
$$
\omega(\mu,T) = f(c,T) - \sum_i \mu_i c_i
$$
を用い、局所平衡を満たす$c(\mu,T)$をCALPHADから得て計算を進める設計が多い。

## 7. 注意点
- データベース外挿の限界：高次系では未評価の相や副格子設定の誤りが致命的になる
- 準安定相の扱い：データベースに含まれていなければ計算上は存在しない
- 物理の省略：短距離秩序、強相関、非調和、電子励起などは自由エネルギーに“折りたたまれている”ため、機構解釈には補助情報が要る
- 不確かさ：相境界の誤差は入力データの散らばりとモデル自由度に依存するため、感度解析と検証が必須である

## 8. ソフトウェアと運用の目安
- 商用：Thermo-Calc、Pandat、FactSage など（データベースと統合されたワークフローが強い）
- オープン：pycalphad、OpenCALPHAD系（研究・教育用途で透明性が高い）

運用では、(i) 目的相と温度域を満たすデータベース選択、(ii) 最小系（2元/3元）の再現確認、(iii) 目的の多元計算、(iv) 感度解析、の順で進めるのが再現性を上げやすい。

## まとめ
CALPHAD法は、相ごとのギブスエネルギーをモデル化し、全ギブスエネルギー最小化で多元系の相平衡を計算する枠組みである。副格子モデルやCEFにより、固溶体から秩序相・侵入型まで一貫した表現が可能となり、実験と第一原理計算を統合してデータ不足領域も補完できる。状態図の予測に留まらず、化学ポテンシャル・駆動力・凝固偏析・拡散やフェーズフィールド連成へと接続できるため、材料設計からプロセス設計までの共通言語として機能する。
 
