# 量子アニーリング

量子アニーリングは、横磁場による量子ゆらぎを時間的に制御し、目的関数を基底状態（または低励起）として実現するように探索する計算枠組みである。組合せ最適化だけでなく、無秩序系・欠陥配置・合金秩序化など「低エネルギー配置集合」を扱う問題へ拡張されつつある。

## 参考ドキュメント
1. Tameem Albash, Daniel A. Lidar, Adiabatic Quantum Computation (Rev. Mod. Phys. 90, 015002 (2018))
   https://www.epfl.ch/schools/ic/ipg/wp-content/uploads/2021/12/RevModPhys.90.015002.pdf
2. D-Wave Documentation: Quantum Annealing (Hamiltonian, schedule, reverse annealing等の基礎)
   https://docs.dwavesys.com/docs/latest/c_gs_5.html
3. 田中 宗 ほか, 量子アニーリングの基礎と応用（日本語解説）
   https://www.jstage.jst.go.jp/article/jcsj/56/1/56_51/_article/-char/ja/


## 1. 何をしている方法か

量子アニーリングは「エネルギー地形」を持つ離散変数問題を、量子ゆらぎで障壁を横切りながら低エネルギーへ導く、という直観で捉えられる。ここでエネルギー地形とは、スピン配列や占有配置など離散自由度の関数として定義される有効エネルギーである。

典型的な比較対象は焼きなまし法（Simulated Annealing; SA）である。

- SA：温度を下げ、熱ゆらぎで障壁を越えて低エネルギーを探索する
- QA：横磁場を弱め、量子ゆらぎ（トンネル）で障壁を貫通しつつ低エネルギーを探索する

ただし現実の量子アニーラは有限温度・雑音下で動作するため、「純粋に断熱的・閉じた量子系」ではなく、量子ゆらぎと熱ゆらぎが協奏する領域も多い。

## 2. 基本モデル：時間依存ハミルトニアン

量子アニーリングで最も広く使われる表現は、横磁場イジング模型にもとづく補間ハミルトニアンである。

時間（または正規化パラメータ）$s\in[0,1]$ を用いて

$$
H(s)=A(s)H_{\mathrm{D}} + B(s)H_{\mathrm{P}}
$$

とし、初期は $A(0)\gg B(0)$、終状態で $B(1)\gg A(1)$ となるようにスケジュール $A(s),B(s)$ を設計する。

### 2.1 Driver（横磁場）項

典型的に

$$
H_{\mathrm{D}}=-\sum_i \sigma_i^x
$$

である。$\sigma_i^x$ はパウリ行列で、$z$ 基底（古典スピン）に対して量子ゆらぎを与える。

### 2.2 Problem（目的関数）項＝イジング

目的関数を

$$
H_{\mathrm{P}}=\sum_i h_i\sigma_i^z+\sum_{i<j}J_{ij}\sigma_i^z\sigma_j^z
$$

として符号化する。測定は通常 $z$ 基底で行われ、得られる古典スピン $z_i\in\{-1,+1\}$ に対して

$$
E(\mathbf{z})=\sum_i h_i z_i + \sum_{i<j}J_{ij} z_i z_j
$$

が対応する。最小化したい目的関数をこの形へ落とし込むことが、量子アニーリングの出発点である。

## 3. QUBO とイジングの相互変換

組合せ最適化では、0/1 変数 $\mathbf{x}\in\{0,1\}^N$ に対する QUBO

$$
\min_{\mathbf{x}} \ \mathbf{x}^\mathsf{T}Q\mathbf{x}
$$

が便利である。イジング変数との変換は

$$
z_i=2x_i-1 \quad (x_i=\frac{z_i+1}{2})
$$

で与えられ、$Q$ から $(h_i,J_{ij})$ を得られる。制約条件はペナルティ

$$
E'(\mathbf{x})=E(\mathbf{x})+\lambda\sum_k g_k(\mathbf{x})^2
$$

で実装されることが多く、$\lambda$ の設定が解品質と可読性（スケール）を左右する。

## 4. 断熱原理と成功条件

理想化した閉じた量子系で、基底状態から始めて十分ゆっくり変化させれば、系は基底状態に追随する（断熱定理）という考え方が骨格である。

目安として、最小ギャップ $\Delta_{\min}$ が律速する。

- ギャップが指数関数的に小さい（一次相転移や強いフラストレーションなど）と、断熱追随に長時間が必要になりやすい
- スケジュールの工夫（停止、急冷、局所的な走査）や、目的が基底状態厳密解でなく「十分低いエネルギーの多様なサンプル」である場合には、必ずしも断熱そのものを満たさない運用も意味を持つ

Landau–Zener 型の描像では、回避交差近傍での励起確率が

$$
P_{\mathrm{exc}}\sim \exp\left(-\frac{\pi \Delta^2}{2\hbar v}\right)
$$

のように速度 $v$ とギャップ $\Delta$ に依存する、と理解できる（定数・定義はモデルに依存する）。

## 5. 実機上の論点

### 5.1 埋め込み（minor embedding）と鎖（chain）

実機の結合グラフが完全結合でない場合、論理スピンを複数の物理スピンの鎖で表し、鎖内結合を強くして同一値を保つ。ここで

- 鎖強度が弱い：鎖切れ（chain break）が増え誤解が増える
- 鎖強度が強すぎる：目的関数の有効スケールが下がり、最適化が難しくなる

というトレードオフが生じる。

### 5.2 開放系としての量子アニーリング

超伝導量子ビット型の量子アニーラは有限温度環境に接しており、単純なシュレーディンガー方程式だけでは記述しきれないことがある。概念的には

$$
\frac{d\rho}{dt}=-\frac{i}{\hbar}[H(t),\rho]+\mathcal{D}[\rho]
$$

のような密度行列の枠組み（散逸項 $\mathcal{D}$）が背景にある。これにより、熱励起・緩和・デコヒーレンスが解品質やサンプリング分布へ影響する。

## 6. スケジュール設計の拡張

量子アニーリングは単純に $s:0\to1$ と進めるだけでなく、探索戦略としてスケジュールを設計できる。

- pause：特定の $s$ で停止し、緩和・再分配を促す
- quench：終盤で急冷し、低温状態を固定する
- reverse annealing：候補解（古典配置）から出発し、いったん量子ゆらぎを増やして近傍探索し、再び収束させる

reverse annealing は「初期解を持つ局所探索」に近い意味を持つため、材料の配置最適化で事前の良い近似（例えば古典MCや貪欲法）を併用する場合に相性がよい。

## 7. 性能評価：TTS とスケーリングの読み方

量子アニーリングのベンチマークは「1回の実行で正解（基底状態）に当たる確率」$p_{\mathrm{S}}(t_f)$ と、所望の成功確率 $p_d$（例：0.99）を満たすまでの時間で要約されることが多い。代表的指標は Time-to-Solution（TTS）である。

$$
\mathrm{TTS}(t_f)=t_f\frac{\ln(1-p_d)}{\ln(1-p_{\mathrm{S}}(t_f))}
$$

ここで $t_f$ はアニーリング時間である。$t_f$ を増やせば単発成功確率が上がるとは限らず、最適 $t_f$ が存在することが多い。

基底状態の厳密探索ではなく、低エネルギー状態のサンプリング（熱力学量の推定など）を目的とする場合、評価指標は「分布の一致」「エネルギー下位パーセンタイルの再現」「相関関数の一致」などに変化する。

## 8. 応用例

量子アニーリングが自然に当てはまるのは、離散配置を持つ有効模型である。典型例を挙げる。

### 8.1 合金・固溶体の秩序化／化学配置探索（格子上の占有変数）

置換型固溶体では、格子点 $i$ の占有を $x_i\in\{0,1\}$ または $z_i\in\{-1,+1\}$ で表すと、近接相互作用・長距離相互作用を含む有効ハミルトニアンへ落とし込める。クラスター展開の文脈では

$$
E(\sigma)=\sum_\alpha J_\alpha \Phi_\alpha(\sigma)
$$

のように相関関数 $\Phi_\alpha$ と係数 $J_\alpha$ で表される。$\Phi_\alpha$ が2体中心ならイジング形に直結し、より高次の項は補助変数導入や近似でQUBO化される。

目的：
- 0 K 近傍の基底配置、準安定配置の探索
- 低エネルギー配置集合の抽出（秩序パラメータの候補、相分離の核）
- 欠陥（空孔・置換・反サイト）を含む配置の探索

### 8.2 欠陥配置・イオン配置

電荷補償やサイト占有制約を持つ欠陥配置は、制約付きQUBOとして記述しやすい。例えば「指定数の空孔を置く」「近接ペアは禁止」などはペナルティで扱える。最終的には DFT や第一原理ポテンシャルで再評価して、学習ループを回す形が自然である。

### 8.3 スピングラス・フラストレート磁性の低エネルギー状態

フラストレーションを含むスピン模型の基底状態探索自体が、量子アニーリングの原型である。磁気秩序の候補や低励起状態の多様性は、有限温度比熱・磁化・相関の理解にも関わる。

### 8.4 無秩序系の有限温度物性

近年は、基底状態探索に限らず「低エネルギー領域の効率サンプリング」をQAで行い、無秩序材料の熱力学へ接続する研究が報告されている。ここでは、エネルギーの低い配置を多数集め、重み付けや再構成により物性量の期待値へ結び付ける方向が重要になる。

## 9. 量子アニーリングと近縁概念

| 概念 | 典型表現 | 目的 | 主な違い |
|---|---|---|---|
| 焼きなまし（SA） | 温度スケジュール $T\downarrow$ | 最適化/サンプリング | 古典確率過程、障壁を越える |
| 量子アニーリング（QA） | 横磁場スケジュール $\Gamma\downarrow$ | 最適化/サンプリング | 量子ゆらぎ、実機は開放系で動作 |
| 断熱量子計算（AQC） | 断熱進化 | 計算一般（原理） | 理想化では閉じた量子系、普遍計算モデルとして議論される |
| QAOA | 量子回路（パラメトリック） | 近似最適化 | ゲート型量子計算機向け、回路深さとノイズの関係が支配的 |
| 量子インスパイアド（SB, CIM, DA等） | 古典アルゴリズム | 最適化 | 量子効果を使わず高速実装を狙う |

国内では、量子アニーリング実機だけでなく、量子インスパイアド手法（Ising最適化専用機・専用アルゴリズム）も広く研究開発されており、実装・運用条件が異なる点に注意が必要である。

## 10. ワークフロー

1. 離散自由度の決定
   - 占有（元素A/B）、欠陥（有/無）、スピン（up/down）など

2. エネルギーモデルの構築
   - 近接相互作用、電荷、弾性近似、クラスター展開、経験的ハミルトニアンなど
   - 重要なのは、QUBO/イジングへ落ちる形に整理することである

3. 制約の組み込み
   - 組成固定、電荷中性、最小距離制約などをペナルティで表現する

4. スケーリングと前処理
   - 係数のスケール調整（ハード上の係数分解能やノイズを意識）
   - グラフの疎化・分割、クラスタの切り出しなど

5. 実行（多試行）と後処理
   - 多数サンプルから最良解と低エネルギー集合を抽出
   - 鎖切れ補正、局所探索（古典最適化）で補正

6. 第一原理・高精度モデルで再評価
   - DFTで再最適化し、エネルギー順位や構造安定性を検証する

7. 学習ループ（必要なら）
   - 重要配置を追加計算してモデルを更新し、探索を強化する

## 11. 限界と注意点

- 量子アニーリングは「何でも高速に解ける」ことを意味しない
  - NP困難問題一般に対して一律の速度保証はない

- スケールと埋め込みが支配的になることがある
  - 論理問題のサイズがそのまま物理量子ビット数に乗らない

- 係数分解能・雑音・温度が分布と解品質に影響する
  - とくにサンプリング用途では、目的分布との距離を評価する必要がある

- 目的が「基底状態」か「低エネルギー集合」かで、設計思想が変わる
  - 熱力学用途では、単一最小よりも多様なサンプルの質が重要になりうる

## 12. まとめ

量子アニーリングは、横磁場イジング模型にもとづいて離散配置の最適化・サンプリングを行う枠組みであり、合金配置・欠陥配置・無秩序系の低エネルギー状態といった固体の代表的課題へ自然に接続できる。成功の鍵は、モデル化（QUBO/イジング化）、制約の扱い、スケジュール設計、埋め込みと後処理の最適化、そして高精度計算による再検証を一体化して設計することである。

