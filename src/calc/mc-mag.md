# モンテカルロ法による磁性体モデルの計算例
作成日：2025年11月23日

## 概要
- ここでは、**古典スピンモデルに対するモンテカルロ計算**の典型例として  
  - 2 次元イジング模型（正方格子）  
  - 2 次元古典ハイゼンベルク模型（簡単な例）  
  を取り上げる。
- 目的：
  - 強磁性状態の自発磁化  
  - 臨界温度近傍での比熱・感受率  
  - スピン相関関数の振る舞い  
  などを、モンテカルロサンプリングから求める。

---

## 例 1：2 次元イジング模型（正方格子）

### モデル
- 格子：\(L \times L\) の正方格子、周期境界条件（PBC）。
- スピン変数：各サイト \(i\) に \(S_i = \pm 1\)。
- ハミルトニアン：
  \[
    \mathcal{H} = -J \sum_{\langle i,j \rangle} S_i S_j - h \sum_i S_i
  \]
  - \(J > 0\)：強磁性結合  
  - \(\langle i,j \rangle\)：最近接スピン対  
  - \(h\)：一様外部磁場（計算例ではまず \(h=0\)）

### 計算したい物理量
- 自発磁化（サイト平均）：
  \[
    m = \frac{1}{N}\sum_i S_i,\quad N=L^2
  \]
- 内部エネルギー：
  \[
    E = \langle \mathcal{H} \rangle
  \]
- 比熱：
  \[
    C = \frac{\langle E^2 \rangle - \langle E \rangle^2}{N k_B T^2}
  \]
- 磁化感受率：
  \[
    \chi = \frac{\langle m^2 \rangle - \langle |m| \rangle^2}{N k_B T}
  \]

### メトロポリス法による更新
- 1 モンテカルロステップ (MCS) の流れ（単スピンフリップ）：
  1. ランダムにサイト \(i\) を選ぶ。
  2. フリップ候補：\(S_i \to -S_i\) と仮定したときのエネルギー変化 \(\Delta E\) を計算。
  3. 受容確率
     \[
       P_{\text{acc}} = \min\left(1, e^{-\beta \Delta E}\right)
     \]
     でフリップを受理するかどうか決める。
  4. これを \(N\) 回繰り返して 1 MCS とみなす（サイト 1 個あたり平均 1 回試行）。

### シミュレーションプロトコル
- 初期状態：
  - 高温スタートならランダム (\(S_i=\pm1\) ランダム)  
  - 低温スタートなら全スピン上向き (\(S_i=+1\)) など。
- 温度スイープ：
  - 低温から高温、あるいは逆方向に温度を変えながら計算。
- 手順：
  1. 与えた温度 \(T\) について、熱化（burn-in）として数千〜数万 MCS を捨てる。
  2. その後、一定間隔（例：10 MCS ごと）に物理量 \(m, E\) を記録。
  3. サンプル平均から \(\langle |m| \rangle, \langle E \rangle, C, \chi\) を評価。
- 典型的な結果：
  - ある温度 \(T_c\) 付近で磁化が消失し、比熱・感受率がピークを示す（強磁性–常磁性相転移）。

---

## 例 2：2 次元古典ハイゼンベルク模型

### モデル
- 格子：\(L \times L\) 正方格子（PBC）。
- スピン変数：各サイトに単位ベクトル \(\mathbf{S}_i = (S_i^x, S_i^y, S_i^z)\)、\(|\mathbf{S}_i|=1\)。
- ハミルトニアン：
  \[
    \mathcal{H} = -J \sum_{\langle i,j \rangle} \mathbf{S}_i \cdot \mathbf{S}_j
  \]
- 2D の等方ハイゼンベルク模型では、厳密には有限温度での長距離秩序は存在しない（Mermin–Wagner）。  
  → 有限サイズでは「擬似的な」秩序やスピン相関の発達を観察することができる。

### 更新アルゴリズム例
- 連続スピンのため、単純な「反転」ではなく「ランダム回転」を用いる。
- 単スピン更新（Metropolis）：
  1. サイト \(i\) を選ぶ。
  2. \(\mathbf{S}_i\) を小角度ランダム回転して新しい \(\mathbf{S}_i'\) を生成。
  3. \(\Delta E = E(\mathbf{S}_i') - E(\mathbf{S}_i)\) を計算。
  4. イジングと同様、\(\min(1,e^{-\beta \Delta E})\) の確率で更新を受容。
- 連続スピン用のクラスター更新法（Wolff の O(N) モデルへの拡張など）もあるが、ここでは最も基本的な単スピン更新を想定。

### 観測量
- 全磁化ベクトル：
  \[
    \mathbf{M} = \frac{1}{N}\sum_i \mathbf{S}_i,\quad M = |\mathbf{M}|
  \]
- スピン相関関数：
  \[
    C(r) = \langle \mathbf{S}_i \cdot \mathbf{S}_{i+r} \rangle
  \]
- 構造因子：
  \[
    S(\mathbf{q}) = \frac{1}{N}\sum_{i,j} \langle \mathbf{S}_i \cdot \mathbf{S}_j \rangle e^{i\mathbf{q}\cdot(\mathbf{r}_i-\mathbf{r}_j)}
  \]
- 高温から温度を下げると、近距離の相関 \(C(r)\) や低 \(|\mathbf{q}|\) での \(S(\mathbf{q})\) が増大する様子を観察できる。

---

## 実務上のポイント（磁性体シミュレーション全般）

### 1. 熱化（Burn-in）と自己相関
- 初期状態の影響を消すために、十分なステップを捨てる（熱化時間）。
- サンプル間が強く相関している場合、統計誤差が過小評価される。
  - ブロック平均や自己相関時間の推定で、有効サンプル数を見積もる。

### 2. 系サイズ・有限サイズ効果
- 臨界現象の解析（\(T_c\), 臨界指数など）には複数サイズ \(L\) での計算が必須。
- 有限サイズスケーリング分析を行うことで、熱力学極限 \(L\to\infty\) の物理量を外挿できる。

### 3. 更新アルゴリズムの選択
- イジング模型：
  - 低温・臨界近傍では単スピンフリップが「動かない」ことが多く、  
    Wolff / Swendsen–Wang などのクラスター更新が有効。
- ハイゼンベルク・XY 模型：
  - 連続スピン系では、回転角の調整、Over-relaxation 法、クラスター更新の工夫が必要。

### 4. 実験・第一原理との接続
- 磁性体の実材料に近づけるには：
  - \(J\), 異方性、外場、g 因子などを第一原理計算（例えば VASP＋マッピング）で見積もり、
  - そのパラメータでスピン模型を定義し、モンテカルロで有限温度磁化やスピン相関を計算する。
- こうした「スピン模型 + MC」は、
  - キュリー温度の推定
  - 磁気相図の作成
  - スピン揺らぎの評価
  などに広く用いられている。

