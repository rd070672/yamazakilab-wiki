# 常微分方程式 (ODE)と偏微分方程式 (PDE) の基礎

常微分方程式（ODE）と偏微分方程式（PDE）は、時間発展・平衡・輸送・波動・量子状態などを記述するための共通言語である。式の形そのものよりも、未知関数の意味、初期条件・境界条件、解の性質（存在・一意性・安定性）が理解の軸になる。

## 参考ドキュメント
- MIT OpenCourseWare, Introduction to Partial Differential Equations (18.152), Lecture notes  
  https://ocw.mit.edu/courses/18-152-introduction-to-partial-differential-equations-fall-2011/
- 棚橋典大, 常微分方程式 講義ノート（PDF）  
  https://www2.yukawa.kyoto-u.ac.jp/~norihiro.tanahashi/pdf/ODE/note_ODE.pdf
- Karel Svadlenka, 偏微分方程式：講義ノート（PDF）  
  https://karel.fpark.tmu.ac.jp/files/notes_pde_2015.pdf
- 京都大学OCW, シミュレーション概論ノート：偏微分方程式（PDF）  
  https://ocw.kyoto-u.ac.jp/wp-content/uploads/2000/04/1999_introduction-to-simulation_08.pdf

## 1. 微分方程式とは何か
微分方程式は、未知関数とその微分の関係を与える方程式である。未知関数を $u$、独立変数を $x$ や $t$ とすると、典型的に

- ODE：$u=u(t)$ のように独立変数が1つ  
- PDE：$u=u(t,x,y,...)$ のように独立変数が2つ以上

となる。

### 1.1 ODEとPDEの違い
| 観点 | ODE | PDE |
|---|---|---|
| 未知関数 | $u(t)$（または $u(x)$） | $u(t, x, y, z, …)$ |
| 条件 | 初期条件（IC）中心、場合により境界条件（BVP） | 初期条件（IC）と境界条件（BC）の両方が本質 |
| 解のイメージ | 軌道（時間発展）・有限次元状態 | 場（field）の時間発展・空間分布 |
| 計算の難しさ | 次元は低いが剛性やカオスが問題になり得る | 自由度が大きく、離散化・境界処理・安定性が支配的 |

## 2. 分類のための基本語彙
### 2.1 階数（order）
微分の最高階で分類する。例として
- 1階：$u'(t)=f(t,u)$
- 2階：$u''(t)+a u'(t)+b u=g(t)$

### 2.2 線形・非線形
- 線形：$u$ とその微分が一次で現れる（係数は独立変数に依存してよい）  
  例：$u_t = D u_xx$、$∇·(k∇u)=s$
- 非線形：$u^2$、$u·∇u$、$(∇u)^2$ などが入る  
  例：$u_t = D∇^2u + u(1-u)$、LLG、Cahn–Hilliard など

### 2.3 自律系（autonomous）と非自律系
- 自律系：$u'(t)=f(u)$（$t$が明示的に入らない）
- 非自律系：$u'(t)=f(t,u)$

### 2.4 初期値問題（IVP）と境界値問題（BVP）
- IVP：ある時刻 $t0$ の状態 $u(t0)=u0$ を与えて、時間発展を決める
- BVP：領域境界 $∂Ω$ 上で $u$ 或いは $∂u/∂n$ を与えて、領域内の分布を決める  
  定常場（時間が消えた式）ではBVPが中心になる。

## 3. ODEの基礎：初期値で解が決まるとは何か
一般に ODE の初期値問題は

$$
\frac{du}{dt}=f(t,u),\quad u(t_0)=u_0
$$

で表される。

### 3.1 存在と一意性
同じ初期値から解が一意に定まることは、「モデルが予測を持つ」ことと同義である。代表的には、$f$ が $u$ に関して局所リプシッツ連続であれば、十分小さい時間区間で解が存在し一意になる。

直感：
- 連続性：解が存在しうる
- リプシッツ性：解が分岐せず一意に定まる

### 3.2 線形ODE：最初に押さえる骨格
一次の線形系
$$
\frac{d\mathbf{u}}{dt}=A\mathbf{u}+\mathbf{b}(t)
$$
は、固有値・固有ベクトル、指数行列 $e^{At}$ により安定性（減衰・発散・振動）が整理できる。多自由度の緩和・共鳴・結合系は、この形を局所線形化して理解するのが基本である。

### 3.3 剛性（stiffness）という落とし穴
時間スケールが極端に分離すると、陽解法（explicit）の時間刻みが過度に小さく要求されることがある。緩和の速いモードと遅いモードが共存する系では
- 陰解法（implicit）
- 半陰解法（IMEX）
- 適応刻み（adaptive step）
が選択肢になる。

## 4. PDEの基礎：方程式の型が性質を決める
PDEは「場の方程式」であり、解の性質は方程式の型（type）と条件（IC/BC）で大きく変わる。

### 4.1 代表例（まず3つ）
- 楕円型：定常・ポテンシャル場  
  例：ラプラス方程式 $∇^2u=0$、ポアソン方程式 $−∇·(k∇u)=s$
- 放物型：拡散・緩和（時間発展）  
  例：拡散方程式 $u_t = D∇^2u$
- 双曲型：波動・伝播・有限速度の情報伝達  
  例：波動方程式 $u_{tt} = c^2∇^2u$

### 4.2 2階線形PDEの分類（超重要）
2変数の2階線形PDE
$$
A u_{xx} + 2B u_{xy} + C u_{yy} + \cdots = 0
$$
は判別式 $B^2−AC$ により
- 楕円型：$B^2−AC<0$
- 放物型：$B^2−AC=0$
- 双曲型：$B^2−AC>0$
に分類される。

この分類は「境界条件を与えるべきか」「初期条件が必要か」「解が滑らかになるか」「不連続が伝播するか」といった性質に直結する。

### 4.3 適切性（well-posedness）
PDEでは、Hadamardの意味で
- 解が存在する
- 解が一意である
- データ（IC/BC）の小さな変化に対して解が連続に変化する
を満たすことが重要である。型と条件の組が不適切だと、解析的にも数値的にも破綻しやすい。

## 5. 初期条件・境界条件・界面条件の辞書
### 5.1 境界条件の基本形
領域 $Ω$ と境界 $∂Ω$ を考える。

- Dirichlet：$u|_{∂Ω} = g$  
  境界で値を固定する
- Neumann：$∂u/∂n|_{∂Ω} = h$  
  境界で流束（法線微分）を固定する
- Robin：$a u + b ∂u/∂n = r$  
  値と流束の混合（対流・表面反応・境界抵抗などで現れやすい）
- Periodic：$u(x+L)=u(x)$ など  
  周期構造・繰り返し境界

### 5.2 界面条件（複数相・複数材料）
異なる領域 $Ω1$, $Ω2$ の境界 $Γ$ では
- 連続条件：$u1|_Γ = u2|_Γ$
- 流束連続：$k1 ∂u1/∂n = k2 ∂u2/∂n$
のような「接合条件」がよく現れる。ここがモデルの物理性と計算の安定性を左右する。

## 6. 解析的アプローチ
### 6.1 ODE
- 変数分離、積分因子、保存量
- 線形化と安定性解析（固有値）
- 位相平面（2次元系）、極限周期軌道
- 摂動法（小さな非線形・小パラメータ）

### 6.2 PDE
- フーリエ法・固有関数展開（境界条件とセット）
- 変数分離（1D/単純領域で強い）
- グリーン関数（線形作用素の逆を作る発想）
- 特性曲線法（1階PDEや双曲型で、PDEをODEに落とす）
- 変分原理・弱形式（エネルギー汎関数の最小化、FEMの基礎）

## 7. 数値解法の位置づけ：ODEとPDEのつながり
### 7.1 ODEの時間積分（代表）
- 陽解法：Euler、Runge–Kutta  
  実装は単純だが安定条件が厳しくなりやすい
- 陰解法：Backward Euler、BDF  
  安定性に強いが連立方程式を解く必要がある

### 7.2 PDEは離散化すると大規模ODE/DAEになる
空間を離散化（差分・要素・体積など）すると

- PDE → 大規模な常微分方程式系（Method of Lines）
- 定常PDE → 連立一次/非線形方程式

に帰着する。計算の核心は
- 空間離散化（近傍・要素・基底）
- 時間積分（安定性と精度）
- 線形/非線形ソルバ（反復法・前処理）
の3点に集約される。

### 7.3 安定性：CFL条件
陽的時間発展では、情報の伝播速度に対して時間刻み $Δt$ と空間刻み $Δx$ が制約されることが多い。代表例として、波動や移流では

$$
C=\frac{c\,\Delta t}{\Delta x}\lesssim 1
$$

のような形の条件（CFL）が現れやすい。拡散でも $Δt$ と $(Δx)^2$ の関係で安定条件が出る。

## 8. モデル化のチェックリスト
1. 未知関数 $u$ の意味と単位が整合しているか  
2. 保存則（質量・エネルギー・磁化長など）を満たす形になっているか  
3. IC/BC/界面条件が、方程式の型に対して自然か  
4. 無次元化で支配的な項（支配パラメータ）を見抜けているか  
5. 数値解が刻み幅に対して収束するか（格子収束・時間収束）  
6. 解析解や極限挙動（定常解・微小振幅解）で検算できるか

## まとめ
ODEは有限次元の時間発展を、PDEは空間に拡張された場の時間発展や定常分布を記述する枠組みである。理解の中心は、方程式の型、IC/BCの与え方、存在・一意性・安定性であり、数値計算では離散化によって現れる安定条件と大規模連立方程式の解法が支配的になる。

