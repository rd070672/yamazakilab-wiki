# デンドライト成長のフェーズフィールドシミュレーション

デンドライト（樹枝状晶）は固液界面の形態不安定性と結晶方位に由来する界面異方性が組み合わさって生じる。フェーズフィールド法は界面を連続場で表し、界面追跡なしに成長・分岐・粗大化までを同一の計算枠組みで扱える。

## 参考ドキュメント
- A. Karma, Quantitative phase-field modeling of dendritic growth in two and three dimensions, Physical Review E 57 (1998) 4323.
  https://link.aps.org/doi/10.1103/PhysRevE.57.4323
- R. Kobayashi, Modeling and numerical simulations of dendritic crystal growth, Physica D 63 (1993) 410–423.
  https://www.sciencedirect.com/science/article/pii/016727899390120P
- 第11章 Phase-field法1（凝固）, 名古屋大学関連講義資料（PDF）
  https://www.material.nagoya-u.ac.jp/PFM/docs/Lecture_H20/H20_Chapter_11.pdf

## 1. ねらい
デンドライト成長を再現するために次の2本立てで説明を進める。

1) 相場（フェーズフィールド）$φ(x,t)$
- $φ=1$ を固相、$φ=0$ を液相として界面を滑らかに表す
- $φ$ は非保存量であり、自由エネルギーを単調に下げる勾配流（Allen–Cahn 型）で進む

2) 温度場 $T(x,t)$（純物質の熱デンドライト）
- 熱拡散と潜熱放出（Stefan 型）で界面近傍の温度勾配を作る
- 過冷却度が成長駆動力となる

二元合金の溶質デンドライトでは、温度の代わりに溶質濃度 $c(x,t)$ の拡散方程式（保存量）と分配（パーティション）を連成する。後半で拡張として概説する。

## 2. 自由エネルギーと Allen–Cahn 方程式
### 2.1 自由エネルギーの典型形
固液の二相系に対して、汎関数を
$$
F[\varphi,T] = \int_\Omega \left(
\frac{W}{4}\varphi^2(1-\varphi)^2
+ \frac{1}{2}\,a(\theta)^2|\nabla\varphi|^2
+ f_{\mathrm{th}}(\varphi,T)
\right)\, dV
$$
のように置く。ここで $W$ は二重井戸ポテンシャルの強さ、$a(θ)$ は界面エネルギー（より厳密には界面剛性）を方位依存にする異方性関数である。

$f_th$ は温度による化学的駆動力（過冷却による固化の有利さ）を $φ$ に結合させる項であり、具体形はモデル流儀によって複数ある。

### 2.2 $φ$ の時間発展（Allen–Cahn 型）
$φ$ は非保存量であるため、
$$
\frac{\partial \varphi}{\partial t} = -M_\varphi \frac{\delta F}{\delta \varphi}
$$
とする。$M_φ$ はフェーズフィールド・モビリティであり、界面運動学（界面の有効緩和時間）を支配する。

### 2.3 異方性 Allen–Cahn 方程式
異方性 $a(θ)$ を「界面法線方向 $θ$」に依存させると、拡散型項が単純な $a^2∇^2φ$ ではなく、交差微分を含む形になる。2次元では代表的に次の形で書ける。

(1)
$$
\frac{\partial \varphi}{\partial t}=-M_\varphi\frac{\partial F}{\partial \varphi}
$$

(2)
$$
\frac{\partial \varphi}{\partial t}
=M_\varphi\Bigg[
\nabla\cdot\left(a(\theta)^2\nabla\varphi\right)
-\frac{\partial}{\partial x}\left(a(\theta)\frac{\partial a}{\partial\theta}\frac{\partial\varphi}{\partial y}\right)
+\frac{\partial}{\partial y}\left(a(\theta)\frac{\partial a}{\partial\theta}\frac{\partial\varphi}{\partial x}\right)
+4W\,\varphi(1-\varphi)\,G(\varphi,T)
\Bigg]
$$

ここで $G(φ,T)$ は局所反応項（固相・液相の自由エネルギー差に相当）であり、提示式に沿って一例を書くと
$$
G(\varphi,T)
=\left(
\varphi-\frac{1}{2}
-\frac{15}{2W}\frac{L(T-T_m)}{T_m}\,\varphi(1-\varphi)
+\chi
\right)
$$
のような構造を取る。$T_m$ は融点、$L$ は潜熱に関係する係数である。$χ$ はサイドブランチ形成を誘起するための揺らぎ（ノイズ項、あるいは駆動力揺らぎの表現）として導入されることがある。

補足として、$θ$ は界面法線の角度であり、例えば
$$
\theta=\tan^{-1}\left(\frac{\partial\varphi/\partial y}{\partial\varphi/\partial x}\right)
$$
で定義することが多い。

### 2.4 異方性関数 $a(θ)$ の典型
立方晶の2次元投影で4回対称の優先成長方向を入れる場合、典型として
$$
a(\theta)=1+\epsilon\cos\left(m(\theta-\theta_0)\right),\quad m=4
$$
を用いる。$ε$ は異方性強度である。$θ_0$ を回すと結晶方位の回転に相当する。

注意点として、デンドライトの先端選択には異方性が本質的であり、$ε$が小さすぎると安定した先端半径や枝の選択が困難になる（数値誤差が見かけの方位選択を作る場合がある）。

## 3. 温度場との連成
純物質の等温では相分離に近づきやすく、デンドライト成長を再現するには熱拡散を結合して界面前方の温度勾配を作るのが基本である。

### 3.1 熱拡散＋潜熱放出
$$
\frac{\partial T}{\partial t}
= D_T\nabla^2 T + \frac{L}{C_p}\frac{\partial p(\varphi)}{\partial t}
$$
- $D_T$ は熱拡散率
- $C_p$ は比熱
- $p(φ)$ は界面でのみ潜熱源が立ち上がるようにする補間関数であり、例えば
  $$
  p(\varphi)=\varphi^3(6\varphi^2-15\varphi+10)
  $$
  のように 0 と 1 で勾配がゼロになる形がよく使われる

境界条件は、周期境界で系を閉じる設定、あるいは外側に一定温度（過冷却）を課す設定が多い。計算領域が小さいと熱場がすぐ飽和し、先端速度や枝間隔が領域依存になりやすい。

### 3.2 無次元化で見える支配パラメータ
代表長さを界面幅やキャピラリー長 $d0$、代表時間を拡散時間 $L0^2/D_T$ などで無次元化すると、主に次の量が支配的になる。

- 過冷却度 $Δ$（境界温度と融点の差）
- ペクレ数 $P$（先端半径 $ρ$ と速度 $V$ により $P=Vρ/(2D_T)$ など）
- 異方性 $ε$
- 界面運動学（有効な速度係数、あるいは緩和時間）

これらを走査すると、リーフ状から樹枝状、セル状など形態領域が整理できる。

## 4. 定量化
フェーズフィールドは界面厚みを有限に取るため、そのままでは界面条件（Gibbs–Thomson 条件や Stefan 条件）に人工的な補正が入る。定量的に使うには、薄界面極限（thin-interface）に基づき、モデルパラメータをキャリブレーションするのが一般的である。

### 4.1 代表的な対応付け
- 目標：鋭い界面モデル（自由境界問題）のパラメータ
  - キャピラリー長 d0（界面エネルギーと潜熱・比熱などの組）
  - 動力学係数 β（界面移動の速度論）
- 手段：フェーズフィールド側の W（界面幅と障壁）、M_φ（緩和）、結合定数（温度とのカップリング）を調整し、薄界面解析で $d0, β$ を再現する

この設計により、界面幅を計算上「やや厚く」しても、界面条件は正しいまま保つことが可能になる。3次元・小過冷却の計算を可能にした背景がここにある。

## 5. 枝分かれと揺らぎ $χ$ の扱い
理想的に滑らかな系では、数値的には主枝が安定に進み、サイドブランチが弱くなりやすい。実材料では熱雑音、溶質雑音、外乱流、界面ゆらぎなどにより枝分かれが励起される。

$χ$ の入れ方は代表的に2通りである。

- 反応項 $G(φ,T)$ に加える（提示式のように駆動力側を揺らがせる）
- 温度方程式にノイズ源を加える、あるいは境界条件に揺らぎを与える

前者は実装が簡潔で、枝分かれの「きっかけ」を与える用途に向く。一方で、ノイズの物理的整合（相関、スケール、フラクチュエーション散逸関係まで含めるか）は別途の設計事項である。

## 6. 数値計算の実装
### 6.1 空間と時間の離散
- 方程式は反応拡散型であるため、陽解法だと時間刻み $Δt$ が厳しく小さくなりやすい
- 半陰（IMEX）や完全陰的、あるいは分割解法で安定にすることが多い
- 異方性項は交差微分を含み、粗い格子では人工的な方位選択や格子ピン止めが出やすい

### 6.2 解像度の目安
- 界面幅（$φ$ が 0 から 1 に変わる幅）は少なくとも数格子点で解像する
- 先端半径 $ρ$ が数十格子点で表現できないと、$V–ρ$ の選択則や枝間隔が信頼できなくなる
- 温度境界層（拡散長）を領域内に十分含める必要がある

### 6.3 初期条件の基本
- 小さな固相核（円形や球形）を置き、周囲に一定過冷却度を与える
- 等方計算で形態不安定が起きないのは正常である（異方性を入れて初めて安定した樹枝状先端が選択される）

### 6.4 観測量
- 先端速度 $V(t)$ と先端半径 $ρ(t)$
- 主枝方向の成長長さ、枝間隔、サイドブランチの振幅成長
- 温度場の等温線（先端前方の熱境界層）
- 全自由エネルギーの単調減少（数値健全性チェックとして有用）

## 7. 二元合金への拡張
二元合金の凝固では、溶質濃度 $c(x,t)$ の保存拡散と分配（固液平衡の濃度差）が本質になる。フェーズフィールドでは一般に

- $φ$：固液相（非保存、Allen–Cahn）
- $c$：溶質（保存、拡散方程式）
を連成し、界面での分配・放出を補間関数で滑らかに扱う。

定量化の難所は、有限界面幅が作る人工的なソリュートトラッピング（溶質捕獲）の抑制であり、これに対して反捕獲電流（antitrapping current）を導入する定量モデルが広く用いられている。固相拡散を含めた拡張も提案されており、時効や凝固偏析の議論に接続しやすい。

## まとめ
デンドライト成長のフェーズフィールド法は、相場 $φ$ の異方性 Allen–Cahn 方程式と、熱（または溶質）拡散方程式の連成で構成される。提示式に見られる $a(θ)$ 依存と交差微分項は、結晶方位に沿った先端選択と樹枝状形態の再現に不可欠である。定量的な議論には薄界面解析に基づくパラメータ対応付けと、界面・境界層の十分な解像が要点であり、サイドブランチは揺らぎ $χ$ の与え方を含めて設計課題として扱うのがよい。

