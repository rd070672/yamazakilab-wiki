# デンドライト成長シミュレーション

フェーズフィールド法は、固液界面を連続変数で表現し、界面追跡なしにデンドライト（樹枝状）成長を計算する手法である。凝固組織形成、偏析、柱状晶・等軸晶遷移、プロセス条件最適化まで一貫して扱えるのが強みである。

## 参考ドキュメント
- 日本語（講義資料）：名古屋大学 PFM 講義資料「第11章 Phase-field法1（凝固）」
  https://www.material.nagoya-u.ac.jp/PFM/docs/Lecture_H20/H20_Chapter_11.pdf
- 日本語（解説PDF）：高木知弘「雪のような形をした結晶をコンピュータの中で育てよう！」
  https://www.cis.kit.jp/~takaki/pdf/proceeding/CMD2003Forum.pdf
- 海外（代表論文）：A. Karma and W.-J. Rappel, Quantitative phase-field modeling of dendritic growth, Phys. Rev. E 57, 4323 (1998)
  https://link.aps.org/doi/10.1103/PhysRevE.57.4323


## 1. デンドライト成長の物理像（なぜ枝分かれするのか）
デンドライトは、過冷却（温度過冷却・組成過冷却）下で平坦界面が不安定化し、先端の曲率と拡散場（温度場・濃度場）の相互作用で選択則をもって成長する現象である。

重要要素
- 拡散場：熱拡散（純物質）・溶質拡散（合金）が界面前方に境界層を作る
- 表面張力（毛細管効果）：曲率が大きいほど平衡温度が下がる（Gibbs–Thomson）
- 異方性：界面エネルギーや界面運動の結晶方位依存が先端の形状と方位選択を決める
- 摂動源：熱揺らぎ、数値ノイズ、溶質ノイズなどが側枝（side-branching）を誘起する


## 2. フェーズフィールド法の基本変数
- 位相場（order parameter）$\phi(\mathbf{r},t)$
  - 典型例：$\phi=1$ が固相、$\phi=0$ が液相、界面で滑らかに遷移
- 温度場 $T(\mathbf{r},t)$（純物質または非等温凝固）
- 濃度場 $c(\mathbf{r},t)$（合金凝固、偏析計算）

界面位置を明示的に追跡せず、$\phi$ の等値面として界面が自動的に現れるのが本質である。


## 3. 最小モデル：純物質デンドライト（熱拡散のみ）
### 3.1 自由エネルギー汎関数
代表的に次を用いる：
$$
F[\phi,T]=\int_\Omega \left[ f(\phi,T) + \frac{\kappa(\mathbf{n})}{2}\,|\nabla\phi|^2 \right] dV,
\quad
\mathbf{n}=\frac{\nabla\phi}{|\nabla\phi|}
$$

- $f(\phi,T)$：二重井戸型（固・液の安定性）＋温度による駆動力
- $\kappa(\mathbf{n})$：界面エネルギーの異方性を含める（後述）

### 3.2 位相場の発展（Allen–Cahn型）
$$
\frac{\partial \phi}{\partial t} = -M_\phi \frac{\delta F}{\delta \phi}
$$

### 3.3 熱拡散（潜熱放出を含む）
$$
\frac{\partial T}{\partial t} = D_T \nabla^2 T + \frac{L}{c_p}\,\frac{\partial h(\phi)}{\partial t}
$$
- $D_T$：熱拡散率
- $L$：潜熱、$c_p$：比熱
- $h(\phi)$：固液の潜熱放出を滑らかに切り替える補間関数（例：$h=\phi$ など）


## 4. 合金デンドライト：二元系（溶質拡散＋偏析）
合金凝固では、溶質分配（partitioning）と組成過冷却が主役である。

### 4.1 拡散方程式（保存量）
基本形は保存則である：
$$
\frac{\partial c}{\partial t} = -\nabla\cdot \mathbf{J},\quad 
\mathbf{J} = -D(\phi)\nabla c + \mathbf{J}_{\mathrm{corr}}
$$
- $D(\phi)$：固相・液相で拡散係数が異なるため補間する
- $\mathbf{J}_{\mathrm{corr}}$：界面厚みを有限に取る際に生じる“見かけの効果”を補正する項（定量モデルでは重要）

### 4.2 KKS（Kim–Kim–Suzuki）型の考え方（界面での化学ポテンシャル整合）
KKSでは、固相濃度 $c_s$、液相濃度 $c_l$ を導入し、
$$
c = h(\phi)c_s + (1-h(\phi))c_l
$$
さらに界面での（拡散平衡に相当する）拘束：
$$
\mu_s(c_s) = \mu_l(c_l)
$$
を満たすように計算する。相の化学自由エネルギーを明示的に使いやすく、CALPHAD連成と相性が良い。


## 5. 界面異方性の入れ方（デンドライト形状を決める鍵）
2次元で4回対称の例（概念）：
$$
a(\theta)=1+\epsilon_4\cos\left(4(\theta-\theta_0)\right)
$$
- $\theta$：界面法線（または接線）の角度
- $\epsilon_4$：異方性強度、$\theta_0$：結晶方位

実装では、勾配エネルギー係数や界面厚みを $a(\theta)$ で変調し、先端の方位選択と安定なデンドライト形状を得る。


## 6. 定量フェーズフィールド（thin-interfaceの要点）
フェーズフィールドでは数値計算のため界面厚み $W$ を実界面より厚く取ることが多いが、そのままでは界面運動や溶質トラップに誤差が出る。thin-interface解析に基づき、モデルパラメータ（緩和時間、補間関数、補正流束など）を選ぶことで、有限 $W$ でも自由境界問題（Stefan問題）の境界条件に一致するよう“定量化”するのが重要である。

合金では特に、有限界面厚みに起因する見かけの溶質トラッピングを抑える補正（antitrappingの考え方）が定量計算の要点となる。


## 7. 典型的な計算設定
### 7.1 代表ケース
- 自由成長（free growth）：一定過冷却中で核からデンドライトが成長
- 方向性凝固（directional solidification）：温度勾配 $G$ と引き上げ速度 $V_p$ を与える（鋳造・溶接・AMに近い）
- 等温合金凝固：溶質拡散が支配、偏析と枝間濃度場を観察しやすい

### 7.2 境界条件の例
- 温度：遠方温度固定、または熱流束ゼロ（断熱）
- 濃度：遠方濃度固定、または流束ゼロ
- 位相場：$\nabla\phi\cdot \mathbf{n}_b=0$（自然境界）を基本として設定することが多い

### 7.3 初期条件
- 液相一様（$\phi=0$）に微小核（$\phi=1$）を埋め込む
- 温度（または濃度）を一様＋過冷却で与える
- 側枝を出したい場合、微小ノイズ（温度/濃度/位相）を入れる


## 8. 数値解法のポイント
### 8.1 空間離散
- FDM/FVM：実装が簡便、直交格子で高速
- FEM：曲面境界や適応メッシュに強い、並列化しやすい

目安（例）
- 界面厚み $W$ を 5〜10 格子点程度で解像する（$W/\Delta x \gtrsim 5$ を目安）
- 3次元は計算量が急増するため、まず2次元でパラメータ同定してから3次元へ拡張する

### 8.2 時間積分
- 明示法：実装容易だが安定条件が厳しい
- 半陰解法・陰解法：安定で大きな時間刻みが可能（ただし線形/非線形ソルバが必要）
- 反復解法：KKSの化学ポテンシャル拘束などがある場合、内部反復が必要になることがある


## 9. 何を評価するか（可視化と定量指標）
計算結果は見た目だけでなく、次の尺度で比較すると議論が締まる。

- 先端速度 $V_{\mathrm{tip}}(t)$
- 先端曲率半径 $R_{\mathrm{tip}}$
- 一次枝間隔（primary arm spacing）$\lambda_1$
- 側枝間隔、枝間偏析プロファイル
- 方向性凝固なら、セル/デンドライト遷移条件、柱状晶競合の統計

検証としては、同一条件で格子幅・時間刻みを変えた収束確認、既報ベンチマーク条件との比較を行うのが有効である。


## 10. 検証とベンチマーク
フェーズフィールドは実装差（補間関数、離散化、ソルバ）で結果が変わり得るため、コミュニティベンチマークを使ってV&V（verification & validation）を行うのが推奨である。

- デンドライト成長は特に数値実装に敏感であり、計算コードの品質確認に向く


## 11. CALPHAD連成・MIへの接続
- CALPHADの化学自由エネルギーを相の自由エネルギー $f_\alpha(c,T)$ として取り込み、より現実系（多成分）へ拡張する
- データ同化：その場観察（X線、光学）と合わせて、パラメータ（界面異方性、拡散係数など）を推定する
- サロゲートモデル：フェーズフィールドを“高価なシミュレータ”として、プロセス探索や逆問題をベイズ最適化・代理モデルで加速する

## まとめ
フェーズフィールド法によるデンドライト成長は、界面追跡を回避しつつ拡散場と界面異方性を一体で扱えるため、凝固組織形成の標準的シミュレーション基盤である。定量計算にはthin-interfaceに基づくパラメータ設定と、ベンチマークに基づくV&Vが不可欠であり、CALPHAD連成やMIと組み合わせることで実材料・実プロセスへの展開が加速するのである。
