# アモルファス固体の力学の計算方法

アモルファスでは、平均構造だけでは物性を説明しにくく、原子スケールの局所環境の分布と相関を追うことが要点である。ここでは、局所構造を定量化し、局所物性（エネルギー、応力、弾性、振動、電子・磁気）へ橋渡しする計算手法と解析の勘所を体系的にまとめる。

## 参考ドキュメント
- 非晶質合金の構造に関する最近の話題: AXS-RMC 法を用いたアプローチ
  https://tohoku.repo.nii.ac.jp/record/49777/files/1348-4052-2010-66%281-2%29-33.pdf
- 金属ガラスの材料科学
  https://www.jstage.jst.go.jp/article/jsms/58/3/58_3_187/_pdf
- ソフトウェアRMCProfileを用いた逆モンテカルロ法とEXAFSによる合金の局所構造解析
  https://support.spring8.or.jp/assets/materials/20240305_4.ishimatsu.pdf

## 0. ねらい

アモルファスの局所物性解析では、次の3点を同時に満たす必要がある。

1) 構造の不規則性が本質であるため、単一構造ではなく分布として扱うこと  
2) 「局所環境の指標」と「局所物性」を同一の原子集合上で対応づけること  
3) 生成・緩和・解析の全工程で、統計性（サンプル数、サイズ、時間）を担保すること  

## 1. 解析の基本方針

### 1.1 構造モデルの準備
代表的には溶融・急冷（melt–quench）を用いる。重要なのは、同一条件でも初期乱数や温度履歴で局所構造が揺らぐため、複数サンプルを作ることである。

- 熱履歴：溶融温度、保持時間、冷却速度、最終緩和（エネルギー最小化または低温緩和）
- 体積条件：NVT/NPTの選択（密度が局所配位に強く影響する）
- サイズ：中距離秩序や分布の裾を取るには原子数が必要である

補助的に、実験の全散乱（PDF）やEXAFSを拘束条件として、逆モンテカルロ（RMC）で構造を整合させる手もある（第6章）。

### 1.2 近接関係
ほぼ全ての局所指標は、近傍集合 $N(i)$ の定義に依存する。

- 距離カットオフ $r_c$（第1近接の谷位置など）
- 最近接 $k$ 個
- ボロノイ隣接（面共有）
- 重み付き近傍（距離重み、角度重み）

近傍定義がぶれると、局所秩序パラメータやクラスタ分類の解釈が崩れるので、最初に方針を決め、解析全体で固定するのがよい。

### 1.3 局所構造指標
局所構造の指標を複数用意し、互いの関係を見ることが有効である（同じ現象を別の観測窓から見る）。

- 配位数、部分RDF、結合角分布
- ボロノイ多面体指標
- CNA/ACNA、PTMなどの構造同定
- BOO（Steinhardtの $q_l$, $w_l$）
- リング統計、位相指標（必要に応じて）

### 1.4 局所物性を計算し、相関を作る
局所構造指標 $X(i)$ と、局所物性 $Y(i)$ を同じ原子 $i$ 上で対応づける。

- 局所エネルギー（原子エネルギー、凝集エネルギー分解）
- 局所応力（virial応力など）
- 局所弾性応答（局所剛性、非アフィン寄与、局所降伏指標）
- 局所振動（局在モード、参加率）
- 局所電子状態（局所DOS、電荷、ELF、局所ポテンシャル）
- 局所磁気（局所磁気モーメント、交換結合のばらつき）

### 1.5 表現と検証
局所物性は分布であり、以下をセットで提示するのが標準である。

- ヒストグラム（分布の幅、裾の重さ）
- 空間マップ（ホットスポットの連結性）
- 相関図（X–Y、条件別、温度別）
- サンプル間ばらつき（誤差帯、信頼区間）

## 2. 局所構造を定量化する指標

### 2.1 動径分布関数 $g(r)$ と配位数
アモルファスでも最も基本で、実験PDFとの接点にもなる。

- 動径分布関数
  $$
  g(r) \propto \left\langle \sum_{i\ne j}\delta(r-r_{ij}) \right\rangle
  $$

- カットオフ $r_c$ までの配位数
  $$
  N_c(r_c)=4\pi\rho \int_0^{r_c} r^2 g(r)\,dr
  $$

多元系では部分RDF $g_{αβ}(r)$ が効く。どの原子対の近接が局所クラスター形成に寄与するかが見える。

### 2.2 結合角分布・局所多面体の歪み
結合角分布は、正四面体・正八面体・正二十面体などの局所配位の特徴を反映する。ボロノイ多面体と併用すると解釈が強い。

### 2.3 ボロノイ多面体解析
原子 i の周りの空間分割から局所配位を分類する。代表的に、面数の組（ボロノイ指数）で記述する。

- ボロノイ指数の例
  $$
  \langle n_3, n_4, n_5, n_6, \dots \rangle
  $$
  ここで $n_k$ は k角形面の個数である。

金属ガラスでは正二十面体様の局所配位が議論されることが多く、ボロノイ指標はその定量化に向く。局所ひずみ（多面体の歪み尺度）と結びつけると、局所弾性や安定性との関係が追いやすい。

### 2.4 共通近接解析（CNA）と拡張（ACNA）
局所近接ネットワークのトポロジーから、FCC/HCP/BCC/アモルファス様環境などを判定する。変形・結晶化・界面の解析で強い。

- メリット：直感的な分類（結晶相の混在や欠陥の同定が容易）
- 注意点：近傍定義と熱揺らぎに敏感であるため、ACNAなどの工夫が有効である

### 2.5 Polyhedral Template Matching（PTM）
局所環境をテンプレート多面体に照合して分類する手法である。熱揺らぎやひずみに対して頑健性が高いことが多い。

- メリット：結晶相の識別が比較的安定、粒界・局所結晶化の解析に強い
- アモルファスでは：結晶的な局所秩序の芽（ナノ結晶核など）を抽出する用途で有効である

### 2.6 ボンド配向秩序（BOO）：Steinhardtの $q_l$, $w_l$
局所環境を球面調和関数で表現し、対称性の指紋を得る。

- 近傍平均の球面調和
  $$
  q_{lm}(i)= \frac{1}{N_b(i)}\sum_{j\in N(i)} Y_{lm}(\hat{\mathbf{r}}_{ij})
  $$
- 回転不変量
  $$
  q_l(i) = \sqrt{\frac{4\pi}{2l+1}\sum_{m=-l}^{l} |q_{lm}(i)|^2}
  $$

アモルファスでは $q_6$ が局所秩序の有用な指標になることが多いが、近傍定義の曖昧さが系統誤差になるため、ボロノイ隣接や重み付き定義と組み合わせるのがよい。

### 2.7 リング統計・位相解析
ネットワークガラス（酸化物など）ではリングサイズ分布が中距離秩序を表す。金属ガラスでも近傍ネットワークの位相量が有効な場合がある。

## 3. 局所力学物性

### 3.1 局所応力（virial応力）と内部応力
原子ごとの応力テンソルは、内部応力の不均一性を可視化する基本量である（定義は計算枠組みに依存するが、概念として以下が核である）。

- virial型（概念式）
  $$
  \sigma_{\alpha\beta} \sim -\frac{1}{V}\left(\sum_i m_i v_{i\alpha}v_{i\beta} + \frac{1}{2}\sum_{i\ne j} r_{ij,\alpha} f_{ij,\beta}\right)
  $$

アモルファスでは、熱履歴で内部応力分布が変わり、局所降伏やせん断帯の核生成と相関することがある。

### 3.2 非アフィン変位と $D^2_{min}$
外部変形に対して、原子近傍がアフィン変形からどれだけ外れたか（局所塑性の指標）を定量化する。

- $D^2_{min}$ の代表的定義
  $$
  D^2_{\min}(i) = \min_{\mathbf{J}}\sum_{j\in N(i)} \left|\Delta \mathbf{r}_{ij} - \mathbf{J}\mathbf{r}_{ij}\right|^2
  $$
ここで $J$ は近傍の最適線形変換である。

$D^2_{min}$ の大きい領域は、局所剪断変換（STZ）や塑性イベントと結びつくことが多く、せん断帯の予兆抽出に有効である。

### 3.3 局所弾性
アモルファスの弾性は、アフィン項だけでなく非アフィン緩和が本質である。完全な一般式を持ち込むより、次の実用的アプローチが扱いやすい。

- 微小ひずみを与え、エネルギー曲率や応力応答から局所弾性を推定する
- 空間分割（メゾスケール領域）で平均し、分布と空間相関長を評価する
- 局所構造指標（ボロノイ、$q_l$、配位数）との相関を作る

局所剛性の低い領域が塑性ホットスポットに一致するとは限らないため、内部応力や $D^2_{min}$ と合わせて多変量で判断するのがよい。

## 4. 局所振動・熱的性質

### 4.1 正準モード解析と局在度
局所物性として重要なのは、振動が局在しているか（あるいは準局在か）である。固有ベクトル $e_i$ から参加率を評価する。

- 参加率の一例
  $$
  p(\omega)=\frac{\left(\sum_i |e_i|^2\right)^2}{N\sum_i |e_i|^4}
  $$

$p$ が小さいモードは局在傾向が強く、欠陥様のソフトスポットや低温異常と結びつくことがある。局所構造（密充填か疎か、ボロノイ歪み、内部応力）との相関解析が有効である。

### 4.2 準局在モードとソフトスポット
低周波準局在モードは、塑性の起点に関わると考えられることがある。構造指標だけでなく、振動モード由来の指標を特徴量として用いるのが強い。

## 5. 局所電子物性：局所DOS・電荷・ポテンシャルの空間分布

### 5.1 局所DOS（LDOS）と近接環境
アモルファスでは局所環境の多様性がバンド端近傍やスピン分極の局在に影響し得る。局所DOSを原子ごと（あるいは領域ごと）に評価し、ボロノイ指数や$q_l$ と相関させると、構造起源の電子状態変化が見える。

- 典型的な解析
  - 原子種別・配位別の部分DOSを条件付き平均する
  - 高い局在度（IPRが大きい状態）を抽出し、その担い手原子の局所環境を統計化する

### 5.2 電荷解析・局所ポテンシャル
電荷（Baderなど）や局所ポテンシャルは、化学環境の不均一性を把握する入口である。アモルファスでは、同元素でも配位や結合相手の違いで分布が広がるため、平均値より分布（分散、歪度）を重視する。

- 一般的な読み方
  - 電荷の絶対値より、サイト間の相対差と相関を見る
  - 局所ポテンシャルは内殻準位シフトや分光の傾向と結びつけやすい場合がある

## 6. 実験拘束と構造モデル：RMCと全散乱・EXAFSの統合

### 6.1 逆モンテカルロ（RMC）の役割
RMCは、実験の構造因子 $S(Q)$ やPDF、EXAFSなどを再現するように原子配置を更新し、アモルファスの構造モデルを構築・改良する手法である。

- メリット
  - 実験データと整合する構造集合を得られる
  - 多元系や中距離秩序の議論を強化できる
- 注意点
  - 拘束が弱いと非物理的構造も許すため、最小距離制約、配位制約、ポテンシャル拘束（ハイブリッドRMC）などが重要になる
  - 得られるのは一意解ではなく、整合する構造集合であるという立場が重要である

### 6.2 AXS-RMCとボロノイ解析
異常散乱（AXS）など元素選択的情報を併用すると、部分RDFの分離が進み、局所配位多面体の統計が定まりやすくなる。RMCで得た構造をボロノイ解析にかけ、局所クラスター（例：正二十面体様配位）の頻度や空間相関を評価する枠組みが有効である。

## 7. 局所磁気物性：局所モーメント・相互作用の分布

アモルファス磁性では、局所配位と化学短距離秩序が局所モーメントや交換相互作用の分布を支配し得る。以下の方針が取りやすい。

- 局所モーメント $m_i$ の分布と、その担い手の局所環境分類（ボロノイ、配位数、$q_l$）
- 交換相互作用 $J_{ij}$ を推定し、距離依存・環境依存のばらつきを評価する
- スピンの非共線性や局所異方性を含める場合は、拘束計算や有効模型（Heisenberg型、ランダム異方性項）へ写像し、統計計算に持ち込む

磁気の局所秩序は、磁化の平均値よりも分布、相関長、履歴依存に現れやすいので、構造指標との多変量相関が特に重要である。

## 8. 局所物性を抽出する統計手法

### 8.1 条件付き平均
局所指標 $X$ により原子を分類し、物性 $Y$ を条件付き平均する。

- 例：ボロノイ指数別の平均原子エネルギー
- 例：$q_6$ の上位p%に属する原子の $D^2_{min}$ 分布

### 8.2 相関・回帰
- 相関係数、順位相関
- 多変量回帰、部分相関
- 次元削減（PCA/UMAPなど）で局所環境の多様性を可視化し、物性ホットスポットが潜在空間のどこに偏るかを見る

### 8.3 不確かさの扱い
アモルファスは自己平均性が弱いことがあるため、次を明示するのがよい。

- サンプル数、サイズ、冷却速度の違いに対する頑健性
- 同一指標でも近傍定義による差（系統誤差）
- 物性の分布が重い裾を持つ場合、平均より分位点（上位1%など）を報告する

## 9. 代表手法の比較表

| 手法カテゴリ | 代表指標 | 何が見えるか | 強み | 注意点 |
|---|---|---|---|---|
| 2体統計 | $g(r)$, $N_c$ | 近接距離と配位の平均像 | 実験PDFと直結 | 中距離秩序は見落としやすい |
| 幾何（空間分割） | ボロノイ指数 | 局所多面体と密充填度 | クラスター統計が強い | 熱揺らぎと境界の扱い |
| トポロジー分類 | CNA/ACNA, PTM | 結晶様/非晶質様の判定 | 変形や核生成に強い | 近傍定義に敏感 |
| 対称性の指紋 | $q_l$, $w_l$ | 局所対称性の連続量 | 微妙な秩序の検出 | 近傍曖昧性が系統誤差 |
| 力学ホットスポット | $D^2_{min}$, 局所応力 | 局所塑性・内部応力 | せん断帯の予兆 | 定義と平均化スケール |
| 振動局在 | 参加率 $p(ω)$ | 準局在モード | 欠陥様自由度の抽出 | 大規模計算が必要 |
| 電子局所量 | LDOS, 電荷, ポテンシャル | 化学環境の電子応答 | 分光傾向と接続 | 計算コストとサンプル数 |

## 10. まとめ

アモルファスの局所物性解析は、局所環境の指標を複数用意し、局所物性を同一原子集合上で対応づけ、分布と相関として評価することが核である。RDFやボロノイ、CNA/PTM、BOOなどで局所構造を定量化し、局所応力・$D^2_{min}$・振動局在・局所DOSや電荷などへ接続することで、平均量の背後にあるホットスポットとその起源が見える。さらに、実験拘束（PDF/EXAFS）とRMCを組み合わせ、構造モデルの妥当性を担保しつつ、統計的頑健性（サンプル集合）を確保することが、解釈可能な局所物性論へ至る近道である。

## 関連研究
1. Bond-orientational order（Steinhardtのq_lの原典）：https://link.aps.org/doi/10.1103/PhysRevB.28.784
2. D^2_{min}の源流（局所塑性イベントの定量化）：https://link.aps.org/doi/10.1103/PhysRevE.57.7192
3. 逆モンテカルロ（RMC）の原典：https://www.tandfonline.com/doi/abs/10.1080/08927028808080958
4. RMCによるガラス構造モデリング（Nature）：https://www.nature.com/articles/344423a0
5. RMCProfileマニュアル（全散乱・PDF拘束の実務的体系）：https://rmcprofile.ornl.gov/wp-content/uploads/2023/11/rmcprofilemanual.pdf
6. CNAの拡張と応用（ACNAの代表）：https://link.aps.org/doi/10.1103/PhysRevB.73.054104
7. 構造同定アルゴリズム概説（OVITO系の基盤）：https://www.osti.gov/servlets/purl/1260491
8. PTM（Polyhedral Template Matching）の代表的論文：https://arxiv.org/pdf/1603.05143
9. OVITOのPTM実装ドキュメント：https://www.ovito.org/manual/reference/pipelines/modifiers/polyhedral_template_matching.html
10. 局所環境表現（SOAPなど記述子の整理）：https://link.aps.org/doi/10.1103/PhysRevB.87.184115
11. GAP（機械学習ポテンシャルの基礎）：https://link.aps.org/doi/10.1103/PhysRevLett.104.136403
12. アモルファス構造とVoronoi多面体（日本語の基礎的説明）：https://www.jstage.jst.go.jp/article/materia1962/23/6/23_6_459/_pdf
13. AXS-RMCでのアモルファス局所構造（J-STAGEの例）：https://www.jstage.jst.go.jp/article/matertrans/62/1/62_MT-M2020246/_html/-char/en
