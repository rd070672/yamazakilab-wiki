# フェーズフィールド計算の原理
作成日：2025年11月23日

## 概要
- フェーズフィールド（Phase-Field）法は、**相境界や組織の「形」や「時間変化」を連続場として扱う**ための数値手法。
- 結晶粒成長、析出物形成、相変態、亀裂進展など、**界面をともなう現象**を「なめらかな界面（diffuse interface）」として表現する。
- 主な考え方：
  - 「どの相か」「どの組織か」を表す **オーダーパラメータ**（フェーズフィールド）を導入し、
  - その空間分布に対する**自由エネルギー汎関数**を定義し、
  - 「エネルギーを下げる方向の時間発展方程式」を解くことで、組織変化を再現する。

---

## オーダーパラメータと自由エネルギー
- オーダーパラメータ（order parameter）：
  - 例：\(\phi(\mathbf{r},t)\) を「相 A ↔ 相 B」を区別する変数とする。
  - \(\phi = 0\)：相 A、\(\phi = 1\)：相 B、**界面では 0〜1 の中間値**をとる。
  - 多相系・多結晶では、複数のフェーズフィールド \(\phi_1, \phi_2, \dots\) を導入することも多い。
- 自由エネルギー汎関数の一般形：
  \[
    F[\phi] = \int \left( f_\text{bulk}(\phi) + f_\text{grad}(\nabla \phi)
    + f_\text{elastic} + f_\text{chem} + \dots \right)\, dV
  \]
  - \(f_\text{bulk}\)：各相のバルク自由エネルギー（例：二重井戸ポテンシャル）
  - \(f_\text{grad}\)：界面エネルギーを表す勾配項（例：\(\frac{\kappa}{2}|\nabla\phi|^2\)）
  - \(f_\text{elastic}\)：弾性エネルギー（相変態や格子ミスマッチに伴う応力）
  - \(f_\text{chem}\)：溶質濃度など化学自由エネルギー

---

## 界面エネルギーと勾配項
- フェーズフィールド法の肝は「鋭い界面（sharp interface）」を「なめらかな幅を持つ界面」として扱うこと。
- 勾配エネルギー項：
  \[
    f_\text{grad} = \frac{\kappa}{2}|\nabla\phi|^2
  \]
  - \(\kappa\)：界面エネルギーと界面幅を決めるパラメータ。
  - \(|\nabla\phi|\) が大きい（＝相が急に変わる）領域にエネルギーコストを与えることで、自然に**有限幅の界面**が形成される。
- この表現により、界面の明示的なトラッキング（境界追跡）をせず、**計算格子全体で一様に PDE を解くだけで界面挙動を扱える**。

---

## 時間発展方程式（Allen–Cahn と Cahn–Hilliard）
- フェーズフィールドの時間発展は、「自由エネルギーの勾配に沿った緩和」として記述される。
- オーダーパラメータが**非保存量**か**保存量**かで方程式が異なる。

### 非保存オーダーパラメータ：Allen–Cahn 型
- \(\phi\) が「保存されない量」（例：結晶方位、相のラベル）のとき：
  \[
    \frac{\partial \phi}{\partial t} = -L \frac{\delta F}{\delta \phi}
  \]
  - \(L\)：モビリティ（運動係数）
  - \(\frac{\delta F}{\delta \phi}\)：機能微分（駆動力）
- これは自由エネルギーの「負の勾配方向」に時間発展する**勾配流（gradient flow）**の一種。

### 保存オーダーパラメータ：Cahn–Hilliard 型
- 濃度場 \(c(\mathbf{r},t)\) のように「全体量が保存される」場合：
  \[
    \frac{\partial c}{\partial t} = \nabla \cdot \left( M \nabla \mu \right),\quad
    \mu = \frac{\delta F}{\delta c}
  \]
  - \(M\)：拡散モビリティ
  - \(\mu\)：化学ポテンシャル
- 濃度が拡散とともに相分離（スピノーダル分解）していく過程を表現できる。

---

## 弾性場・拡散・他物理量との連成
- 材料の組織変化では、**応力場・拡散・温度場**などとの連成が重要：
  - 弾性場：相変態による体積変化や変態ひずみ → 応力集中 → 組織進化。
  - 濃度場：拡散による組成変化 → 化学自由エネルギー変化 → 析出物成長・相分離。
  - 温度場：温度勾配 → 熱応力・相境界移動速度の変化。
- これらは多くの場合、  
  - 弾性場：線形弾性（平衡方程式）  
  - 拡散：拡散方程式  
  - 熱：熱伝導方程式  
  を**フェーズフィールド方程式と同時に解く「連成 PDE 系」**として扱う。

---

## 数値計算の枠組み
- 離散化手法：
  - 有限差分法 (FDM)
  - 有限要素法 (FEM)
  - スペクトル法（FFT を利用した高速畳み込み）
- 手順のイメージ：
  1. 時刻 \(t\) の \(\phi(\mathbf{r})\) や \(c(\mathbf{r})\) から自由エネルギー密度とその変分 \(\delta F/\delta\phi\) を計算。
  2. Allen–Cahn / Cahn–Hilliard 方程式を時間積分して \(\phi(t+\Delta t)\), \(c(t+\Delta t)\) を更新。
  3. 必要に応じて弾性場・拡散場の PDE も同時に解く。
  4. これを繰り返して、組織の時間発展を追跡。
- 境界条件：
  - 多くの場合周期境界条件（バルク材料を模擬）
  - 固有境界・界面条件を与える場合もある（表面・界面問題）。

---

## MD／MC との違いと補完関係
- MD（分子動力学）：
  - 原子一つ一つの運動を追う「ミクロな記述」。
  - フェーズフィールドは「連続体レベルの coarse-grained 記述」。
- MC（モンテカルロ）：
  - 統計力学的なサンプリングに基づき、平衡状態や相図を評価。
  - フェーズフィールドは「**時間発展・非平衡過程**（成長・競合・粗視化）の解析」に強い。
- 補完的な使い方：
  - MD／第一原理から自由エネルギー・界面エネルギー・弾性定数などのパラメータを取得し、
  - それをフェーズフィールドの自由エネルギー汎関数に組み込んで「ミクロに整合した連続体モデル」とする。

---

## フェーズフィールド法の利点と限界
- 利点：
  - 明示的に界面を追跡せず、複雑なトポロジー変化（粒の合体・分裂、析出物の消滅）を自然に扱える。
  - 相変態・析出・粒成長・亀裂など、さまざまな現象を統一的な枠組みで扱える。
  - 多物理場連成（弾性・拡散・電場・磁場など）との相性がよい。
- 限界：
  - 界面を「有限幅」で表現するため、**界面幅を再現するのに十分なメッシュ分解が必要** → 計算コストが大きくなりがち。
  - 自由エネルギー汎関数の形やパラメータにモデル依存性がある（実材料へのフィットが重要）。
  - 絶対的な時間スケールとの対応（物理時間とのマッピング）が難しい場合もある。