# フェーズフィールドクリスタル（PFC）法の基礎と応用 

Phase-Field Crystal（PFC）法は、結晶格子を内包する連続場（密度場）を用いて、原子スケールの空間分解能を保ちながら拡散時間スケールでの組織進化（粒界移動、転位、結晶成長など）を記述する枠組みである。起源は結晶成長における弾性効果を原子スケールで取り込む目的で提案されたモデルに遡る。

## 参考ドキュメント
1. H. Emmerich et al., Phase-field-crystal models for condensed matter dynamics on atomic length and diffusive time scales: an overview, arXiv:1207.0257 (2012).
   https://arxiv.org/abs/1207.0257
2. K. R. Elder et al., Modeling Elasticity in Crystal Growth, Phys. Rev. Lett. 88, 245701 (2002).
   https://doi.org/10.1103/PhysRevLett.88.245701
3. 山中 晃徳, フェーズフィールドクリスタル法による多結晶粒成長シミュレーション, 計算力学講演会講演論文集 2018.31, Session 067（J-STAGE, 2019公開）.
   https://www.jstage.jst.go.jp/article/jsmecmd/2018/31/2018_067/_article/-char/ja/


## 1. フェーズフィールドクリスタル（PFC）法が埋めるギャップ
結晶の原子配列を直接追跡する分子動力学（MD）は、原子振動の時間刻み（おおむねフェムト秒）に拘束され、拡散や粒成長のような長時間現象を扱いづらい。一方、フェーズフィールド（PF）は長時間・大域組織には強いが、格子・転位核のような原子配置そのものを秩序変数としては持たない。

PFC は「結晶を周期密度として表す」ことで、原子配列（格子周期）を表現しつつ、時間発展は拡散律速（オーダーパラメータ保存型）として与える。結果として、粒界、転位、弾性ひずみ場、欠陥相互作用を同一の場のダイナミクスとして統一的に扱えるようになる。

## 2. 基本変数：密度偏差（秩序変数）と結晶格子
PFC の主変数は、平均密度 $\rho_0$ からの偏差を規格化した密度場 $n(\mathbf{r},t)$（文献により $\psi$ とも書く）である。結晶相では $n$ が空間的に周期構造を持ち、その周期が格子定数に対応する。液相では $n$ はほぼ一様（小さな揺らぎを含む）となる。

「結晶＝周期密度」という考え方は古典密度汎関数理論（classical DFT of freezing）や動的密度汎関数理論（DDFT）との接続を強く示唆し、PFC はその近似・縮約モデルとして理解されることが多い。

## 3. 自由エネルギー汎関数：Swift–Hohenberg 型の典型形
最も基本的な PFC は、結晶の臨界波数 $q_0$ 近傍のモードが自発的に立ち上がるような自由エネルギーを採用する。無次元化すると、例として次の形が広く使われる。

$$
F[n] = \int d\mathbf{r}\left[
\frac{1}{2}n\left(r + (1+\nabla^2)^2\right)n
+ \frac{1}{4}n^4
\right].
$$

- $r$ は過冷却度や相安定性に対応する制御パラメータである
- $(1+\nabla^2)^2$ は特定波数（格子周期）を選好する演算子である

合金・多成分・複数結晶構造（fcc/bcc など）に対応するため、二つ以上のモードを導入した二モードPFCや、相関関数を明示的に入れる拡張（XPFC系）などが多数提案されている。

## 4. 時間発展：保存型ダイナミクス
PFC の標準的な時間発展は、密度場の保存則を反映した勾配流（Model B 型）として与えられる。

$$
\frac{\partial n}{\partial t} = \nabla^2 \frac{\delta F}{\delta n} + \eta(\mathbf{r},t).
$$

- $\delta F/\delta n$ は化学ポテンシャルに相当する
- $\eta$ は熱ゆらぎを模すノイズ項（目的により省略される）である

この形式により、原子振動を追跡せずに拡散律速の欠陥運動や粒界移動を表現できる、というのが PFC の中核である。

## 5. 弾性・転位が自然に出る理由：位相と振幅の表現
結晶中の密度場は、主要な逆格子ベクトル $\{\mathbf{q}_j\}$ によるモード展開で直観化できる。

$$
n(\mathbf{r}) \approx \sum_j A_j(\mathbf{r}) e^{i\mathbf{q}_j\cdot(\mathbf{r}-\mathbf{u}(\mathbf{r}))} + c.c.
$$

- 変位場 $\mathbf{u}(\mathbf{r})$ の空間変化がひずみを与える
- 転位は位相の特異点（不連続）として現れ、転位芯・バーガースベクトルが場の位相幾何として表現される

この見方は、PFC を振幅方程式（amplitude equation）へ縮約して大規模化する流れとも直結する。

## 6. 代表的な拡張モデル

| 目的 | 代表的拡張 | 典型的に可能になること |
|---|---|---|
| 多成分・規則相 | binary/alloy PFC、ordered PFC | 濃度場と格子欠陥の相互作用、規則化・析出と転位の競合 |
| fcc/bcc など構造多様性 | two-mode PFC など | 結晶構造の選択・変換を組織進化と一体で扱う |
| 弾性波っぽい効果 | MPFC（修正PFC） | 速い応力緩和の近似的導入（ただし真のフォノンとは異なる） |
| 多スケール化 | 振幅方程式・RG | 粒界ネットワーク等の巨大系へ展開 |

## 7. なぜ FFT 系が好まれるか
自由エネルギーに高次の空間微分（例：$(1+\nabla^2)^2$）が現れるため、空間離散ではスペクトル法（FFT）や疑似スペクトル法が相性が良い。時間積分は、線形項を半陰的に扱うことで安定性と計算効率を稼ぐ設計が多い。

3次元では計算コストが急増するため、GPU・並列化の工夫が重要になる。国内例として、bcc鉄の3次元多結晶粒成長を対象に、複数GPU計算コードを整備して大規模PFCを実施した報告がある（Reedbush上での実行、粒界曲率駆動の粗大化、成長指数評価など）。

## 8. 何が予測でき、何に注意が要るか

### 8.1 予測できる代表例
- 粒界移動・粒成長（曲率駆動、粒回転の伴随など）
- 転位の生成・運動・相互作用（塑性の素過程の一部）
- エピタキシャル成長、界面のミスフィットと弾性緩和
- 濃度場と欠陥の相互作用（合金系PFCの拡張）

### 8.2 注意点
- 実単位へのマッピングが自明でないことが多い（$r$、時間尺度、拡散係数の対応付けなど）
- 物理的な「フォノン時間」を直接扱う理論ではない（拡散時間に重心がある）
- 自由エネルギーの形（モード数、非線形項、相関関数の与え方）で相図・欠陥エネルギーが大きく変わる
- 金属・酸化物など実材料への定量適用では、古典DFT/DDFTや第一原理計算との接続（弾性定数、界面エネルギー、格子定数、欠陥形成エネルギー）をどう取るかが支配的課題になりやすい

## 9. 他手法との比較

| 手法 | 空間分解能 | 時間スケール | 欠陥（転位・粒界） | 熱力学的一貫性 | 主なボトルネック |
|---|---:|---:|---:|---:|---|
| 第一原理（DFT） | 電子〜原子 | 静的/準静的 | 欠陥は可（ただし系サイズ制約） | 高い | 系サイズ・計算コスト |
| AIMD | 原子 | fs〜ps（〜nsは厳しい） | 可 | 高い | 時間が届かない |
| 古典MD | 原子 | fs〜ns（条件次第） | 可 | ポテンシャル依存 | ポテンシャル品質・時間 |
| PF | メゾ | ms〜 | 欠陥は経験的 | 高い（モデル次第） | 格子欠陥の直接表現が難しい |
| PFC | 原子格子〜メゾ | 拡散時間（長い） | 自然に出る | 近似の仕方次第 | パラメータ同定・3D計算量 |

PFC を「原子配列を持つ連続体」とみなし、MDでは届かない時間領域の欠陥・組織進化を狙うのが基本方針である。

## まとめ
Phase-Field Crystal（PFC）法は、周期密度場という記述により格子・欠陥を内包したまま、拡散時間スケールでの組織進化を追跡できる方法論である。定量化の鍵は、自由エネルギー形とパラメータ同定（古典DFT/DDFTや第一原理計算との接続）にあり、3次元大規模化ではFFTと並列化が本質的となる。
