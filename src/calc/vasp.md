# 第一原理計算の原理
作成日：2025年11月23日

## 概要
- 第一原理計算（ab initio 計算）は、**「実験パラメータに頼らず、量子力学の基本方程式から物性を求める」**ことを目標とした電子構造計算手法の総称である。
- 固体・分子・表面・界面などに対して、
  - 全エネルギー・構造最適化
  - バンド構造・状態密度（DOS）
  - 力・応力・フォノン・磁気モーメント
  などを、量子力学と統計力学の枠組みに基づいて求める。
- 現在、実用レベルで最も広く用いられているのは **密度汎関数理論（DFT, Density Functional Theory）** に基づく手法である。

## 多体シュレーディンガー方程式とその困難さ
- 電子と原子核からなる系の厳密な記述は、多体シュレーディンガー方程式：
  $$
    \hat{H}\Psi(\mathbf{r}_1,\dots,\mathbf{r}_N;\mathbf{R}_1,\dots,\mathbf{R}_M)
    = E\Psi(\dots)
  $$
  - $\hat{H}$：電子・原子核の運動エネルギー＋クーロン相互作用を含むハミルトニアン
  - $\Psi$：全電子＋全原子核の波動関数（多体波動関数）
- 電子数・原子数が増えると、$\Psi$ の自由度は指数的に増大し、**厳密解は実用的に不可能**。
- 第一原理計算では、物理的に妥当な近似を導入しながら、この多体問題を「扱える形」に落とし込む。

## Born–Oppenheimer 近似（電子と原子核の分離）
- 原子核は電子に比べてはるかに重く、運動が遅い。
- そのため、多くの場合：
  - **原子核（イオン）の位置を固定**した上で電子系の基底状態を求める → そのエネルギーを「ポテンシャルエネルギー面」とみなす。
  - この近似を **Born–Oppenheimer 近似** と呼ぶ。
- 手順イメージ：
  1. 格子定数・原子位置 $\{\mathbf{R}_I\}$ を与える。
  2. この固定イオン配置で電子系の基底状態エネルギー $E_\text{elec}[\{\mathbf{R}_I\}]$ を計算。
  3. $E_\text{tot} = E_\text{elec} + E_\text{ion-ion}$ から力・応力を計算し、イオン配置を更新（構造最適化、MD など）。

## 密度汎関数理論（DFT）の基本
- 多体電子系の基底状態問題を、**電子密度 $\rho(\mathbf{r})$** の問題に書き換えるのが DFT の基本思想。
- Hohenberg–Kohn 定理（ざっくり）：
  1. 基底状態の電子密度 $\rho(\mathbf{r})$ は、外部ポテンシャル $V_\text{ext}(\mathbf{r})$ を一意に決定する。
  2. 基底状態エネルギーは、電子密度の汎関数 $E[\rho]$ を最小化することで得られる。
- しかし、厳密なエネルギー汎関数 $E[\rho]$ の形は分かっていないため、**近似汎関数（交換–相関汎関数）** を導入する。

## Kohn–Sham 方程式
- 実際の多体電子系を、**同じ密度をもつ「非相互作用電子系」** に写像するのが Kohn–Sham スキーム。
- 有効一電子方程式：
  $$
    \left[
      -\frac{\hbar^2}{2m}\nabla^2
      + V_\text{eff}(\mathbf{r})
    \right]
    \psi_{n\mathbf{k}}(\mathbf{r})
    = \varepsilon_{n\mathbf{k}} \psi_{n\mathbf{k}}(\mathbf{r})
  $$
  ここで
  $$
    V_\text{eff}(\mathbf{r})
    = V_\text{ext}(\mathbf{r})
      + V_\text{H}(\mathbf{r})
      + V_\text{xc}(\mathbf{r})
  $$
  - $V_\text{ext}$：原子核・イオンによるポテンシャル
  - $V_\text{H}$：電子–電子の古典クーロン相互作用（Hartree ポテンシャル）
  - $V_\text{xc}$：量子力学的な交換・相関効果をまとめた「交換–相関ポテンシャル」
- 電子密度は、占有された Kohn–Sham 軌道から：
  $$
    \rho(\mathbf{r})
    = \sum_{n,\mathbf{k}} f_{n\mathbf{k}} |\psi_{n\mathbf{k}}(\mathbf{r})|^2
  $$
- DFT の「近似」は主に **交換–相関汎関数 $E_\text{xc}[\rho]$** の形（LDA, GGA, +U, ハイブリッドなど）に入る。

## 擬ポテンシャル・PAW 法によるコア電子の扱い
- 内殻電子は化学結合・物性に与える影響が小さいことが多く、**計算コスト削減のため「有効ポテンシャル」に置き換える**。
- 擬ポテンシャル（Pseudopotential）：
  - 原子核 + コア電子の効果を「滑らかな有効ポテンシャル」で表現。
  - 価電子波動関数だけを平面波展開しやすくする。
- PAW（Projector Augmented Wave）法：
  - 原子近傍では全電子波動関数を再構成できるような枠組み。
  - 全電子計算に近い精度と、平面波法の効率性を両立。

## 平面波基底・周期境界条件・k 点サンプリング
- 固体・周期系では、ブロッホの定理により波動関数は
  $$
    \psi_{n\mathbf{k}}(\mathbf{r})
    = e^{i\mathbf{k}\cdot\mathbf{r}} u_{n\mathbf{k}}(\mathbf{r})
  $$
  と書ける。
- $u_{n\mathbf{k}}(\mathbf{r})$ を平面波で展開：
  $$
    u_{n\mathbf{k}}(\mathbf{r})
    = \sum_\mathbf{G} C_{n\mathbf{k}}(\mathbf{G})
      e^{i\mathbf{G}\cdot\mathbf{r}}
  $$
  - $\mathbf{G}$：逆格子ベクトル。
  - 展開の打ち切りにはエネルギーカットオフ $E_\text{cut}$ を設定。
- Brillouin ゾーン内の $\mathbf{k}$ 点を有限個にサンプリング（Monkhorst–Pack など）して、電子密度・エネルギーを求める。

## 自己無撞着場（SCF）計算の流れ
- DFT 計算は、**「電子密度」と「有効ポテンシャル」が互いに依存する」**ため、自己無撞着解を探す反復法になる。
- 典型的な SCF ループ：
  1. 初期電子密度 $\rho^{(0)}(\mathbf{r})$ を仮定（原子の重ね合わせなど）。
  2. $\rho^{(n)}$ から有効ポテンシャル $V_\text{eff}^{(n)}$ を構成。
  3. Kohn–Sham 方程式を解いて軌道 $\psi_{n\mathbf{k}}^{(n)}$、固有値 $\varepsilon_{n\mathbf{k}}^{(n)}$ を得る。
  4. それらから新しい密度 $\rho^\text{new}(\mathbf{r})$ を計算。
  5. ミキシング（線形混合など）で $\rho^{(n+1)} = (1-\alpha)\rho^{(n)} + \alpha \rho^\text{new}$ と更新。
  6. $\rho^{(n+1)}$ と $\rho^{(n)}$ の差、全エネルギーの変化などが所定の閾値以下になれば収束。
- 収束後の電子密度・波動関数を用いて、力・応力・各種物理量を評価する。

## 第一原理計算で得られる代表的な物理量
- 基底状態エネルギー・安定構造：
  - 格子定数・内部座標の最適化、エネルギー比較による安定相の判定。
- バンド構造・状態密度（DOS, PDOS）：
  - 金属／半導体／絶縁体の判別、ギャップ、バンドディスパージョン。
- 力・フォノン：
  - ヘルマン–ファインマン力から原子の力を計算 → 構造最適化・MD・フォノン計算（phonopy 等）。
- 磁気モーメント・スピン分極：
  - スピン偏極 DFT（collinear / noncollinear）、スピン軌道相互作用 (SOC) を含む計算。
- 応力・弾性定数：
  - 応力テンソルから弾性定数、体積弾性率など。
- その他：
  - 電子密度分布・電荷移動（Bader 解析）、電場応答、誘電率、ワナイヤ電荷、トポロジカル不変量など。

## 他の第一原理手法との関係
- ハートリー–フォック (HF) 法：
  - 相互作用電子系を単一スレーター行列式で近似し、交換を厳密に取り扱うが相関は含まない。
- ポスト HF（CI, CC, MP2 など）：
  - 分子計算で高精度だが固体への適用は非常に高コスト。
- GW 近似・BSE：
  - 準粒子エネルギー、励起状態・光学応答を扱う第一原理手法。
- 実務上：
  - 多くの固体・材料物性研究で **DFT をベース**とし、
    - 必要に応じて +U, ハイブリッド、GW, DMFT などを組み合わせて精度を高める。

## MD・フェーズフィールド・MC との接続
- 第一原理計算は、より大きなスケールのシミュレーションに対して **「パラメータ供給源」** として重要：
  - 原子間ポテンシャル・フォースフィールドの構築（MD 用）
  - クラスター展開・スピン模型のパラメータ（MC 用）
  - 自由エネルギー・界面エネルギー・弾性定数（フェーズフィールド用）
- これにより、
  - 第一原理 → 有効模型 → 大規模・長時間シミュレーション
  という**マルチスケールモデリング**が可能になる。

