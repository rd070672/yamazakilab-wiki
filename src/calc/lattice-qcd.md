# 格子QCDシミュレーション入門

格子上に量子色力学(QCD)を離散化し、モンテカルロサンプリングで非摂動領域の物理量を数値的に評価する枠組みである。生成(アンサンブル作成)と測定(相関関数解析)を分離できる点が特徴であり、有限温度や散乱・相互作用にも系統的に拡張できる。

## 参考ドキュメント
- S. Duane, A. D. Kennedy, B. J. Pendleton, D. Roweth, Hybrid Monte Carlo, Phys. Lett. B 195 (1987) 216–222. https://www.sciencedirect.com/science/article/pii/037026938791197X
- H. Matsufuru, Introduction to Lattice QCD simulations (講義ノート, PDF). 
  https://research.kek.jp/people/matufuru/Research/Docs/Lattice/Introduction/note_lattice.pdf
- 中村 純, 格子QCDシミュレーション入門 —パソコンの上で格子場を楽しむことを目標に— (素粒子論研究 電子版, PDF). 
  https://www2.yukawa.kyoto-u.ac.jp/~soken.editorial/sokendenshi/vol18/3/yamada.pdf

## 1. ねらいと位置づけ
QCDは高エネルギーでは摂動論が有効である一方、低エネルギー(ハドロン質量、閉じ込め、カイラル対称性の自発的破れなど)は結合が強く非摂動的である。格子QCDは、場の理論を有限自由度の統計力学系に写像し、重要度サンプリング(importance sampling)で期待値を計算する。

代表的な対象は以下である。
- スペクトル：ハドロン質量、励起状態、混成状態
- 行列要素：崩壊定数、形状因子、弱行列要素
- 有限温度：相転移/クロスオーバー、状態方程式(EOS)、輸送係数の制約
- 散乱・相互作用：位相シフト、束縛状態、核力/ハイペロン力など

## 2. 連続理論からユークリッド路積分へ
連続のQCDは(簡略化して)ゲージ場A_μ^aとクォーク場ψ_fで記述される。
- 共変微分：$D_\mu = \partial_\mu - ig A_\mu$
- 場の強さ：$F_{\mu\nu} = \frac{i}{g}[D_\mu, D_\nu]$

ユークリッド時間にWick回転($t \to -i\tau$)すると、分配関数(生成汎関数)は
$$
Z = \int \mathcal{D}U\,\mathcal{D}\bar\psi\,\mathcal{D}\psi \;
\exp\{-S_g[U]-S_f[\bar\psi,\psi,U]\}
$$
となり、統計力学の形(重みが正であれば)に近づく。有限温度はユークリッド時間方向の周期境界条件で実装でき、温度は後述のように $T=1/(N_t a)$ で与えられる。

## 3. 格子化の基本：リンク変数とプラケット
4次元超立方格子(格子間隔a)を取り、ゲージ場はリンク変数
$$
U_\mu(x) \in SU(3)
$$
で表す。$U_\mu(x)$は点xからx+μ方向への平行移動(ゲージ共変)を担う。

最小ループであるプラケットは
$$
U_{\mu\nu}(x)=U_\mu(x)\,U_\nu(x+\hat\mu)\,U_\mu^\dagger(x+\hat\nu)\,U_\nu^\dagger(x)
$$
で定義され、これが曲率(場の強さ)に対応する。

### 3.1 ウィルソン(プラケット)ゲージ作用
代表的なゲージ作用はWilson作用である。
$$
S_g[U] = \beta \sum_{x}\sum_{\mu<\nu}\left(1-\frac{1}{3}\Re\mathrm{Tr}\,U_{\mu\nu}(x)\right),
\quad \beta=\frac{6}{g^2}.
$$
連続極限$a\to0$でYang–Mills作用に一致するよう設計されている。改良作用(矩形ループを加えたSymanzik改良など)を用いると、格子誤差の高次項を抑えられる。

### 3.2 フェルミオン作用と行列$D[U]$
クォークは格子ディラック演算子 $D[U]$ を用いて
$$
S_f = \sum_{x,y}\bar\psi(x)\,D[U](x,y)\,\psi(y)
$$
と書く。フェルミオンは反交換変数であるため、まず積分して
$$
Z = \int \mathcal{D}U\;(\det D[U])\;e^{-S_g[U]}
$$
の形にするのが基本である。実際は数値安定性から $\det(D^\dagger D)$ を用いることが多い。

## 4. フェルミオン倍増問題と離散化
単純離散化はフェルミオン倍増(ドブリング)を引き起こすため、種々の定式化がある。

| 離散化 | ねらい/特徴 | 利点 | 注意点 |
|---|---|---|---|
| Wilson | 倍増をWilson項で除去 | 実装が素直 | カイラル対称性が有限aで破れる(改良で抑制) |
| Clover改良(Wilson改良) | $O(a)$誤差の低減 | 連続外挿が安定 | 係数チューニングが必要な場合あり |
| Staggered | 倍増を“味”(taste)として整理 | 高速・大規模に強い | taste分裂、ルート手法など流儀が分かれる |
| Twisted mass | Wilson系の改良・数値安定 | 近接臨界で安定化 | 明示的フレーバー対称性の扱い |
| Domain-wall | 5次元で近似的カイラル対称性 | カイラル性が良い | 計算コストが大きい |
| Overlap | 格子カイラル対称性を厳密に実現 | 対称性が最良 | 非局所演算(符号関数)が重い |

カイラル対称性と倍増の緊張関係は、ギンスバーグ–ウィルソン関係
$$
\gamma_5 D + D\gamma_5 = a\,D\gamma_5 D
$$
を満たす離散化(overlap等)で整理される。

## 5. HMC(ハイブリッド・モンテカルロ)
### 5.1 基本構造
期待値は
$$
\langle \mathcal{O}\rangle
= \frac{1}{Z}\int \mathcal{D}U\;\mathcal{O}[U]\;(\det D[U])\;e^{-S_g[U]}
$$
である。巨大自由度(格子点×リンク×SU(3))のため、確率分布に従う標本(ゲージ配位)をマルコフ連鎖で生成する。

### 5.2 擬フェルミオン
$\det D$ は非局所で扱いにくいので、擬フェルミオン場$\phi$を導入して
$$
\det(D^\dagger D)\propto
\int \mathcal{D}\phi^\dagger\mathcal{D}\phi\;
\exp\{-\phi^\dagger(D^\dagger D)^{-1}\phi\}
$$
と書き換える。以後、作用はゲージ場と擬フェルミオンの有効作用の和になる。

### 5.3 HMCの流れ
HMCは連続変数を持つ格子系で広く用いられる。
1. 各リンクに共役運動量Pを導入し、ハミルトニアン $H=S_\mathrm{eff}[U,\phi]+P^2/2$ を作る
2. ハミルトン方程式に従い、仮想時間の分子動力学(MD)で(U,P)を更新する(例：leapfrog)
3. 離散積分誤差をメトロポリス受理・棄却で補正し、詳細釣合いを満たす

MDの時間刻み$\Delta\tau$や軌道長は、受理率・自己相関・計算コストの兼ね合いで調整する。

### 5.4 高速化要素
大規模化の律速は多くの場合、ディラック演算子の反転(線形ソルバー)である。代表的改善は以下である。
- 前処理：even-odd、質量前処理(Hasenbusch)、多段時間刻み
- ソルバー：Krylov(CG, BiCGStab)、deflation、アルゴリズム的マルチグリッド
- 加速：GPU(Dirac演算子・ソルバー)の最適化
- 臨界緩和/トポロジカル凍結：境界条件(open boundary)などの工夫

## 6. 測定
### 6.1 ハドロン相関関数
時間方向相関関数の基本は
$$
C(t)=\sum_{\vec x}\langle 0|\,\mathcal{O}(\vec x,t)\,\mathcal{O}^\dagger(\vec 0,0)\,|0\rangle
$$
である。十分大きいtで基底状態が支配し
$$
C(t)\sim A\left(e^{-mt}+e^{-m(N_t-t)}\right)
$$
(周期/反周期境界を考慮)となる。ここから有効質量
$$
m_\mathrm{eff}(t)=\ln\frac{C(t)}{C(t+1)}
$$
などでスケールを推定し、最終的にフィットで質量mや行列要素を得る。

統計誤差はjackknifeやbootstrapで評価し、自己相関を考慮してビン幅を取ることが重要である。

### 6.2 静的クォークポテンシャルと閉じ込め
ウィルソンループ$W(R,T)$の期待値から静的ポテンシャルを
$$
V(R)=-\lim_{T\to\infty}\frac{1}{T}\ln\langle W(R,T)\rangle
$$
で定義できる。長距離での線形ポテンシャルや弦張力は閉じ込めの指標となる。

## 7. 有限温度：$T=1/(N_t a)$ と相転移
有限温度は時間方向の格子点数$N_t$で制御され、
$$
T=\frac{1}{N_t a}
$$
である。$N_t$を固定してaを変える(連続外挿と整合)か、aを固定して$N_t$を変えるかは、研究目的と系統誤差の扱いで選ぶ。

代表的観測量は以下である。
- ポリヤコフループ：デコンファインメントの指標
- カイラル凝縮 $\langle\bar\psi\psi\rangle$：カイラル対称性の指標
- エネルギー密度・圧力：状態方程式(EOS)

## 8. 散乱・相互作用：Lüscher法とHAL QCD法
### 8.1 Lüscher有限体積法(位相シフト)
有限体積L×L×Lにおける二体エネルギー準位のずれから散乱位相シフトを得る。代表式(例：S波)は
$$
k\cot\delta(k)=\frac{2}{\sqrt{\pi}L}\,Z_{00}(1;q^2),\quad q=\frac{kL}{2\pi}
$$
である。ここで$Z_{00}$は一般化ゼータ関数であり、有限体積スペクトルと無限体積散乱の橋渡しをする。

### 8.2 HAL QCD法
Nambu–Bethe–Salpeter(NBS)波動関数を用いて、エネルギー非依存・非局所ポテンシャル(核)を格子から抽出し、無限体積のシュレーディンガー方程式を解いて位相シフトや束縛を得る方法である。多チャネル・非弾性閾値近傍への拡張も議論されている。

## 9. 有限密度と符号問題(サイン問題)
バリオン化学ポテンシャル$\mu$を入れるとフェルミオン行列式が一般に複素となり、重みが確率解釈できない(符号問題)。そのため単純な重要度サンプリングが破綻する。

代表的回避・近似戦略は以下である。
- $\mu=0$まわりのテイラー展開(高温や小$\mu$)
- 虚数化学ポテンシャルで計算して解析接続
- 再重み付け：
$$
\langle O\rangle_\mu=\frac{\langle O\,e^{-(S_\mu-S_0)}\rangle_0}{\langle e^{-(S_\mu-S_0)}\rangle_0}
$$
- 複素ランジュバン法、レフシェッツ・シンブル(複素積分経路)

符号問題は、強相関多体系の量子モンテカルロでも同様に現れる根源的難問であり、近年はアルゴリズム・機械学習・数理的手法の交差領域として研究が活発である。

## 10. 系統誤差の設計
格子QCDの結果は、以下の極限と補正を通して物理量へ接続する。
- 連続極限：$a\to0$ (離散化誤差)
- 無限体積：$L\to\infty$ (有限体積効果)
- 物理点：$m_{u,d,s,\dots}$ を実世界に合わせる(クォーク質量)

実用上の指標として $m_\pi L \gtrsim 4$ がよく用いられ、有限体積効果を抑える目安となる(問題に依存する)。

| 系統要因 | 症状 | 代表的対策 |
|---|---|---|
| 格子間隔a | 物理量がaに依存 | 複数aで外挿、改良作用/改良演算子 |
| 体積L | 低エネルギーでずれ | Lを増やす、有限体積補正、$m_\pi L$設計 |
| クォーク質量 | 物理点からのずれ | 物理点近傍での補間、カイラル摂動論との併用 |
| 自己相関 | エラーバー過小 | 長い鎖、ビニング、統計的診断 |
| トポロジー凍結 | 低aで遷移が起きない | open boundary、アルゴリズム改善 |

スケール設定には、ハドロン質量、静的ポテンシャル、あるいはgradient flow由来のスケール($t_0,w_0$など)がしばしば用いられる。

## 11. ソフトウェア、GPU、データ共有(ILDG/JLDG)
大規模計算では、コードの保守性と性能の両立が重要となる。代表的な構成要素は
- 配位生成(HMC/RHMC)
- 伝搬関数計算(ソルバー、前処理、deflation)
- 測定(相関関数、収束判定、統計処理)
- 解析(フィット、連続/体積/物理点外挿)

GPU利用では、ディラック演算子・ソルバーを高速化するQUDAが広く使われる。コード基盤としては、Bridge++(国内での開発事例)やGrid/Chroma/MILC/openQCDなどがある。

配位(ゲージアンサンブル)は生成コストが非常に高いため、国際的にはILDG、国内ではJLDGが共有基盤として機能している。メタデータとバイナリを標準化し、再利用・検証・引用可能性を高めることが重要である。

## 12. 計算ワークフロー
1. 目的設定：スペクトル/EOS/散乱/行列要素など、必要な物理量と精度を定める  
2. 作用とパラメータ選択：ゲージ作用、フェルミオン離散化、$a,L,N_t$、クォーク質量  
3. 配位生成：熱化(thermalization)→測定間隔を取りながら保存、自己相関を診断  
4. 伝搬関数：ソルバー収束の管理、ソース/シンクの工夫(スメアリング等)  
5. 相関関数構築：演算子選択、対称性(運動量・表現)を反映  
6. 統計解析：jackknife/bootstrap、自己相関に配慮したビニング  
7. 系統評価：a外挿、体積依存、物理点補間、励起混入の評価  
8. 共有と再現性：メタデータ整備、データ共有基盤(ILDG/JLDG等)の活用  

## 13. 周辺領域との接続
格子上のゲージ理論は、離散化・有限サイズスケーリング・相転移・マルコフ連鎖モンテカルロ・線形ソルバーといった共通技術を通じて、他の格子模型や多体数値計算とも深く接続している。非摂動性の扱い、符号問題、巨大線形代数、HPC最適化は、現代計算科学の中核テーマとして横断的に重要である。

## まとめ
格子QCDシミュレーションは、QCDをユークリッド格子に離散化し、重要度サンプリング(HMC)でゲージ配位を生成し、相関関数から物理量を抽出する方法である。有限温度は$T=1/(N_t a)$で実装され、散乱はLüscher法やHAL QCD法で扱える一方、有限密度では符号問題が本質的障壁となる。精度向上は、系統誤差設計(連続・無限体積・物理点)と、線形ソルバー/GPU/データ共有基盤を含む計算基盤の進展によって支えられている。

