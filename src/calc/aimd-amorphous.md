# AIMDによるアモルファス設計

第一原理計算分子動力学（AIMD）は電子状態計算で得た力に基づき、溶融→急冷→緩和というプロセスを計算機上で再現してアモルファス構造を構築できる。得られたトラジェクトリから短距離秩序・中距離秩序、拡散、電子状態などを一貫して評価できる。

## 参考ドキュメント
1. First principles prediction of amorphous phases using ab initio molecular dynamics melt-quench（J. Chem. Phys., 2016）
   https://pubs.aip.org/aip/jcp/article/145/1/014106/899048/First-principles-prediction-of-amorphous-phases
2. Liquid Si - Standard MD（溶融とRDFによるチェックの実務例, VASP Wiki）
   https://vasp.at/wiki/Liquid_Si_-_Standard_MD
3. トポロジーで紐解くアモルファスの硬さが決まるメカニズム（産総研プレスリリース, 2025/09/25）
   https://www.aist.go.jp/aist_j/press_release/pr2025/pr20250925_2/pr20250925_2.html

## 1. AIMDでアモルファスを扱う基本発想
アモルファスは結晶のような長距離秩序がなく、局所環境とその統計が本質である。AIMDでは、(i) 高温で結合ネットワークを一度解体し、(ii) 急冷で非平衡構造を凍結し、(iii) 適切な温度域で緩和させることで、実験で得られる「凍結した非平衡」を近似する。アモルファス生成では溶融急冷（melt-quench）が最も一般的なルートとして整理されている。

## 2. ワークフロー

### 2.1 事前準備：セル、組成、初期構造
- セルサイズ
  - 小さすぎると中距離秩序（リング、クラスター）や欠陥統計が歪む。現実的には100–300原子程度から開始し、目的物性に応じて拡張する。
- 初期配置
  - ランダム配置（最小距離制約つき）や、既知ガラス/液体構造、古典MD/機械学習ポテンシャルでのプレ緩和構造を出発点にする。
- 密度（体積）
  - 実験密度があるならそれに合わせるのが堅い。未知の場合は高温液体でNPTにより密度を合わせる、または候補密度を複数試す。

### 2.2 溶融（melt）
目的は「記憶消去」であり、十分高い温度で十分な時間だけ液体を平衡化する。VASPの標準MDチュートリアルでも、溶融が不十分だとRDFが結晶性の鋭いピークを残す点が示されている。

推奨の考え方
- 温度は融点より十分に高く設定（材料に依存）
- まずNVTで安定化→必要ならNPTで密度調整
- 液体のRDFが「拡がったピーク＋長距離で1に漸近」することを確認する

### 2.3 急冷（quench）
MDで到達可能な時間が短いため、冷却速度は実験より極端に速くなりがちである。例えばa-Siの初期研究では$10^{14}$ K/s級のクエンチが用いられている。
したがって、急冷は「実験の冷却速度の再現」よりも「局所秩序統計が妥当な構造集合を得る操作」と割り切り、以下で品質を担保する。

実務上の工夫
- 温度ランプを分割する（高温→過冷却→$T_g$近傍→室温）
- $T_g$近傍で一定温度保持（アニール）して局所緩和を進める
- 独立な乱数初速で複数本のクエンチを走らせ、統計的に平均・ばらつきを評価する

### 2.4 0 K緩和（quenched structure refinement）
最終スナップショットを0 Kで幾何最適化し、熱雑音を落とした「固有構造（inherent structure）」として解析する。電子状態・弾性など熱ゆらぎに敏感な量は、(i) 0 K緩和構造、(ii) 室温近傍スナップショット平均、の両方を目的に応じて使い分ける。

## 3. 代表的な設定パラメータと判断基準

| 項目 | 典型的な選択 | 失敗のサイン | 立て直し |
|---|---|---|---|
| 時間刻み $\Delta t$ | 軽元素ほど小さく | 温度が暴れる、エネルギードリフト | $\Delta t$縮小、温度制御の見直し |
| アンサンブル | NVT（溶融・急冷）＋必要に応じNPT | 密度不整合、応力が極端 | 高温NPTで密度合わせ→NVT |
| 電子smearing | 金属/高温で必須になりやすい | SCF不安定、力のノイズ増大 | smearing種類・幅の調整、収束条件強化 |
| 原子数 | 100–300から開始 | 中距離秩序が出ない、欠陥が偏る | 原子数増、複数構造の統計化 |
| クエンチ速度 | 速くなりがち | 過剰配位/未配位が多い | $T_g$近傍アニール延長、複数クエンチ |

## 4. 構造評価

### 4.1 RDFと構造因子
部分RDF $g_{\alpha\beta}(r)$ と、全RDF $g(r)$ を確認する。さらに散乱実験との比較には構造因子$S(q)$が有効である。

$$
S(q)=1+4\pi\rho \int_0^\infty \left[g(r)-1\right]\frac{\sin(qr)}{qr} r^2\,dr
$$

溶融が不十分だと$g(r)$の高次ピークに結晶性の鋭さが残る、というチェック観点はMD解説でも繰り返し示される。

### 4.2 配位数・結合角分布
- 配位数
  $$
  N_{\alpha\beta}(r_c)=4\pi\rho_\beta\int_0^{r_c} r^2 g_{\alpha\beta}(r)\,dr
  $$
  ここで$r_c$は第一極小などを用いる。
- 結合角分布（例えばSi系の四面体性、酸化物の多面体など）
  期待されるネットワークの幾何と照合する。

### 4.3 中距離秩序（ネットワーク・リング・クラスター）
アモルファスの力学応答や局所軟らかさは中距離秩序に強く依存しうる。結合距離・角度だけでは捉えにくい中距離秩序を、トポロジカルデータ解析（パーシステントホモロジー）で抽出し、非アフィン変形（不均一な変位）との相関を示した国内の例もある。

## 5. 物性評価へのつなぎ方

### 5.1 拡散・粘性の手掛かり
拡散係数はMSDから
$$
D=\lim_{t\to\infty}\frac{1}{6t}\left\langle|\mathbf r(t)-\mathbf r(0)|^2\right\rangle
$$
で評価する。有限時間・有限サイズの影響が大きいので、温度依存を複数点で取る、複数トラジェクトリで平均する、などが効く。

### 5.2 電子状態（DOS、局在）
アモルファスではスナップショット依存が大きい。DOSは複数スナップショット平均、局在はIPRなどで評価する。a-SiのAIMD研究では、溶融状態から冷却に伴って金属的状態からギャップ形成へ移行する様子が議論されている。

### 5.3 力学特性（弾性、塑性の起点）
0 K緩和構造での弾性定数、有限温度での応力ひずみ、非アフィン変形の局在などを組み合わせる。中距離秩序と局所変形の対応づけは、構造理解と物性設計の橋渡しになる。

## 6. AIMD固有の限界

### 6.1 クエンチ速度問題
AIMDはps〜数十psが中心で、クエンチ速度は現実より桁違いに速くなる。
回避策は「速度そのものの模倣」より「得たい統計の妥当性」を狙うことにある。
- $T_g$近傍でのアニール延長
- 独立クエンチの統計化
- 初期構造（液体平衡）の徹底

### 6.2 希少事象（相分離、配位変化、反応）の観測困難
遷移が起こるまで待てない問題に対して、メタダイナミクス等の拡張サンプリングが使われる。方法論の原点はLaio–Parrinelloのメタダイナミクスであり、DFT-MD実装としてVASPでも整備されている。

### 6.3 大規模化の必要性
アモルファス合金・ガラスの中距離秩序や緩和現象には大規模系が有利である一方、第一原理は高価である。国内のHPC利用報告でも、溶融急冷でアモルファス構造を生成しつつ、より大規模・長時間側は別法（例えば機械学習ポテンシャル）で補う流れが読み取れる。

## 7. 目的別ワークフロー

### 7.1 アモルファス構造をまず1本作る
1. 初期構造作成（ランダム or 既存構造）
2. 高温NVTで溶融し、RDFで結晶性が消えたか確認
3. 温度を段階的に下げ、$T_g$近傍で保持
4. 室温まで下げた後、0 K緩和して解析用構造にする

### 7.2 実験散乱に合わせたい
- 実験密度・組成を必ず合わせる
- $S(q)$を計算して主要ピーク位置・幅を照合
- モデル構造のばらつきを複数クエンチで評価する

### 7.3 物性（硬さ、拡散、電子状態）まで取りたい
- 構造生成と物性評価を分離する（生成：高温長め、評価：条件固定で平均）
- 解析ターゲットに応じて、0 K緩和構造と有限温度平均を使い分ける
- 中距離秩序の抽出（リング統計、トポロジー等）を併用する

## まとめ
アモルファス計算におけるAIMDの要点は、溶融で履歴を消し、急冷と$T_g$近傍アニールで妥当な局所秩序統計を得て、0 K緩和とスナップショット平均で物性へ接続することである。クエンチ速度やサイズの制約は避けられないため、RDF・$S(q)$・配位数・中距離秩序で品質を検証し、複数クエンチや拡張サンプリング、HPC/MLとの併用で不足する時空間スケールを補うのが実務解となる。