# 分子動力学（MD）計算の原理
作成日：2025年11月23日

## 概要
- 分子動力学（Molecular Dynamics, MD）は、原子や分子を「古典力学」に従って時間発展させることで、物質の構造・運動・熱物性を調べる手法。
- 基本思想：  
  - 各原子に働く力をポテンシャル関数から計算し、ニュートンの運動方程式を数値的に解く。
- 応用例：固体・液体・アモルファス・高分子・タンパク質・界面などの構造緩和、拡散、相転移、粘性、熱伝導など。

## 基本方程式
- 原子 $i$ についての運動方程式：
  - $ m_i \dfrac{d^2 \mathbf{r}_i}{dt^2} = \mathbf{F}_i $
  - $ \mathbf{F}_i = -\nabla_{\mathbf{r}_i} U(\mathbf{r}_1, \mathbf{r}_2, \dots, \mathbf{r}_N) $
- $U$ は系全体のポテンシャルエネルギー（原子間相互作用）を表す。
- 多数の原子（N 個）についてこの運動方程式を同時に解き、時間発展を追跡する。

## ポテンシャル関数（力場）
- MD の「物理モデル」の核となるのがポテンシャル（力場, force field）。
- 典型的な成分：
  - 2体ポテンシャル：Lennard–Jones, Morse など
  - 多体ポテンシャル：EAM（Embedded Atom Method）、Tersoff、MEAM など
  - 共有結合系：結合伸縮、結合角、ねじれ角、非結合項（LJ＋クーロン）などを組み合わせた力場
- パラメータは実験値や第一原理計算結果にフィットして決定される。
- ポテンシャルの選択・パラメータの妥当性が、MD 結果の信頼性を大きく左右する。

## 数値積分（時間発展アルゴリズム）
- 連続時間の運動方程式を、有限の時間刻み $\Delta t$ で数値積分する。
- よく使われる積分法：
  - Velocity–Verlet 法
  - Leapfrog 法
  - Beeman 法 など
- 要求される性質：
  - エネルギー保存が良い（NVE のとき）
  - 時間対称性・シンプレクティック性（長時間安定な軌道）

## 統計力学とアンサンブル
- MD は「ミクロな運動」から「巨視的物性」を出すため、統計力学と組み合わせて使う。
- よく使われるアンサンブル：
  - NVE（マイクロカノニカル）：粒子数 N、体積 V、エネルギー E 一定
  - NVT（カノニカル）：N, V, T 一定（温度一定）
  - NPT（等圧等温）：N, P, T 一定（圧力・温度一定）
- 物理量の時間平均 ≒ アンサンブル平均（エルゴード仮説）という前提で、  
  内部エネルギー、比熱、拡散係数、弾性定数などを計算する。

## 温度・圧力制御（熱浴・圧力浴）
- 実際の MD では、温度や圧力を一定値に「制御」するために熱浴・圧力浴を導入する。
- 代表的な方法：
  - 温度制御（NVT）  
    - Berendsen thermostat  
    - Nosé–Hoover / Nosé–Hoover chain  
    - Langevin thermostat など
  - 圧力制御（NPT）  
    - Berendsen barostat  
    - Parrinello–Rahman barostat など
- これらの手法により、所望の温度・圧力に系を緩和させながらダイナミクスを行う。

## 境界条件と系サイズ
- 多くの MD 計算では「周期境界条件 (Periodic Boundary Conditions, PBC)」を用いる。
  - 有限サイズのセルを「無限に繰り返し」たとみなして、バルクに近い環境を再現。
- 系サイズが小さすぎると：
  - 表面効果や有限サイズ効果が強く出る。
  - 長波長モード（長距離相関）が再現できない。
- シミュレーションで得られる物性の収束性（セルサイズ依存性）を確認することが重要。

## タイムステップと計算時間
- タイムステップ $\Delta t$ は、最も速い振動（主に水素結合やボンド振動）より十分小さく設定する必要がある。
  - 典型値：0.5–2.0 fs 程度。
- 通常の MD（古典ポテンシャル）では、ns〜μs オーダーまで到達可能なこともあるが、
  - 長時間現象（拡散、相変態、クリープなど）は依然として困難な場合も多い。
- 並列計算・GPU の活用により、扱える系サイズ・時間スケールは拡大している。

## 古典 MD の利点と限界
- 利点：
  - 第一原理 MD に比べて非常に高速 → 大きな系（10⁵〜10⁷ 原子）と長時間（ns〜μs）のシミュレーションが可能。
  - 温度・圧力・応力・せん断流など、多彩な条件を簡便に適用できる。
- 限界：
  - ポテンシャルが「経験的」であり、未知材料・化学反応・結合の切断／形成には弱い（専用の反応力場が必要）。
  - 電子構造（バンド構造、電荷移動、スピン状態など）は直接は扱えない。
  - ポテンシャルの適用範囲を外れると、物理的に不自然な挙動を示す可能性がある。