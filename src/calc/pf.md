# フェーズフィールド計算の原理

フェーズフィールド法は、界面を明示的に追跡せず、自由エネルギー汎関数の減少則に基づいて相・組織の時間発展を連続体として解く数理モデルである。秩序変数と保存量の選び方により、相分離、凝固、析出、粒成長、固相変態などを同一の枠組みで記述できる。


## 参考ドキュメント
1) Cahn, J. W. and Hilliard, J. E., Free Energy of a Nonuniform System. I. Interfacial Free Energy, Journal of Chemical Physics (1958)
  https://pubs.aip.org/aip/jcp/article/28/2/258/74794/Free-Energy-of-a-Nonuniform-System-I-Interfacial
2) Boettinger, W. J., Warren, J. A., Beckermann, C., and Karma, A., Phase-field simulation of solidification, Annual Review of Materials Research (2002)
  https://iro.uiowa.edu/esploro/outputs/journalArticle/Phase-field-simulation-of-solidification/9984064566902771
3) 小山敏幸, フェーズフィールド法, 応用物理 94巻1号 (2025)
  https://www.jstage.jst.go.jp/article/oubutsu/94/1/94_10/_article/-char/ja/


## 1. 基本アイデア
界面を「厚みをもつ遷移領域」として表し、相（または結晶方位、損傷など）を表す場を
秩序変数（phase-field）$\eta(\mathbf{r},t)$ で表現する。組成など保存される量は濃度場 $c(\mathbf{r},t)$（あるいは $\{c_i\}$）で表す。

界面追跡を不要にする代償として、界面幅 $W$ を有限にとる。その結果、幾何学的な界面条件は「自由エネルギー汎関数＋運動学（勾配流）」に置き換わる。

## 2. 自由エネルギー汎関数
典型的には、体積自由エネルギー密度 $f$ と、勾配エネルギー（界面エネルギー）からなる。

単一秩序変数の例：
$$
F[\eta] = \int_{\Omega} \left( f(\eta) + \frac{\kappa}{2}|\nabla \eta|^2 \right)\,dV
$$

組成（保存量）を含む例：
$$
F[c,\eta] = \int_{\Omega}\left( f(c,\eta,T) + \frac{\kappa_c}{2}|\nabla c|^2 + \frac{\kappa_\eta}{2}|\nabla \eta|^2 \right)\,dV
$$

ここで $f$ は二重井戸型ポテンシャル（固・液などの二相）や、CALPHAD に基づく多相多成分の自由エネルギー密度などに置き換えられる。$\kappa$ は界面エネルギー（勾配項係数）に対応し、界面幅と界面張力を規定する。

## 3. 2つの基本方程式（Allen–Cahn と Cahn–Hilliard）
フェーズフィールド方程式は、$F$ の勾配流（エネルギー散逸）として与えられる。

### 3.1 非保存秩序変数：Allen–Cahn（反応型）
秩序変数 $\eta$ が保存されないとき、
$$
\frac{\partial \eta}{\partial t} = -L \frac{\delta F}{\delta \eta}
$$
$L$ は動力学係数（モビリティ）であり、界面移動の時間スケールを支配する。

### 3.2 保存量：Cahn–Hilliard（拡散型）
濃度 $c$ が保存されるとき、
$$
\frac{\partial c}{\partial t} = \nabla\cdot\left( M \nabla \mu \right),\quad
\mu = \frac{\delta F}{\delta c}
$$
$M$ は拡散モビリティ、$\mu$ は化学ポテンシャルである。スピノーダル分解や析出の粗大化（coarsening）などを自然に再現する。

### 3.3 どちらを使うか
- 相分率・秩序のように「その場で変化してよい」量：Allen–Cahn
- 総量が保存される組成・濃度：Cahn–Hilliard
- 多相・多粒：複数秩序変数（マルチフェーズフィールド）＋必要に応じて $c_i$ を併用

## 4. 物理場との連成（熱・弾性・電磁気など）
フェーズフィールドは単独でも成立するが、材料の相変態や組織形成では他の場との連成が本質となる。

### 4.1 熱伝導との連成（凝固・相変態）
温度場 $T$：
$$
\rho C_p \frac{\partial T}{\partial t} = \nabla\cdot(k\nabla T) + Q(\eta,c,\dot{\eta},\dot{c})
$$
潜熱や反応熱は $Q$ として入る。

### 4.2 弾性場（格子ミスマッチ、変態ひずみ、磁歪など）
微小ひずみ $\varepsilon$ に対し、力学平衡：
$$
\nabla\cdot \boldsymbol{\sigma} = \mathbf{0},\quad
\boldsymbol{\sigma} = \mathbf{C}:(\varepsilon-\varepsilon^*(\eta,c))
$$
$\varepsilon^*$ は固有ひずみ（ミスフィット、変態ひずみ等）であり、これを自由エネルギーに組み込むことで析出形状、ツイン、マルテンサイト等の形態が決まる。

### 4.3 反応拡散・界面反応
電極材料や表面反応、析出溶解などは、化学ポテンシャルに基づく界面反応項を追加することで拡張される。

## 5. パラメータの意味とスケーリング
フェーズフィールドでは、計算で扱う界面幅 $W$ と物理的界面幅は一致しないことが多い。重要なのは「薄界面極限（thin-interface limit）での整合」である。

代表パラメータの役割：
- $\kappa$：勾配エネルギー係数（界面張力・界面幅に関係）
- 二重井戸の高さ：界面プロファイルと安定相を規定
- $L, M$：時間スケール（界面移動・拡散速度）
- $f(c,\eta,T)$：相図・駆動力（CALPHADとの連携が多い）

薄界面極限では、界面幅を大きくしても、適切な補正（反トラップ流など）により自由境界問題の再現性を保つ流儀がある。

## 6. 数値解法の安定・精度・計算量
フェーズフィールドは非線形かつ剛性（界面で急峻）であり、離散化と時間積分の選択が支配的である。

### 6.1 空間離散化
- 有限差分法（FDM）：実装が簡潔、格子上の大規模計算と相性が良い
- 有限要素法（FEM）：複雑形状、弾性・熱など多物理連成、適応メッシュと相性が良い
- スペクトル法（FFT）：周期境界の相分離（Cahn–Hilliard）に強い

### 6.2 時間積分
- 陽解法：簡単だが安定条件が厳しい（特にCahn–Hilliard）
- 半陰解法：線形部を陰的に扱い、安定性と計算効率を両立しやすい
- 完全陰解法（Newton法など）：頑健だが実装・計算コストが上がる

### 6.3 典型的な落とし穴
- メッシュ間隔 $\Delta x$ が界面幅 $W$ を解像できない（界面が数点以下）
- 時間刻み $\Delta t$ が大きすぎてエネルギー増加・数値発散
- モビリティの温度依存や拡散係数の濃度依存を落とすと、運動学が不自然になる
- 境界条件（周期、Neumann、Dirichlet）が物理と整合していない

## 7. 検証と再現性
異なる実装間で結果を比較するには、標準問題（ベンチマーク）を用いるのが有効である。初期条件、無次元化、界面幅、時間積分、出力指標を揃えて比較する。

## 8. 適用例
- 凝固：デンドライト、共晶、偏析、溶質トラップ
- 相分離・析出：スピノーダル分解、核生成、粗大化
- 粒成長：多結晶の粒界移動、異方性粒界エネルギー
- 固相変態：マルテンサイト、規則化（APB）、相境界移動
- 破壊・損傷：相場（phase-field）による亀裂表現（拡張系）

## 9. まとめ
フェーズフィールド法は、自由エネルギー汎関数とその勾配流により、界面を追跡せずに相・組織の発展を記述する枠組みである。Allen–Cahn と Cahn–Hilliard を核に、熱・弾性・拡散などの連成を組み込むことで、現実の材料組織形成に近い運動学へ拡張できる一方、界面幅、薄界面整合、時間積分の安定性が精度と計算量を決める要点である。
