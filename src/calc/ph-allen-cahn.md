# Allen–Cahn 法に基づくフェーズフィールド計算例
作成日：2025年11月23日

## 概要
- Allen–Cahn 方程式は、**非保存型オーダーパラメータ（相のラベル・結晶方位など）の時間発展**を記述する代表的なフェーズフィールド方程式。
- 「界面曲率駆動の粒成長」や「2 相界面の移動・消滅」などを扱う簡単なモデルとしてよく使われる。
- ここでは、
  - 2 相系（相 A / 相 B）を表すスカラー場 $\phi(\mathbf{r},t)$
  - 単一粒子の収縮（曲率駆動で消える例）
  を題材に、Allen–Cahn 法に基づく計算例の流れをまとめる。


## モデル設定（2 相系のオーダーパラメータ）

- オーダーパラメータ $\phi(\mathbf{r},t)$：
  - $\phi \approx 0$：相 A
  - $\phi \approx 1$：相 B
  - 界面では $0 < \phi < 1$ の中間値
- 初期条件の例：
  - 計算領域：2D 正方形 $\Omega = [0,L]\times[0,L]$
  - 領域中央に半径 $R_0$ の円形粒子（相 B）を置く：
    - その内部：$\phi=1$、外部：$\phi=0$
  - これが時間発展で収縮し、最終的に消滅する挙動をみる。


## 自由エネルギー汎関数の例

- Allen–Cahn 方程式の駆動力は「自由エネルギーの勾配」から得られる。
- 典型的な自由エネルギー汎関数：
  $$
    F[\phi] = \int_\Omega
    \left(
      f_\text{bulk}(\phi)
      + f_\text{grad}(\nabla\phi)
    \right)\, dV
  $$
- バルク自由エネルギー（2 井戸ポテンシャル）：
  $$
    f_\text{bulk}(\phi) = W\,\phi^2(1-\phi)^2
  $$
  - $W > 0$：相間エネルギー障壁の高さ
  - $\phi=0,1$ が安定点になるような形状
- 勾配エネルギー：
  $$
    f_\text{grad}(\nabla\phi) = \frac{\kappa}{2}|\nabla\phi|^2
  $$
  - $\kappa > 0$：界面エネルギー・界面幅を決める係数


## Allen–Cahn 方程式

- 自由エネルギー汎関数に対する機能微分：
  $$
    \frac{\delta F}{\delta\phi}
    = \frac{\partial f_\text{bulk}}{\partial\phi}
      - \kappa \nabla^2 \phi
    = 2W\phi(1-\phi)(1-2\phi) - \kappa \nabla^2\phi
  $$
- Allen–Cahn 型時間発展方程式：
  $$
    \frac{\partial\phi}{\partial t}
    = -L \frac{\delta F}{\delta\phi}
    = -L\left[
      2W\phi(1-\phi)(1-2\phi)
      - \kappa \nabla^2\phi
    \right]
  $$
  - $L > 0$：モビリティ（界面移動の速さに関係）
- 物理的意味：
  - バルク項：$\phi$ を 0 または 1 に押し戻す（相の安定化）
  - 勾配項：界面の曲率に応じて界面が動く（小さな粒は収縮）


## 無次元化とパラメータ例

- 典型的には、空間・時間を適当なスケールで無次元化することで、数値計算を安定にする。
- 例（ざっくり）：
  - 長さスケール：$\ell$（界面幅や粒子サイズ）
  - 時間スケール：$\tau = \ell^2 / (L\kappa)$
- 無次元変数にすると、方程式はおおよそ
  $$
    \frac{\partial\phi}{\partial \tilde{t}}
    = \tilde{\nabla}^2\phi
      - \tilde{W}\,\phi(1-\phi)(1-2\phi)
  $$
  のような形にできる（$\tilde{W}$ はスケーリング後の係数）。


## 数値計算手順（2D・有限差分の例）

1. **計算格子の設定**
   - 領域を $N_x \times N_y$ の格子に離散化。
   - 空間刻み：$\Delta x = L/N_x$, $\Delta y = L/N_y$（2D 正方格子なら $\Delta x=\Delta y$）。
   - 境界条件：周期境界条件（PBC）や Neumann（$\nabla\phi\cdot n = 0$）を使う。

2. **初期条件**
   - 格子上で円の内部：$\phi_{ij}=1$、外部：$\phi_{ij}=0$。
   - 界面をなめらかにしたい場合は、タンジェント関数型の smoothed step で与えてもよい。

3. **勾配項の離散化**
   - ラプラシアン $\nabla^2\phi$ を 2 次精度中心差分で計算：
     $$
       \nabla^2\phi_{ij}
       \approx \frac{\phi_{i+1,j} + \phi_{i-1,j}
                   + \phi_{i,j+1} + \phi_{i,j-1}
                   - 4\phi_{ij}}{\Delta x^2}
     $$

4. **時間積分**
   - 単純な陽解法（Forward Euler）：
     $$
       \phi_{ij}^{n+1}
       = \phi_{ij}^n
         + \Delta t\,
           \left[
             -L \left(
                2W\phi_{ij}^n(1-\phi_{ij}^n)(1-2\phi_{ij}^n)
                - \kappa\,\nabla^2\phi_{ij}^n
             \right)
           \right]
     $$
   - 安定性のため、$\Delta t$ は拡散方程式レベルの制約
     $\Delta t \lesssim (\Delta x)^2 / (4L\kappa)$
     を参考に小さめに設定。
   - より安定なスキーム（半陰解法、Crank–Nicolson、Fourier スペクトル法）を使うことも多い。

5. **時間発展のループ**
   - $n=0,1,2,\dots$ についてステップ 3–4 を繰り返し、$\phi(\mathbf{r},t)$ の時間変化を追う。
   - 適当なステップごとに $\phi$ 分布・エネルギー $F[\phi]$ を保存・可視化する。


## 典型的なシミュレーション例

### 1. 単一円形粒子の収縮
- 初期：半径 $R_0$ の円形 B 相粒子（$\phi=1$）が A 相（$\phi=0$）中に存在。
- 時間発展：
  - 界面曲率に比例した駆動力により、粒子半径 $R(t)$ が減少。
  - 小さい粒は高速に収縮し、最終的には消滅。
- 観察量：
  - 粒子半径 $R(t)$ の時間変化（理論的には $R^2 \sim R_0^2 - K t$ のようなスケーリングが現れることが多い）。
  - 自由エネルギー $F(t)$ が単調減少しているかの確認。

### 2. 多粒子系の粒成長
- 初期：ランダムに分布した多数の B 相粒子。
- 時間発展：
  - 小さな粒は消滅し、大きな粒が成長する「規則化粗視化 (coarsening)」過程。
  - 代表的粒径 $R_\text{mean}(t)$ が時間の冪則で成長する挙動を解析できる。


## 実務上のポイント

- 界面幅と格子分解能
  - 界面幅に対して、少なくとも 5〜8 グリッド程度のメッシュを取らないと界面形状が粗くなりがち。
- 時間ステップの制御
  - 陽解法では $\Delta t$ がかなり小さくなり、計算コストが大きくなる。
  - 実用的には、準陰解法や FFT ベースの高速解法がよく使われる。
- パラメータと物理量の対応
  - $W, \kappa, L$ は、界面エネルギー・界面幅・界面移動速度と結びついている。
  - 実材料に適用するには、MD／第一原理・実験からこれらを推定する必要がある。

