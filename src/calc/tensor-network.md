# テンソルネットワーク入門

テンソルネットワーク（Tensor Network, TN）は、多体量子状態・分配関数・高次元データを「小さなテンソルの縮約（contraction）」として表現し、指数爆発する自由度を物理的に重要な部分へ圧縮する枠組みである。材料科学では、強相関有効模型の高精度解法、第一原理ダウンフォールディング模型の解釈、低次元磁性・輸送・励起スペクトルの理論基盤として重要である。

## 参考ドキュメント
- R. Orús, A practical introduction to tensor networks: Matrix Product States and Projected Entangled Pair States, Ann. Phys. 349, 117–158 (2014)
  https://arxiv.org/pdf/1306.2164
- 西野友年, テンソルネットワーク形式の進展と応用, 日本物理学会誌 72(10) (2017)（日本語）
  https://www.jstage.jst.go.jp/article/butsuri/72/10/72_702/_article/-char/ja/
- MateriApps（東大物性研）テンソルネットワーク法カテゴリ（日本語）
  https://ma.issp.u-tokyo.ac.jp/app-category/algorithm26

## 1. 何を解決する道具か
多体量子系は系サイズLに対しヒルベルト空間が指数的に増えるため、厳密対角化は小系に限られる。TNは次の仮定に基づき計算可能領域を拡張する。

1) 低エネルギー状態は、任意に複雑な状態ではなく、エンタングルメント構造が制限されることが多い  
2) その制限を「ボンド次元 D（bond dimension）」で定量化し、Dを系統的に上げて収束させる

材料科学での典型的な対象は、低次元磁性体、擬一次元導体、スピン梯子、フラストレーション系の有効スピン模型、DFT+Wannierで得た少数軌道Hubbard模型、局在相関が強いクラスター／活性空間問題などである。

## 2. 基本用語
テンソルは多次元配列であり、TNでは以下の対応で理解すると速い。

- ノード：テンソル（要素の塊）
- 脚（leg）：添字（インデックス）
- 開いた脚：物理自由度（サイトの状態、軌道占有、スピンなど）
- 結合脚（ボンド）：内部自由度（エンタングルメントを運ぶチャネル）
- 縮約（contraction）：同じ添字に関して和をとる演算

行列積の例（ランク2同士の縮約）
$$
C_{ik}=\sum_j A_{ij}B_{jk}
$$

TNでは、どの順序で縮約するかが計算量を支配するため、縮約順序設計も計算科学として重要である。

## 3. エンタングルメントと表現可能性
二分割 A|B に対し、純粋状態 |ψ⟩ の縮約密度行列は
$$
\rho_A=\mathrm{Tr}_B\left(|\psi\rangle\langle\psi|\right)
$$
であり、エンタングルメントエントロピーは
$$
S_A=-\mathrm{Tr}(\rho_A\log \rho_A)
$$
で定義される。

多くの一次元ギャップ系では面積則（境界の大きさに比例）により S_A が小さく、有限 D の表現が効きやすい。一方、強い体積則（volume law）を示す状態では必要Dが急増し、TNの優位性が薄れる。

材料科学での実務ポイント
- Dを増やすことは「近似を良くする」ことに相当するが、計算コストも急増する
- 収束は、エネルギー、相関関数、切り捨て誤差（discarded weight）、エネルギー分散など複数の指標で確認するのが安全である

## 4. 代表的テンソルネットワーク形式と適材適所
### 4.1 MPS（Matrix Product State）とMPO（Matrix Product Operator）
一次元鎖の量子状態を、局所テンソルの一次元配列として表す。
$$
|\psi\rangle=\sum_{\sigma_1,\dots,\sigma_L}
A_1^{\sigma_1}A_2^{\sigma_2}\cdots A_L^{\sigma_L}\,
|\sigma_1,\dots,\sigma_L\rangle
$$
演算子（ハミルトニアン、密度行列）も同様にMPOとして表せる。

適用が強い場面
- 1D/準1D（鎖、梯子、円筒の有限幅）
- 有効模型の基底状態、有限温度、時間発展
- 材料の低次元磁性・電荷秩序・スピンギャップ評価

### 4.2 PEPS/TPS（Projected Entangled Pair States / Tensor Product States）
二次元格子へ拡張した表現であり、2Dの面積則に自然に適合する。ただし一般に縮約が高コストであり、近似縮約（CTMRGなど）が必要になる。

適用が強い場面
- 2D量子スピン模型、2D強相関格子模型の基底状態近似
- iPEPSなど無限系の変分計算

### 4.3 MERA/TTN（階層型ネットワーク）
多スケール構造を持つTNであり、臨界性やスケーリングを幾何学的に扱いやすい。材料科学では臨界現象や長距離相関の理解、理論的ベンチマークでの利用が多い。

### 4.4 TRG/HOTRGなど（分配関数のTN）
古典統計模型や量子模型のパス積分表現などで、分配関数をTNとして扱い、粗視化（renormalization）する系統の手法である。相図・臨界性の解析と相性がよい。

## 5. 代表アルゴリズム
表：MPS系アルゴリズムの対応

| 目的 | 代表手法 | 出力（例） |
|---|---|---|
| 基底状態 | DMRG, VUMPS | E0、相関関数、秩序パラメータ |
| 実時間発展 | TEBD, TDVP | 動的相関、励起の伝播、緩和 |
| 有限温度 | 浄化、METTS | 比熱、磁化率、温度依存相関 |
| 励起・スペクトル | 補正ベクトル、tDMRG | S(q,ω), A(k,ω) の推定 |

材料科学との接続で重要な点
- 実験比較用の量は、静的相関（秩序、ギャップ）だけでなく、動的構造因子 S(q,ω) のようなスペクトルも含む
- 有限温度の磁化率・比熱は実験と直接比較しやすい
- 2D扱いは近似縮約の選択と誤差見積りが鍵である

## 6. 材料科学でのワークフロー
### 6.1 有効模型の構築→TNで解く
1) DFTでバンド構造を得る  
2) Wannier関数などで少数軌道の有効ハミルトニアンへ落とす  
3) 相互作用（U, J）を導入したHubbard型模型として整備する  
4) 1D/準1DならMPS/DMRG、2D寄りならPEPS/iPEPS等で基底状態・相関・励起を評価する

この流れは、強相関材料を「第一原理の情報を保ちつつ、相関物理を正面から解く」ための現実的な選択肢である。

### 6.2 実験データ解釈
- 中性子散乱やRIXSのスペクトル解釈：S(q,ω) の計算
- NMRや比熱・磁化率の温度依存：有限温度TN
- 低次元磁性体の交換定数推定：スピン模型のフィッティングと高精度ベンチマーク

### 6.3 量子化学・局所強相関
活性空間が大きく多参照性が強い場合、DMRGは巨大活性空間を扱う手段として使われる。固体・表面の局所相関問題にも概念的に接続しやすい。

## 7. 実務の指針
- まず1Dの小さな模型で、D（またはχ）の増加に対する収束を体感する
- 境界条件は開境界（OBC）が安定になりやすいことが多い
- 対称性（粒子数、Sz、SU(2)など）を保存すると、ブロックスパース化により精度と速度が両立しやすい
- 2Dは「系幅」「縮約近似」「誤差見積り」を設計段階から明示する
- 物性の結論は、E0だけでなく相関関数・ギャップ・有限サイズ外挿など複数の観測量で整合性を取る

## 8. 展開事例
- MateriApps（東大物性研の計算物性ポータル）には、テンソルネットワーク関連ソフトウェアや解説がカテゴリとして整理されており、初学者が「何を使えばよいか」を決めるのに有用である
- TeNPyやITensorのような代表的ライブラリは、MPS/DMRGに加えてTEBD/TDVPなどを含む実装が公開されており、計算例の入口になりやすい
- 国内でもテンソルネットワークに関する解説記事・講義ノート・研究会（ワークショップ）が継続的に整備されている

## まとめ
テンソルネットワークは、エンタングルメント構造を制御するボンド次元Dを軸に、指数的自由度を圧縮して多体量子問題を解くための表現とアルゴリズムの総称である。材料科学では、低次元強相関模型の参照解、DFT+Wannier有効模型の高精度解法、実験スペクトルや温度依存物性の理論解釈として特に有効であり、1Dから始めて収束・誤差見積りの作法を身につけたうえで2Dや実材料モデルへ拡張するのが実践的である。

