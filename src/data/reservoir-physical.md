# 物理リザバー（Physical Reservoir Computing）

物理リザバーとは、リザバーコンピューティング（RC）の中間層（リザバー）を、材料・デバイス・物理現象がもつ非線形ダイナミクスで置き換えた計算枠組みである。材料科学の観点では、非線形応答と短期記憶を示す物質・界面・微細構造を「計算資源」として設計し、低消費電力なエッジAIやその場計測のオンライン解析へ接続するアプローチである。

## 参考ドキュメント
- NTT技術ジャーナル：光デバイスによるリザーバコンピューティングの物理実装
  https://journal.ntt.co.jp/article/18595
- JST発表：スピン波を用いた物理リザバー計算機の高性能化の条件を理論的に解明
  https://www.jst.go.jp/pr/announce/20240304-4/index.html
- Nature Communications：Interface-type tunable oxygen ion dynamics for physical reservoir computing (2023)
  https://www.nature.com/articles/s41467-023-42993-x


## 1. リザバーコンピューティングの最小式

RCは、入力時系列を高次元状態へ写像し、読み出し（readout）のみを学習する構成である。

離散時間表現（一般形）
- 入力：$u_t$
- リザバー状態：$x_t \in \mathbb{R}^{N}$
- 観測（読み出しに渡す特徴）：$z_t = g(x_t)$
- 出力：$y_t$

$$
x_{t+1} = f(x_t, u_{t+1}; \theta) \\
y_t = W_{out}\,\phi([z_t, u_t, 1])
$$

ここで、物理リザバーでは $f(\cdot)$ をデバイスの物理ダイナミクス（光の干渉・スピン波・イオン移動等）が担う。学習は通常 $W_{out}$ のみ（線形回帰やリッジ回帰）である。

リッジ回帰（典型）
$$
W_{out} = Y X^{\top}(XX^{\top}+\beta I)^{-1}
$$


## 2. 物理リザバーに必要な性質（材料・デバイス設計の要件）

物理リザバーは、時系列入力を区別できる「非線形性」と、過去情報を一定時間保持する「短期記憶（fading memory）」が必要である。

要求特性
- 非線形ダイナミクス：入力差が状態差として広がること
- fading memory：過去が残るが、過度に固定化せず消えていくこと
- 安定性と再現性：温度・劣化・ドリフト下でも同一条件で同様の写像が得られること
- 観測性：状態を電気・光などで十分に読み出せること
- 適切な時間スケール：入力サンプリング周期 $\Delta t$ と緩和時間 $\tau$ が近い（同程度が望ましい）

代表的な評価指標
- 記憶容量（memory capacity, MC）の例
$$
MC = \sum_{k=1}^{K} \mathrm{corr}^2(\hat{u}_{t-k}, u_{t-k})
$$
ここで $\hat{u}_{t-k}$ は $y_t$ から線形に復元した過去入力である。


## 3. 実装アーキテクチャ

- 空間多重（spatial）：多数のノード（電極、ピクセル、波導モード等）を並列に用いる
- 時間多重（time-multiplex）：1つの非線形素子＋遅延系で仮想ノード列を作る
- ハイブリッド：空間多重と時間多重を併用し、特徴次元を稼ぐ

材料科学的には、空間多重は微細構造・界面設計と相性が良く、時間多重は単一素子の緩和・履歴特性（イオン移動、熱、磁化緩和等）に依存する。


## 4. 物理現象別：材料で作るリザバーの類型

| 系統 | 主要自由度 | 例（材料・構造） | 長所 | 課題（材料視点） |
|---|---|---|---|---|
| 光（フォトニクス） | 光強度・位相・干渉 | 光回路、リング共振器、干渉計 | 超高速・並列・低消費電力の可能性 | 変動（温度、加工誤差）、検出系の設計 |
| 酸化物/強誘電/イオン移動 | 分極・酸素空孔・界面電荷 | HZO強誘電、Mott酸化物、イオンゲート | 非線形＋緩和が自然に得られる | ドリフト、履歴の制御、繰返耐久 |
| 磁性（スピン波・STNO等） | 磁化歳差・スピン波 | 磁性薄膜・素子、波動伝搬系 | 波動で時空間特徴が作れる | 損失・ノイズ、素子サイズ最適化 |
| 分子振動/化学状態 | 振動モード・吸着状態 | 分子層・界面分光 | 超小型・化学センサ統合に親和 | 安定性、環境依存、読み出し設計 |
| 機械/熱 | 変位・共振・熱拡散 | MEMS共振器、熱回路 | デバイスが単純 | 周囲ノイズ、遅い時間スケール |


## 5. 材料科学としての設計論

1) 時間スケール整合の設計
- 緩和時間 $\tau$ を、入力周期 $\Delta t$ に合わせる（$\tau \sim \Delta t$ を目標）
- 例：イオン移動（界面拡散長、欠陥密度、温度）、磁化緩和（ダンピング、素子寸法）、光（共振Q、遅延線長）を調整する

2) 非線形性の「形」を作る
- しきい値型（スイッチング、相転移的応答）
- 飽和型（tanh的な飽和が得られる）
- ヒステリシス型（強すぎるとfading memoryを損ねうるため、安定領域と組合せて使う）

3) 空間自由度（多次元特徴）を増やす
- 多電極配置、微細構造の不均一性（ただし再現性とトレードオフ）
- マルチドメイン（磁区）、多相（相分離）、粒界ネットワークを活用する設計

4) 観測性（readout設計）
- 物理リザバーの性能は readout の取り出し方で大きく変わる
- 電気readout：多端子抵抗、ホール、インピーダンス
- 光readout：フォトダイオードアレイ、スペクトル多重


## 6. MI・計測と接続

その場計測（時間発展）のオンライン解析
- 反応開始や相転移の兆候検出（異常検知）
- その場XRD/XAFS/磁気応答の短期予測とフィードバック制御

プロセス/装置のエッジAI化
- 加工条件・熱処理ログ・電気波形の即時分類（品質判定）
- デバイス内で前処理（特徴抽出）を行い、後段の学習を軽量化する

シミュレーションの軽量サロゲート
- MDやマルチフィジックスの時系列（応力、配位数、磁化等）の予測器として利用
- 低次元状態の抽出と状態推定に用いる


## 7. ワークフロー

1. タスク定義
- 予測（回帰）か分類か異常検知かを決め、出力 $y_t$ を定義する

2. 入力設計
- 入力信号 $u_t$ の時間スケールと振幅範囲を決める（飽和を避ける）
- 必要なら時間多重（仮想ノード）を設計する

3. デバイス計測
- 物理リザバーに $u_t$ を印加し、多チャンネル出力 $z_t$ を取得する
- washout（初期応答の切捨て）区間を設ける

4. 学習（readoutのみ）
- $W_{out}$ をリッジ回帰で推定し、時系列分割で評価する

5. 物理パラメータとの対応づけ
- 性能が良い条件で、$\tau$、ノイズ、ヒステリシス、ドリフト量などの物性指標を同時に記録し、材料設計へ戻す


## 8. よくある落とし穴

- ドリフト：同一学習重みが時間とともに合わなくなる（温度・劣化・イオン拡散）
- 過度のヒステリシス：記憶が残りすぎ、入力履歴の区別が崩れる
- 観測不足：状態は豊かなのに readout が単一チャネルで情報を捨てる
- 時間スケール不一致：$\tau \ll \Delta t$（記憶不足）または $\tau \gg \Delta t$（忘却不足）
- 評価のリーク：時系列をシャッフルして検証すると過大評価になりうる（時間順の分割が基本）


## まとめ
物理リザバーは、材料・デバイスが持つ非線形ダイナミクスと短期記憶を用いて、時系列処理を低学習コストで実現する枠組みである。材料科学では、界面・欠陥・微細構造・波動伝搬・イオン移動などの設計自由度を「計算性能」に翻訳し、計測・プロセス・デバイスへ近い場所での解析（エッジAI）へ結び付ける研究対象となる。