# AI for Science（AI4Science）


## 参考ドキュメント
- 文部科学省: AI for Science / 概念と方向性（PDF, 日本語）
  https://www.mext.go.jp/content/20251006-mxt_jyohoka01-000045188_01.pdf

- NIMS/JST: 組成傾斜薄膜に対応したAIベース自律材料探索システムを開発（日本語）
  https://www.nims.go.jp/press/2025/11/202511200.html

- Nature: A generative model for inorganic materials design（MatterGen, English）
  https://www.nature.com/articles/s41586-025-08628-5


## 1. AI4Scienceとは（材料研究での意味）
AI4Science（AI for Science）は、AIを「解析の道具」にとどめず、データ・シミュレーション・実験・理論モデルを統合して、科学研究サイクル（仮説→予測→検証→更新）を加速・拡張する考え方である。
材料科学では、以下を同時に満たす設計が核心となる。

- 物理に矛盾しない（対称性、保存則、熱力学整合）
- 高速に探索できる（候補生成・スクリーニング・最適化）
- 実験・計算に接続できる（検証可能性、再現性、プロセス履歴）

関連語
- マテリアルズ・インフォマティクス（MI）: 主にデータ駆動の相関発見・予測を中心とする
- AI4Science: 物理モデルや実験・計算ループを含む統合運用まで射程に入れる

## 2. 材料分野の代表ユースケース（何ができるか）
| 目的 | 典型入力 | 典型出力 | 代表手法 |
|---|---|---|---|
| 物性予測（順問題） | 組成・構造・プロセス | 形成エネルギー、弾性、磁性、輸送など | GNN、Transformer、カーネル法 |
| 計算の高速化 | 少数のDFT/MD | 高精度サロゲート | 機械学習ポテンシャル、サロゲートモデル |
| 逆設計（候補生成） | 条件（物性、化学、対称性） | 新規結晶・組成候補 | 拡散モデル、VAE、Flow |
| 実験計画（探索最適化） | 既測定データ | 次の測定点（組成・条件） | ベイズ最適化、アクティブラーニング |
| 物理パラメータ同定（逆問題） | 実測の場・時系列 | モデルパラメータ | 物理情報付き学習（PINNs/PIML） |
| 自律実験（閉ループ） | 合成・計測のリアルタイムデータ | 次の合成条件 | BO + ロボティクス + 解析自動化 |

材料研究で重要なのは、出力が論文の数字で終わらず、次の計算・次の実験に自動的につながる設計である。

## 3. AI4Scienceを支える3本柱
### 3.1 表現（representation）
材料は「分子」より複雑で、周期境界・対称性・欠陥・多相が絡む。
そのため、表現は目的により使い分ける。

- 組成記述: one-hot、組成ベクトル、元素物性埋め込み（電気陰性度など）
- 構造記述: 結晶グラフ（原子=ノード、近接=エッジ）、局所環境記述子
- 周期性: 分率座標、格子、対称操作を意識した設計
- 画像・スペクトル: XRD/XAFS/XMCD等の波形をそのまま学習（CNN/Transformer）

### 3.2 モデル（model）
材料AIで定番のモデル群

- GNN（Graph Neural Networks）: 結晶の局所環境を扱いやすい
- E(3) 等変（equivariant）モデル: 回転・並進に整合しやすく、データ効率が良い
- 生成モデル: 結晶構造生成、欠陥生成、スペクトル生成など
- 物理情報付き（physics-informed）: PDE/保存則/エネルギー原理を損失に組み込む

### 3.3 ループ（loop）
AI4Scienceの本質は「ループの設計」にある。

- 計算ループ: DFT → 学習 → 高速探索 → DFT検証 → 学習更新
- 実験ループ: 合成 → 計測 → 解析 → 次の条件提案 → 合成…
- 計算×実験ループ: DFT/MDで探索→有望領域を薄膜やバルクで検証→再学習

## 4. 数式で押さえる最小セット
### 4.1 物理制約を入れる基本形
データ損失と物理残差（または制約違反）を同時に最小化する。
$$
L(θ) = L_data(θ) + λ L_physics(θ)
$$

例
- L_physics: PDE残差の二乗和、境界条件違反、対称性違反、電荷中性違反、熱力学整合違反など

### 4.2 機械学習ポテンシャル（MLIP）の典型損失
エネルギー E、力 F、応力 σ を同時に学習することが多い。
$$
L(θ) = w_E ||E - Ê_θ||^2 + w_F Σ_i ||F_i - F̂_i,θ||^2 + w_σ ||σ - σ̂_θ||^2
$$
ポイント
- 力はデータ数が多く、学習を強く拘束できる
- 応力を入れると格子・弾性の再現が安定しやすい

### 4.3 ベイズ最適化（BO）の基本
未知関数 f(x)（例: 性能）を、少ない試行で最大化する。
サロゲートの平均 μ(x) と不確かさ σ(x) を使い、獲得関数 a(x) を最大化する点を次に測る。

x_next = argmax_x a(x; μ, σ)

期待改善（EI）の例
z = (μ(x) - f_best - ξ) / σ(x)
EI(x) = (μ(x) - f_best - ξ) Φ(z) + σ(x) φ(z)

ここで Φ, φ は標準正規分布のCDF, PDF、ξは探索寄りの調整項。

## 5. 材料科学で特に重要な観点（落とし穴対策）
### 5.1 外挿に弱い（データ分布のズレ）
- 学習データにない元素組合せ、相、欠陥密度、プロセス条件では性能が落ちる
- 対策: 不確かさ推定、OOD検知、アクティブラーニングでデータを追加

### 5.2 物理的にあり得ない生成物
生成モデルは「見た目が結晶っぽい」構造を出せるが、安定とは限らない。
- 対策: 物理制約、安定性フィルタ（形成エネルギー、凸包距離）、構造緩和、対称性チェック

### 5.3 実験接続の難しさ（合成可能性）
計算上良い材料が合成できるとは限らない。
- 対策: 既知相図・プロセス制約・元素供給制約を最初から条件に入れる
- 実験ループでは、測定の実ノイズとドリフトを前提に設計する

## 6. 材料AI4Scienceの主要トピック（研究の現在地）
### 6.1 結晶生成・逆設計（例: 拡散モデル）
近年、格子・原子種・座標を同時に生成する枠組みが進展している。
- 例: MatterGen は拡散モデルで無機結晶を生成し、条件付き設計に対応する方向性が示されている

### 6.2 自律材料探索（閉ループ）
薄膜・粉体・溶液など多様な系で、AIが次の実験条件を提案し、探索を加速する流れが強い。
- 特に、組成傾斜試料のような高スループット試料は、閉ループと相性が良い

### 6.3 国レベルのデータ・計算基盤整備
高品質データの共有、AI×HPC融合、基盤モデルの整備が重要テーマになっている。

## 7. 研究室での実装テンプレ（すぐ回すための最小設計）
### 7.1 目的を決める（まず1つ）
- 形成エネルギー予測を、特定材料群で当てる
- DFT点を減らしつつ相安定性ランキングを作る
- 実験の組成最適化（例: AHE最大化、磁歪最大化）をBOで回す

### 7.2 データ設計（最重要）
- 入力: 組成・構造・プロセス・測定条件（メタデータ込み）
- 出力: 物性値（単位、測定条件、誤差、前処理）
- 分割: 同一系が漏れない分割（リーク防止）、時間分割（実運用想定）

### 7.3 評価指標（最低限）
- 回帰: MAE/RMSE + 不確かさの較正（校正曲線）
- 探索: 最良値到達までの試行回数、再現性
- 生成: 安定性通過率、ユニーク率、DFT検証率

### 7.4 ループ化（AI4Science化）
- 学習 → 提案 → 検証（DFT/実験）→ 追加学習 を最短で回す
- ログを残す（モデル、データ、条件、seed、コード版）
