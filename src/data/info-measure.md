# 計測インフォマティクス（Measurement Informatics）

4つのインフォマティクスのうち、「計測インフォマティクス」について概説する。

## 参考にしたドキュメント
- 石井 真史「計測インフォマティクスと機械学習」応用物理 92(2), 108–111  
  https://www.jstage.jst.go.jp/article/oubutsu/92/2/92_108/_pdf/-char/ja
- Takahashi Group: Measurement Informatics & Signal Processing  
  https://takahashigroup.github.io/research/


## 1. 計測インフォマティクスとは何か

- 計測インフォマティクス（Measurement Informatics, MEI）は、
  - 実験・計測装置から得られる「信号・データ」を中心に据え、
  - その取得・前処理・特徴抽出・解釈・フィードバックまでを
    データ科学・機械学習と統合的に扱う枠組みである。
- 材料インフォマティクスが
  - 「材料の組成・構造 → 特性」のモデル化に主眼を置くのに対し、
- 計測インフォマティクスは
  - 「測り方・データ品質・信号処理 → 有用な観測量」
  に焦点を当てる。
- 目的は、
  - 高価で貴重な実験データ（放射光・電子顕微鏡・MBN 等）の情報量を最大化し、
  - 不確かさを定量化しつつ、効率的な実験設計・自律実験につなげることである。


## 2. 対象とスコープ

このページで扱うのは、「計測データとその処理」に関わる部分であり、典型的には：

- データの種類
  - スペクトル：XAFS, XPS, ARPES, Raman, EELS など
  - 画像：XRD 2D パターン、顕微鏡画像（SEM, TEM, MOKE, Kerr, STEM 等）
  - 時系列：磁気雑音（MBN）、振動測定、インピーダンス測定など
  - マルチモーダル：スペクトル＋画像＋スカラー値が同時に得られる測定系

- スコープ
  - 計測条件・装置設定 → 生データ取得 → 前処理 → 特徴抽出 → モデル化 → フィードバック
  - データ品質評価・不確かさ評価
  - 自律実験・オンライン解析

ここでは、プロセス条件（熱処理レシピなど）の最適化は「プロセスインフォマティクス」、  
物理モデル（DFT, MD, PDE など）との連成は「物理インフォマティクス」で扱う前提にし、  
計測インフォマティクスは「計測データと信号処理」に役割を限定する。


## 3. 計測データ処理の流れ

計測インフォマティクスの標準的なフローは、次のように整理できる。

1. 計測設計・メタデータ定義
   - 何を測るか（ターゲット物理量）
   - どの装置・どの設定で測るか（エネルギー・磁場・温度・幾何）
   - 試料情報・プロセス履歴・測定条件をメタデータとして整理

2. データ取得（Acquisition）
   - 実験装置から生データ（raw data）を取得
   - ノイズ・ドリフト・装置固有の系統誤差を考慮したフォーマットで保存

3. 前処理（Pre-processing）
   - ノイズ除去（平滑化、フィルタリング、ベースライン補正）
   - 正規化・スケーリング（積分値・ I0 で割る、背景除去など）
   - 欠損値の補完・異常値検出

4. 特徴抽出（Feature Extraction）
   - スペクトルの場合：ピーク位置・強度・半値幅、PCA／NMF 成分、波数領域特徴など
   - 画像の場合：テクスチャ特徴、ドメイン形状、トポロジカル指標（位相場・粒径分布）など
   - 時系列の場合：自己相関、スペクトル密度、緩和時間定数など

5. モデル化・可視化
   - 教師あり学習で物性・構造と結びつける
   - 教師なし学習でパターンやクラスターを発見する
   - 次元削減で直感的に可視化（PCA, t-SNE, UMAP など）

6. フィードバック
   - 「どの条件でどんなデータが取れたか」を基に、
   - 次の測定条件を提案（アクティブ・ベイズ最適化など）
   - ここでプロセスインフォマティクス・材料インフォマティクスと連携する。


## 4. 典型的な解析タスクと手法

### 4.1 ノイズ除去・信号改善

- 目的：
  - 放射光や電子顕微鏡など、取得コストの高い計測に対して、
  - 低 S/N の生データから信頼できる物理量を取り出す。

- 手法の例：
  - 線形手法：移動平均、Savitzky–Golay フィルタ、Wavelet デノイジング
  - 統計・行列分解：PCA, NMF, Robust PCA による信号分離
  - 機械学習：Denoising Autoencoder や U-Net による超解像・ノイズ除去

### 4.2 ピーク分離・スペクトル分解

- 複雑に重なったピークを分解し、
  - 化学状態・価数・局所構造などを定量するタスク。
- 例：
  - XAFS・XPS スペクトルのピークフィッティング
  - Raman/EELS の複数モード分離
  - 多元合金の XRD パターンから相ごとの寄与を推定

- 手法：
  - 非線形フィッティング（Gaussian/Lorentzian/Voigt）
  - NMF / ICA によるスペクトル分解
  - スペクトル辞書（辞書学習）＋スパース回帰

### 4.3 次元削減・クラスタリング

- 多数のスペクトル・画像・パターンをまとめて扱う場合、
  - PCA, UMAP などで低次元に埋め込み、
  - HDBSCAN などでクラスタリングすることで、
  - 「類似した測定データ群」や「異常サンプル」を自動的に抽出できる。

- 応用例：
  - 2D マップ測定（XAFS マッピング、MBN マッピングなど）から
    「特性の違う領域」を自動で検出。
  - 時系列計測から「典型的な応答パターン」を分類。

### 4.4 自律実験・オンライン解析

- 取得した計測データをその場で解析し、
  - 次に測るエネルギー、位置、温度などをアルゴリズムが決める
  「オンライン・アクティブ実験」の方向性。

- フレームワークの要素：
  - 計測インフォマティクス：データの即時解析・特徴抽出
  - 材料インフォマティクス：特性予測モデル
  - プロセスインフォマティクス：実験条件の制約・レシピ
  - ベイズ最適化／バンディットアルゴリズム：次の測定点選択


## 5. データ品質・不確かさの扱い

計測インフォマティクスでは、「データそのものの信頼性」を定量的に扱うことが重要になる。

- 測定ノイズと系統誤差
  - 装置固有のオフセット・ドリフト・ビーム強度変動などを
    メタデータとして記録し、モデルに反映させる。
- 不確かさ評価
  - 確率的なモデル（ガウス過程・ベイズ回帰）や
    アンサンブル学習を用いて予測の不確かさを推定。
- 異常検知
  - 計測中の装置トラブルや試料の破損を、データパターンから早期に検知。

これらは、ビームタイムや貴重な試料を無駄にしないための「安全装置」としても機能する。