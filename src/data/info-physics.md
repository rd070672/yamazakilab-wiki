# 物理インフォマティクス（Physics Informatics）

4つのインフォマティクスのうち、「物理インフォマティクス」について概説する。

## 参考にしたドキュメント
- MathWorks, Physics-Informed Neural Networks (PINNs) とは  
  https://jp.mathworks.com/discovery/physics-informed-neural-networks.html
- PINN入門: 物理法則を組み込んだAIで微分方程式を解く  
  https://www.codemajin.net/introduction-to-physics-informed-neural-network/


## 1. 物理インフォマティクスとは何か

- 物理インフォマティクス（Physics Informatics）は、
  - 物理法則に基づく数値モデル（DFT, MD, フェーズフィールド, PDE, FEM など）と
  - データ駆動モデル（機械学習・統計モデル）
  を統合し、
  - 「物理的に整合したかたち」で予測・解析・設計を行う枠組みを指す。

- 材料・計測・プロセスインフォマティクスと比べると：
  - 材料インフォマティクス：  
    組成・構造・特性をデータ駆動で結びつける。
  - 計測インフォマティクス：  
    測定データ（スペクトル・画像・時系列）の処理と特徴抽出に焦点。
  - プロセスインフォマティクス：  
    プロセス条件と構造・特性の関係をモデル化し、レシピを最適化。
  - 物理インフォマティクス：  
    上記すべての背後にある「物理法則・方程式・エネルギー地形」を、
    データ科学と統合して扱うレイヤー。

- ゴールのイメージ：
  - 「物理モデルだけでは重くて扱えない／未知パラメータが多い」
  - 「データだけでは外挿が効かない／物理的整合性が保証できない」
  という双方の弱点を補い合い、
  - 少量データでも物理的に意味のある予測・逆問題解決・設計を実現すること。


## 2. 対象とスコープ

「物理インフォマティクス」は、特に材料・デバイスにおいて

- 物理モデル
  - 電子構造：第一原理計算（DFT, GW, DMFT など）
  - 原子ダイナミクス：古典 MD / 機械学習ポテンシャル MD / AIMD
  - メゾスケール：マイクロ磁気（LLG）, フェーズフィールド, フラクチャーメカニクス
  - マクロスケール：FEM による熱・応力・電磁場・マルチフィジックス解析

- モデルの役割
  - 支配方程式：シュレーディンガー方程式、LLG、マクスウェル方程式、拡散方程式など
  - 変分原理・エネルギー汎関数：自由エネルギー、エントロピー、ギブス自由エネルギーなど

- データとの関係
  - シミュレーション結果：エネルギー・力・応力・磁化・スペクトル
  - 実験データ：XAFS/XMCD/XRD、MBN、磁気特性、輸送特性など

を統合する領域を指す。

このページでは、
- 物理法則＋データを組み合わせたモデリング手法（Physics-informed ML 等）を中心に述べ、
- 個別の DFT/MD/FEM の使い方は別ページに分ける想定とする。


## 3. 物理モデルのレイヤー構造（スケールと役割）

物理インフォマティクスで扱う代表的なモデルを、スケールごとに整理する：

### 3.1 電子構造レベル

- DFT, ハイブリッド汎関数, GW, DMFT など
- 役割：
  - 基本的なエネルギー地形、磁気モーメント、バンド構造、DOS を与える。
  - スピン軌道相互作用、磁気異方性、磁気弾性定数などの「入力パラメータ」を、  
    上位スケール（マイクロ磁気、連続体モデル）に渡す。

### 3.2 原子スケール（MD, MC）

- 古典 MD、AIMD、機械学習ポテンシャル MD
- 役割：
  - 構造緩和・相変態・拡散・欠陥ダイナミクス・イオン伝導などを扱う。
  - RDF・配位数・局所環境などの統計量を、  
    構造指標として上位スケールに渡す。

### 3.3 メゾ～マクロ（連続体・マルチフィジックス）

- フェーズフィールド、マイクロ磁気（LLG）、有限要素法（FEM）による熱・力学・電磁場解析
- 役割：
  - ドメイン構造、ミクロ組織進化、応力・ひずみ分布、渦電流分布など、
    実験観測に近い物理量を再現。
  - プロセス条件（温度履歴・外場）と構造・特性の関係を橋渡し。

### 3.4 簡略化モデル・低次元モデル

- 有効ハミルトニアン、Landau 型自由エネルギー、等価回路モデル、ROM（reduced-order model）など。
- 役割：
  - 支配方程式の本質的な構造を保ちつつ、計算コストを下げる。
  - ベイズ最適化・パラメータ推定・制御設計と組み合わせやすい形にする。


## 4. Physics-informed Neural Networks（PINNs）の位置づけ

物理インフォマティクスの中核的なトピックの一つが、  
Physics-informed Neural Networks（PINNs）／Physics-informed Machine Learning（PIML）である。

### 4.1 基本アイデア

- 従来の ML：
  - 「入力–出力のペアデータ」を大量に与え、汎関数近似として学習。
- PIML / PINNs：
  - データに加えて、「支配方程式」「境界条件」「保存則」などの物理法則を
    損失関数に直接組み込んで学習する。

- 例：
  - LLG 方程式を満たすように磁化ベクトルの時間発展 NN を学習
  - マクスウェル方程式を満たすように電磁場分布の NN を学習
  - 拡散方程式を満たすように温度場・濃度場の NN を学習

### 4.2 メリット

- 少量データでも：
  - 物理法則が強い正則化として働き、
  - データが少なくても「物理的にあり得ない解」を避けやすい。
- 逆問題・パラメータ推定：
  - 観測データ＋支配方程式から、
    材料パラメータ（拡散係数、異方性定数、損失パラメータなど）を推定。
- 既存ソルバの補完：
  - FEM や FDTD の格子計算を補間する連続場として PINN を用いることで、
    格子の粗い領域を埋める・高速 surrogate として使う、など。


## 5. 代表的なワークフロー

物理インフォマティクスの実行的な流れを、典型的なパターンとして整理すると：

### 5.1 物理モデル駆動のデータ生成＋サロゲートモデル

1. 高忠実度モデルの選定行
   - DFT / MD / フェーズフィールド / LLG / FEM など、
     物理的に信頼できるモデルを決める。

2. 計算設計
   - パラメータ空間（組成・温度・応力・外場など）を DoE やベイズ最適化でサンプリング。
   - 必要最低限の計算点を決める。

3. 高忠実度計算の実行
   - HPC で並列実行し、エネルギー・物性・場分布などを取得。

4. サロゲートモデルの構築
   - 上記データを用いて、
     - ガウス過程回帰
     - ランダムフォレスト
     - GNN / PINN などの ML モデル
     を構築し、計算コストを大幅に削減した「近似モデル」を作る。

5. 上位レベルでの探索・最適化
   - サロゲートを使って材料・プロセス空間を効率的に探索し、有望領域を絞る。

### 5.2 実験データとの統合（モデル同化）

1. 物理モデルの構築
   - 初期値・境界条件・パラメータを仮定し、シミュレーションを行う。

2. 実験データの準備
   - 計測インフォマティクス側で前処理・特徴抽出されたデータを用意。

3. モデル同化・パラメータ推定
   - 実験データとシミュレーション出力の差を評価する損失関数を定義し、
   - ベイズ推定・最適化・PIML により、物理パラメータを同定。

4. 検証・予測
   - 別の条件で実験と計算を比較し、汎化性能を確認。
   - 信頼できる範囲内で予測へと拡張。

### 5.3 マルチスケール連成

- 電子構造 → MD → フェーズフィールド → FEM → 実験
  - スケール間で受け渡すパラメータ（エネルギー、拡散係数、界面エネルギー、弾性定数など）を整理。
  - 各スケールでの不確かさを評価しつつ、全体として整合したモデルを組む。


## 6. 注意点・限界

- モデルの妥当性
  - 物理モデル自身が近似（擬ポテンシャル、交換相関汎関数、均質近似など）を含むため、
    「物理モデル＋データ」が真理ではなく、あくまで有効理論であることを意識する必要がある。

- パラメータ同定の非一意性
  - 違うパラメータセットが同じ観測を再現できる場合（非同定性）がある。
  - ベイズ推定や不確かさ評価によって、「どこまで決まっていて、どこから先は曖昧か」を明示することが重要。

- 計算コスト
  - 高忠実度シミュレーション（AIMD、フル 3D マルチフィジックスなど）は計算資源を大量に消費する。
  - サロゲート化・低次元化・マルチフィデリティ（粗いモデル＋細かいモデルの組み合わせ）の工夫が必須。

- ブラックボックス ML への依存
  - 物理インフォマティクスは「物理法則を活かす」ことが本質であり、
    物理を無視したブラックボックス ML に頼りすぎると本末転倒になる。
  - モデル構築の各段階で「どの物理をどこまで使うか」を意識して設計する必要がある。


## 7. まとめ

- 本ページ「物理インフォマティクス」では、
  - DFT～MD～フェーズフィールド～FEM といった物理モデルのレイヤー構造と、
  - Physics-informed Machine Learning（PIML, PINNs）を含む
    データ駆動手法との統合の考え方を整理した。

- 役割分担のまとめ：
  - 材料インフォマティクス：  
    「どんな材料が良いか？」をデータ空間で探す。
  - 計測インフォマティクス：  
    「何が、どのように測れているか？」を信号処理とデータ科学で整理する。
  - プロセスインフォマティクス：  
    「どう作れば良いか？」をプロセス条件空間で最適化する。
  - 物理インフォマティクス：  
    「なぜその材料・プロセス・計測でその結果になるのか？」を  
    物理法則＋データで説明し、  
    上記 3 つのインフォマティクスを貫く「物理的背景」を提供する。